/**
 * @license almond 0.3.0 Copyright (c) 2011-2014, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */

/*! poly2tri v1.3.5 | (c) 2009-2014 Poly2Tri Contributors */

/********************************************************************************
 *                                                                              *
 * Author    :  Angus Johnson                                                   *
 * Version   :  6.1.3a                                                          *
 * Date      :  22 January 2014                                                 *
 * Website   :  http://www.angusj.com                                           *
 * Copyright :  Angus Johnson 2010-2014                                         *
 *                                                                              *
 * License:                                                                     *
 * Use, modification & distribution is subject to Boost Software License Ver 1. *
 * http://www.boost.org/LICENSE_1_0.txt                                         *
 *                                                                              *
 * Attributions:                                                                *
 * The code in this library is an extension of Bala Vatti's clipping algorithm: *
 * "A generic solution to polygon clipping"                                     *
 * Communications of the ACM, Vol 35, Issue 7 (July 1992) pp 56-63.             *
 * http://portal.acm.org/citation.cfm?id=129906                                 *
 *                                                                              *
 * Computer graphics and geometric modeling: implementation and algorithms      *
 * By Max K. Agoston                                                            *
 * Springer; 1 edition (January 4, 2005)                                        *
 * http://books.google.com/books?q=vatti+clipping+agoston                       *
 *                                                                              *
 * See also:                                                                    *
 * "Polygon Offsetting by Computing Winding Numbers"                            *
 * Paper no. DETC2005-85513 pp. 565-575                                         *
 * ASME 2005 International Design Engineering Technical Conferences             *
 * and Computers and Information in Engineering Conference (IDETC/CIE2005)      *
 * September 24-28, 2005 , Long Beach, California, USA                          *
 * http://www.me.berkeley.edu/~mcmains/pubs/DAC05OffsetPolygon.pdf              *
 *                                                                              *
 *******************************************************************************/

/*******************************************************************************
 *                                                                              *
 * Basic JavaScript BN library - subset useful for RSA encryption.              *
 * http://www-cs-students.stanford.edu/~tjw/jsbn/                               *
 * Copyright (c) 2005  Tom Wu                                                   *
 * All Rights Reserved.                                                         *
 * See "LICENSE" for details:                                                   *
 * http://www-cs-students.stanford.edu/~tjw/jsbn/LICENSE                        *
 *                                                                              *
 *******************************************************************************/

/**
 * @license RequireJS text 2.0.12 Copyright (c) 2010-2014, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/text for details
 */

(function(e,t){typeof define=="function"&&define.amd?define([],t):e.NavMesh=t()})(this,function(){var t,n,r;return function(e){function v(e,t){return h.call(e,t)}function m(e,t){var n,r,i,s,o,u,a,f,c,h,p,v=t&&t.split("/"),m=l.map,g=m&&m["*"]||{};if(e&&e.charAt(0)===".")if(t){v=v.slice(0,v.length-1),e=e.split("/"),o=e.length-1,l.nodeIdCompat&&d.test(e[o])&&(e[o]=e[o].replace(d,"")),e=v.concat(e);for(c=0;c<e.length;c+=1){p=e[c];if(p===".")e.splice(c,1),c-=1;else if(p===".."){if(c===1&&(e[2]===".."||e[0]===".."))break;c>0&&(e.splice(c-1,2),c-=2)}}e=e.join("/")}else e.indexOf("./")===0&&(e=e.substring(2));if((v||g)&&m){n=e.split("/");for(c=n.length;c>0;c-=1){r=n.slice(0,c).join("/");if(v)for(h=v.length;h>0;h-=1){i=m[v.slice(0,h).join("/")];if(i){i=i[r];if(i){s=i,u=c;break}}}if(s)break;!a&&g&&g[r]&&(a=g[r],f=c)}!s&&a&&(s=a,u=f),s&&(n.splice(0,u,s),e=n.join("/"))}return e}function g(t,n){return function(){var r=p.call(arguments,0);return typeof r[0]!="string"&&r.length===1&&r.push(null),s.apply(e,r.concat([t,n]))}}function y(e){return function(t){return m(t,e)}}function b(e){return function(t){a[e]=t}}function w(t){if(v(f,t)){var n=f[t];delete f[t],c[t]=!0,i.apply(e,n)}if(!v(a,t)&&!v(c,t))throw new Error("No "+t);return a[t]}function E(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function S(e){return function(){return l&&l.config&&l.config[e]||{}}}var i,s,o,u,a={},f={},l={},c={},h=Object.prototype.hasOwnProperty,p=[].slice,d=/\.js$/;o=function(e,t){var n,r=E(e),i=r[0];return e=r[1],i&&(i=m(i,t),n=w(i)),i?n&&n.normalize?e=n.normalize(e,y(t)):e=m(e,t):(e=m(e,t),r=E(e),i=r[0],e=r[1],i&&(n=w(i))),{f:i?i+"!"+e:e,n:e,pr:i,p:n}},u={require:function(e){return g(e)},exports:function(e){var t=a[e];return typeof t!="undefined"?t:a[e]={}},module:function(e){return{id:e,uri:"",exports:a[e],config:S(e)}}},i=function(t,n,r,i){var s,l,h,p,d,m=[],y=typeof r,E;i=i||t;if(y==="undefined"||y==="function"){n=!n.length&&r.length?["require","exports","module"]:n;for(d=0;d<n.length;d+=1){p=o(n[d],i),l=p.f;if(l==="require")m[d]=u.require(t);else if(l==="exports")m[d]=u.exports(t),E=!0;else if(l==="module")s=m[d]=u.module(t);else if(v(a,l)||v(f,l)||v(c,l))m[d]=w(l);else{if(!p.p)throw new Error(t+" missing "+l);p.p.load(p.n,g(i,!0),b(l),{}),m[d]=a[l]}}h=r?r.apply(a[t],m):undefined;if(t)if(s&&s.exports!==e&&s.exports!==a[t])a[t]=s.exports;else if(h!==e||!E)a[t]=h}else t&&(a[t]=r)},t=n=s=function(t,n,r,a,f){if(typeof t=="string")return u[t]?u[t](n):w(o(t,n).f);if(!t.splice){l=t,l.deps&&s(l.deps,l.callback);if(!n)return;n.splice?(t=n,n=r,r=null):t=e}return n=n||function(){},typeof r=="function"&&(r=a,a=f),a?i(e,t,n,r):setTimeout(function(){i(e,t,n,r)},4),s},s.config=function(e){return s(e)},t._defined=a,r=function(e,t,n){t.splice||(n=t,t=[]),!v(a,e)&&!v(f,e)&&(f[e]=[e,t,n])},r.amd={jQuery:!0}}(),r("../tools/build/almond",function(){}),!function(e){if("object"==typeof exports)module.exports=e();else if("function"==typeof r&&r.amd)r("lib/poly2tri",e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.poly2tri=e()}}(function(){return function e(t,r,i){function s(u,a){if(!r[u]){if(!t[u]){var f="function"==typeof n&&n;if(!a&&f)return f(u,!0);if(o)return o(u,!0);throw new Error("Cannot find module '"+u+"'")}var l=r[u]={exports:{}};t[u][0].call(l.exports,function(e){var n=t[u][1][e];return s(n?n:e)},l,l.exports,e,t,r,i)}return r[u].exports}for(var o="function"==typeof n&&n,u=0;u<i.length;u++)s(i[u]);return s}({1:[function(e,t){t.exports={version:"1.3.5"}},{}],2:[function(e,t){var n=function(e,t){this.point=e,this.triangle=t||null,this.next=null,this.prev=null,this.value=e.x},r=function(e,t){this.head_=e,this.tail_=t,this.search_node_=e};r.prototype.head=function(){return this.head_},r.prototype.setHead=function(e){this.head_=e},r.prototype.tail=function(){return this.tail_},r.prototype.setTail=function(e){this.tail_=e},r.prototype.search=function(){return this.search_node_},r.prototype.setSearch=function(e){this.search_node_=e},r.prototype.findSearchNode=function(){return this.search_node_},r.prototype.locateNode=function(e){var t=this.search_node_;if(e<t.value){for(;t=t.prev;)if(e>=t.value)return this.search_node_=t,t}else for(;t=t.next;)if(e<t.value)return this.search_node_=t.prev,t.prev;return null},r.prototype.locatePoint=function(e){var t=e.x,n=this.findSearchNode(t),r=n.point.x;if(t===r){if(e!==n.point)if(e===n.prev.point)n=n.prev;else{if(e!==n.next.point)throw new Error("poly2tri Invalid AdvancingFront.locatePoint() call");n=n.next}}else if(r>t)for(;(n=n.prev)&&e!==n.point;);else for(;(n=n.next)&&e!==n.point;);return n&&(this.search_node_=n),n},t.exports=r,t.exports.Node=n},{}],3:[function(e,t){function n(e,t){if(!e)throw new Error(t||"Assert Failed")}t.exports=n},{}],4:[function(e,t){var n=e("./xy"),r=function(e,t){this.x=+e||0,this.y=+t||0,this._p2t_edge_list=null};r.prototype.toString=function(){return n.toStringBase(this)},r.prototype.toJSON=function(){return{x:this.x,y:this.y}},r.prototype.clone=function(){return new r(this.x,this.y)},r.prototype.set_zero=function(){return this.x=0,this.y=0,this},r.prototype.set=function(e,t){return this.x=+e||0,this.y=+t||0,this},r.prototype.negate=function(){return this.x=-this.x,this.y=-this.y,this},r.prototype.add=function(e){return this.x+=e.x,this.y+=e.y,this},r.prototype.sub=function(e){return this.x-=e.x,this.y-=e.y,this},r.prototype.mul=function(e){return this.x*=e,this.y*=e,this},r.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},r.prototype.normalize=function(){var e=this.length();return this.x/=e,this.y/=e,e},r.prototype.equals=function(e){return this.x===e.x&&this.y===e.y},r.negate=function(e){return new r(-e.x,-e.y)},r.add=function(e,t){return new r(e.x+t.x,e.y+t.y)},r.sub=function(e,t){return new r(e.x-t.x,e.y-t.y)},r.mul=function(e,t){return new r(e*t.x,e*t.y)},r.cross=function(e,t){return"number"==typeof e?"number"==typeof t?e*t:new r(-e*t.y,e*t.x):"number"==typeof t?new r(t*e.y,-t*e.x):e.x*t.y-e.y*t.x},r.toString=n.toString,r.compare=n.compare,r.cmp=n.compare,r.equals=n.equals,r.dot=function(e,t){return e.x*t.x+e.y*t.y},t.exports=r},{"./xy":11}],5:[function(e,t){var n=e("./xy"),r=function(e,t){this.name="PointError",this.points=t=t||[],this.message=e||"Invalid Points!";for(var r=0;r<t.length;r++)this.message+=" "+n.toString(t[r])};r.prototype=new Error,r.prototype.constructor=r,t.exports=r},{"./xy":11}],6:[function(e,t,n){(function(t){var r=t.poly2tri;n.noConflict=function(){return t.poly2tri=r,n},n.VERSION=e("../dist/version.json").version,n.PointError=e("./pointerror"),n.Point=e("./point"),n.Triangle=e("./triangle"),n.SweepContext=e("./sweepcontext");var i=e("./sweep");n.triangulate=i.triangulate,n.sweep={Triangulate:i.triangulate}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../dist/version.json":1,"./point":4,"./pointerror":5,"./sweep":7,"./sweepcontext":8,"./triangle":9}],7:[function(e,t,n){function r(e){e.initTriangulation(),e.createAdvancingFront(),i(e),s(e)}function i(e){var t,n=e.pointCount();for(t=1;n>t;++t)for(var r=e.getPoint(t),i=o(e,r),s=r._p2t_edge_list,a=0;s&&a<s.length;++a)u(e,s[a],i)}function s(e){for(var t=e.front().head().next.triangle,n=e.front().head().next.point;!t.getConstrainedEdgeCW(n);)t=t.neighborCCW(n);e.meshClean(t)}function o(e,t){var n=e.locateNode(t),r=l(e,t,n);return t.x<=n.point.x+F&&c(e,n),h(e,r),r}function u(e,t,n){e.edge_event.constrained_edge=t,e.edge_event.right=t.p.x>t.q.x,f(n.triangle,t.p,t.q)||(w(e,t,n),a(e,t.p,t.q,n.triangle,t.q))}function a(e,t,n,r,i){if(!f(r,t,n)){var s=r.pointCCW(i),o=q(n,s,t);if(o===I.COLLINEAR)throw new P("poly2tri EdgeEvent: Collinear not supported!",[n,s,t]);var u=r.pointCW(i),l=q(n,u,t);if(l===I.COLLINEAR)throw new P("poly2tri EdgeEvent: Collinear not supported!",[n,u,t]);o===l?(r=o===I.CW?r.neighborCCW(i):r.neighborCW(i),a(e,t,n,r,i)):A(e,t,n,r,i)}}function f(e,t,n){var r=e.edgeIndex(t,n);if(-1!==r){e.markConstrainedEdgeByIndex(r);var i=e.getNeighbor(r);return i&&i.markConstrainedEdgeByPoints(t,n),!0}return!1}function l(e,t,n){var r=new H(t,n.point,n.next.point);r.markNeighbor(n.triangle),e.addToMap(r);var i=new B(t);return i.next=n.next,i.prev=n,n.next.prev=i,n.next=i,d(e,r)||e.mapTriangleToNodes(r),i}function c(e,t){var n=new H(t.prev.point,t.point,t.next.point);n.markNeighbor(t.prev.triangle),n.markNeighbor(t.triangle),e.addToMap(n),t.prev.next=t.next,t.next.prev=t.prev,d(e,n)||e.mapTriangleToNodes(n)}function h(e,t){for(var n=t.next;n.next&&!U(n.point,n.next.point,n.prev.point);)c(e,n),n=n.next;for(n=t.prev;n.prev&&!U(n.point,n.next.point,n.prev.point);)c(e,n),n=n.prev;t.next&&t.next.next&&p(t)&&g(e,t)}function p(e){var t=e.point.x-e.next.next.point.x,n=e.point.y-e.next.next.point.y;return D(n>=0,"unordered y"),t>=0||Math.abs(t)<n}function d(e,t){for(var n=0;3>n;++n)if(!t.delaunay_edge[n]){var r=t.getNeighbor(n);if(r){var i=t.getPoint(n),s=r.oppositePoint(t,i),o=r.index(s);if(r.constrained_edge[o]||r.delaunay_edge[o]){t.constrained_edge[n]=r.constrained_edge[o];continue}var u=v(i,t.pointCCW(i),t.pointCW(i),s);if(u){t.delaunay_edge[n]=!0,r.delaunay_edge[o]=!0,m(t,i,r,s);var a=!d(e,t);return a&&e.mapTriangleToNodes(t),a=!d(e,r),a&&e.mapTriangleToNodes(r),t.delaunay_edge[n]=!1,r.delaunay_edge[o]=!1,!0}}}return!1}function v(e,t,n,r){var i=e.x-r.x,s=e.y-r.y,o=t.x-r.x,u=t.y-r.y,a=i*u,f=o*s,l=a-f;if(0>=l)return!1;var c=n.x-r.x,h=n.y-r.y,p=c*s,d=i*h,v=p-d;if(0>=v)return!1;var m=o*h,g=c*u,y=i*i+s*s,b=o*o+u*u,w=c*c+h*h,E=y*(m-g)+b*v+w*l;return E>0}function m(e,t,n,r){var i,s,o,u;i=e.neighborCCW(t),s=e.neighborCW(t),o=n.neighborCCW(r),u=n.neighborCW(r);var a,f,l,c;a=e.getConstrainedEdgeCCW(t),f=e.getConstrainedEdgeCW(t),l=n.getConstrainedEdgeCCW(r),c=n.getConstrainedEdgeCW(r);var h,p,d,v;h=e.getDelaunayEdgeCCW(t),p=e.getDelaunayEdgeCW(t),d=n.getDelaunayEdgeCCW(r),v=n.getDelaunayEdgeCW(r),e.legalize(t,r),n.legalize(r,t),n.setDelaunayEdgeCCW(t,h),e.setDelaunayEdgeCW(t,p),e.setDelaunayEdgeCCW(r,d),n.setDelaunayEdgeCW(r,v),n.setConstrainedEdgeCCW(t,a),e.setConstrainedEdgeCW(t,f),e.setConstrainedEdgeCCW(r,l),n.setConstrainedEdgeCW(r,c),e.clearNeighbors(),n.clearNeighbors(),i&&n.markNeighbor(i),s&&e.markNeighbor(s),o&&e.markNeighbor(o),u&&n.markNeighbor(u),e.markNeighbor(n)}function g(e,t){for(e.basin.left_node=q(t.point,t.next.point,t.next.next.point)===I.CCW?t.next.next:t.next,e.basin.bottom_node=e.basin.left_node;e.basin.bottom_node.next&&e.basin.bottom_node.point.y>=e.basin.bottom_node.next.point.y;)e.basin.bottom_node=e.basin.bottom_node.next;if(e.basin.bottom_node!==e.basin.left_node){for(e.basin.right_node=e.basin.bottom_node;e.basin.right_node.next&&e.basin.right_node.point.y<e.basin.right_node.next.point.y;)e.basin.right_node=e.basin.right_node.next;e.basin.right_node!==e.basin.bottom_node&&(e.basin.width=e.basin.right_node.point.x-e.basin.left_node.point.x,e.basin.left_highest=e.basin.left_node.point.y>e.basin.right_node.point.y,y(e,e.basin.bottom_node))}}function y(e,t){if(!b(e,t)){c(e,t);var n;if(t.prev!==e.basin.left_node||t.next!==e.basin.right_node){if(t.prev===e.basin.left_node){if(n=q(t.point,t.next.point,t.next.next.point),n===I.CW)return;t=t.next}else if(t.next===e.basin.right_node){if(n=q(t.point,t.prev.point,t.prev.prev.point),n===I.CCW)return;t=t.prev}else t=t.prev.point.y<t.next.point.y?t.prev:t.next;y(e,t)}}}function b(e,t){var n;return n=e.basin.left_highest?e.basin.left_node.point.y-t.point.y:e.basin.right_node.point.y-t.point.y,e.basin.width>n?!0:!1}function w(e,t,n){e.edge_event.right?E(e,t,n):N(e,t,n)}function E(e,t,n){for(;n.next.point.x<t.p.x;)q(t.q,n.next.point,t.p)===I.CCW?S(e,t,n):n=n.next}function S(e,t,n){n.point.x<t.p.x&&(q(n.point,n.next.point,n.next.next.point)===I.CCW?x(e,t,n):(T(e,t,n),S(e,t,n)))}function x(e,t,n){c(e,n.next),n.next.point!==t.p&&q(t.q,n.next.point,t.p)===I.CCW&&q(n.point,n.next.point,n.next.next.point)===I.CCW&&x(e,t,n)}function T(e,t,n){q(n.next.point,n.next.next.point,n.next.next.next.point)===I.CCW?x(e,t,n.next):q(t.q,n.next.next.point,t.p)===I.CCW&&T(e,t,n.next)}function N(e,t,n){for(;n.prev.point.x>t.p.x;)q(t.q,n.prev.point,t.p)===I.CW?C(e,t,n):n=n.prev}function C(e,t,n){n.point.x>t.p.x&&(q(n.point,n.prev.point,n.prev.prev.point)===I.CW?L(e,t,n):(k(e,t,n),C(e,t,n)))}function k(e,t,n){q(n.prev.point,n.prev.prev.point,n.prev.prev.prev.point)===I.CW?L(e,t,n.prev):q(t.q,n.prev.prev.point,t.p)===I.CW&&k(e,t,n.prev)}function L(e,t,n){c(e,n.prev),n.prev.point!==t.p&&q(t.q,n.prev.point,t.p)===I.CW&&q(n.point,n.prev.point,n.prev.prev.point)===I.CW&&L(e,t,n)}function A(e,t,n,r,i){var s=r.neighborAcross(i);D(s,"FLIP failed due to missing triangle!");var o=s.oppositePoint(r,i);if(r.getConstrainedEdgeAcross(i)){var u=r.index(i);throw new P("poly2tri Intersecting Constraints",[i,o,r.getPoint((u+1)%3),r.getPoint((u+2)%3)])}if(R(i,r.pointCCW(i),r.pointCW(i),o))if(m(r,i,s,o),e.mapTriangleToNodes(r),e.mapTriangleToNodes(s),i===n&&o===t)n===e.edge_event.constrained_edge.q&&t===e.edge_event.constrained_edge.p&&(r.markConstrainedEdgeByPoints(t,n),s.markConstrainedEdgeByPoints(t,n),d(e,r),d(e,s));else{var f=q(n,o,t);r=O(e,f,r,s,i,o),A(e,t,n,r,i)}else{var l=M(t,n,s,o);_(e,t,n,r,s,l),a(e,t,n,r,i)}}function O(e,t,n,r,i,s){var o;return t===I.CCW?(o=r.edgeIndex(i,s),r.delaunay_edge[o]=!0,d(e,r),r.clearDelaunayEdges(),n):(o=n.edgeIndex(i,s),n.delaunay_edge[o]=!0,d(e,n),n.clearDelaunayEdges(),r)}function M(e,t,n,r){var i=q(t,r,e);if(i===I.CW)return n.pointCCW(r);if(i===I.CCW)return n.pointCW(r);throw new P("poly2tri [Unsupported] nextFlipPoint: opposing point on constrained edge!",[t,r,e])}function _(e,t,n,r,i,s){var o=i.neighborAcross(s);D(o,"FLIP failed due to missing triangle");var u=o.oppositePoint(i,s);if(R(n,r.pointCCW(n),r.pointCW(n),u))A(e,n,u,o,u);else{var a=M(t,n,o,u);_(e,t,n,r,o,a)}}var D=e("./assert"),P=e("./pointerror"),H=e("./triangle"),B=e("./advancingfront").Node,j=e("./utils"),F=j.EPSILON,I=j.Orientation,q=j.orient2d,R=j.inScanArea,U=j.isAngleObtuse;n.triangulate=r},{"./advancingfront":2,"./assert":3,"./pointerror":5,"./triangle":9,"./utils":10}],8:[function(e,t){var n=e("./pointerror"),r=e("./point"),i=e("./triangle"),s=e("./sweep"),o=e("./advancingfront"),u=o.Node,a=.3,f=function(e,t){if(this.p=e,this.q=t,e.y>t.y)this.q=e,this.p=t;else if(e.y===t.y)if(e.x>t.x)this.q=e,this.p=t;else if(e.x===t.x)throw new n("poly2tri Invalid Edge constructor: repeated points!",[e]);this.q._p2t_edge_list||(this.q._p2t_edge_list=[]),this.q._p2t_edge_list.push(this)},l=function(){this.left_node=null,this.bottom_node=null,this.right_node=null,this.width=0,this.left_highest=!1};l.prototype.clear=function(){this.left_node=null,this.bottom_node=null,this.right_node=null,this.width=0,this.left_highest=!1};var c=function(){this.constrained_edge=null,this.right=!1},h=function(e,t){t=t||{},this.triangles_=[],this.map_=[],this.points_=t.cloneArrays?e.slice(0):e,this.edge_list=[],this.pmin_=this.pmax_=null,this.front_=null,this.head_=null,this.tail_=null,this.af_head_=null,this.af_middle_=null,this.af_tail_=null,this.basin=new l,this.edge_event=new c,this.initEdges(this.points_)};h.prototype.addHole=function(e){this.initEdges(e);var t,n=e.length;for(t=0;n>t;t++)this.points_.push(e[t]);return this},h.prototype.AddHole=h.prototype.addHole,h.prototype.addHoles=function(e){var t,n=e.length;for(t=0;n>t;t++)this.initEdges(e[t]);return this.points_=this.points_.concat.apply(this.points_,e),this},h.prototype.addPoint=function(e){return this.points_.push(e),this},h.prototype.AddPoint=h.prototype.addPoint,h.prototype.addPoints=function(e){return this.points_=this.points_.concat(e),this},h.prototype.triangulate=function(){return s.triangulate(this),this},h.prototype.getBoundingBox=function(){return{min:this.pmin_,max:this.pmax_}},h.prototype.getTriangles=function(){return this.triangles_},h.prototype.GetTriangles=h.prototype.getTriangles,h.prototype.front=function(){return this.front_},h.prototype.pointCount=function(){return this.points_.length},h.prototype.head=function(){return this.head_},h.prototype.setHead=function(e){this.head_=e},h.prototype.tail=function(){return this.tail_},h.prototype.setTail=function(e){this.tail_=e},h.prototype.getMap=function(){return this.map_},h.prototype.initTriangulation=function(){var e,t=this.points_[0].x,n=this.points_[0].x,i=this.points_[0].y,s=this.points_[0].y,o=this.points_.length;for(e=1;o>e;e++){var u=this.points_[e];u.x>t&&(t=u.x),u.x<n&&(n=u.x),u.y>i&&(i=u.y),u.y<s&&(s=u.y)}this.pmin_=new r(n,s),this.pmax_=new r(t,i);var f=a*(t-n),l=a*(i-s);this.head_=new r(t+f,s-l),this.tail_=new r(n-f,s-l),this.points_.sort(r.compare)},h.prototype.initEdges=function(e){var t,n=e.length;for(t=0;n>t;++t)this.edge_list.push(new f(e[t],e[(t+1)%n]))},h.prototype.getPoint=function(e){return this.points_[e]},h.prototype.addToMap=function(e){this.map_.push(e)},h.prototype.locateNode=function(e){return this.front_.locateNode(e.x)},h.prototype.createAdvancingFront=function(){var e,t,n,r=new i(this.points_[0],this.tail_,this.head_);this.map_.push(r),e=new u(r.getPoint(1),r),t=new u(r.getPoint(0),r),n=new u(r.getPoint(2)),this.front_=new o(e,n),e.next=t,t.next=n,t.prev=e,n.prev=t},h.prototype.removeNode=function(){},h.prototype.mapTriangleToNodes=function(e){for(var t=0;3>t;++t)if(!e.getNeighbor(t)){var n=this.front_.locatePoint(e.pointCW(e.getPoint(t)));n&&(n.triangle=e)}},h.prototype.removeFromMap=function(e){var t,n=this.map_,r=n.length;for(t=0;r>t;t++)if(n[t]===e){n.splice(t,1);break}},h.prototype.meshClean=function(e){for(var t,n,r=[e];t=r.pop();)if(!t.isInterior())for(t.setInterior(!0),this.triangles_.push(t),n=0;3>n;n++)t.constrained_edge[n]||r.push(t.getNeighbor(n))},t.exports=h},{"./advancingfront":2,"./point":4,"./pointerror":5,"./sweep":7,"./triangle":9}],9:[function(e,t){var n=e("./xy"),r=function(e,t,n){this.points_=[e,t,n],this.neighbors_=[null,null,null],this.interior_=!1,this.constrained_edge=[!1,!1,!1],this.delaunay_edge=[!1,!1,!1]},i=n.toString;r.prototype.toString=function(){return"["+i(this.points_[0])+i(this.points_[1])+i(this.points_[2])+"]"},r.prototype.getPoint=function(e){return this.points_[e]},r.prototype.GetPoint=r.prototype.getPoint,r.prototype.getPoints=function(){return this.points_},r.prototype.getNeighbor=function(e){return this.neighbors_[e]},r.prototype.containsPoint=function(e){var t=this.points_;return e===t[0]||e===t[1]||e===t[2]},r.prototype.containsEdge=function(e){return this.containsPoint(e.p)&&this.containsPoint(e.q)},r.prototype.containsPoints=function(e,t){return this.containsPoint(e)&&this.containsPoint(t)},r.prototype.isInterior=function(){return this.interior_},r.prototype.setInterior=function(e){return this.interior_=e,this},r.prototype.markNeighborPointers=function(e,t,n){var r=this.points_;if(e===r[2]&&t===r[1]||e===r[1]&&t===r[2])this.neighbors_[0]=n;else if(e===r[0]&&t===r[2]||e===r[2]&&t===r[0])this.neighbors_[1]=n;else{if(!(e===r[0]&&t===r[1]||e===r[1]&&t===r[0]))throw new Error("poly2tri Invalid Triangle.markNeighborPointers() call");this.neighbors_[2]=n}},r.prototype.markNeighbor=function(e){var t=this.points_;e.containsPoints(t[1],t[2])?(this.neighbors_[0]=e,e.markNeighborPointers(t[1],t[2],this)):e.containsPoints(t[0],t[2])?(this.neighbors_[1]=e,e.markNeighborPointers(t[0],t[2],this)):e.containsPoints(t[0],t[1])&&(this.neighbors_[2]=e,e.markNeighborPointers(t[0],t[1],this))},r.prototype.clearNeighbors=function(){this.neighbors_[0]=null,this.neighbors_[1]=null,this.neighbors_[2]=null},r.prototype.clearDelaunayEdges=function(){this.delaunay_edge[0]=!1,this.delaunay_edge[1]=!1,this.delaunay_edge[2]=!1},r.prototype.pointCW=function(e){var t=this.points_;return e===t[0]?t[2]:e===t[1]?t[0]:e===t[2]?t[1]:null},r.prototype.pointCCW=function(e){var t=this.points_;return e===t[0]?t[1]:e===t[1]?t[2]:e===t[2]?t[0]:null},r.prototype.neighborCW=function(e){return e===this.points_[0]?this.neighbors_[1]:e===this.points_[1]?this.neighbors_[2]:this.neighbors_[0]},r.prototype.neighborCCW=function(e){return e===this.points_[0]?this.neighbors_[2]:e===this.points_[1]?this.neighbors_[0]:this.neighbors_[1]},r.prototype.getConstrainedEdgeCW=function(e){return e===this.points_[0]?this.constrained_edge[1]:e===this.points_[1]?this.constrained_edge[2]:this.constrained_edge[0]},r.prototype.getConstrainedEdgeCCW=function(e){return e===this.points_[0]?this.constrained_edge[2]:e===this.points_[1]?this.constrained_edge[0]:this.constrained_edge[1]},r.prototype.getConstrainedEdgeAcross=function(e){return e===this.points_[0]?this.constrained_edge[0]:e===this.points_[1]?this.constrained_edge[1]:this.constrained_edge[2]},r.prototype.setConstrainedEdgeCW=function(e,t){e===this.points_[0]?this.constrained_edge[1]=t:e===this.points_[1]?this.constrained_edge[2]=t:this.constrained_edge[0]=t},r.prototype.setConstrainedEdgeCCW=function(e,t){e===this.points_[0]?this.constrained_edge[2]=t:e===this.points_[1]?this.constrained_edge[0]=t:this.constrained_edge[1]=t},r.prototype.getDelaunayEdgeCW=function(e){return e===this.points_[0]?this.delaunay_edge[1]:e===this.points_[1]?this.delaunay_edge[2]:this.delaunay_edge[0]},r.prototype.getDelaunayEdgeCCW=function(e){return e===this.points_[0]?this.delaunay_edge[2]:e===this.points_[1]?this.delaunay_edge[0]:this.delaunay_edge[1]},r.prototype.setDelaunayEdgeCW=function(e,t){e===this.points_[0]?this.delaunay_edge[1]=t:e===this.points_[1]?this.delaunay_edge[2]=t:this.delaunay_edge[0]=t},r.prototype.setDelaunayEdgeCCW=function(e,t){e===this.points_[0]?this.delaunay_edge[2]=t:e===this.points_[1]?this.delaunay_edge[0]=t:this.delaunay_edge[1]=t},r.prototype.neighborAcross=function(e){return e===this.points_[0]?this.neighbors_[0]:e===this.points_[1]?this.neighbors_[1]:this.neighbors_[2]},r.prototype.oppositePoint=function(e,t){var n=e.pointCW(t);return this.pointCW(n)},r.prototype.legalize=function(e,t){var n=this.points_;if(e===n[0])n[1]=n[0],n[0]=n[2],n[2]=t;else if(e===n[1])n[2]=n[1],n[1]=n[0],n[0]=t;else{if(e!==n[2])throw new Error("poly2tri Invalid Triangle.legalize() call");n[0]=n[2],n[2]=n[1],n[1]=t}},r.prototype.index=function(e){var t=this.points_;if(e===t[0])return 0;if(e===t[1])return 1;if(e===t[2])return 2;throw new Error("poly2tri Invalid Triangle.index() call")},r.prototype.edgeIndex=function(e,t){var n=this.points_;if(e===n[0]){if(t===n[1])return 2;if(t===n[2])return 1}else if(e===n[1]){if(t===n[2])return 0;if(t===n[0])return 2}else if(e===n[2]){if(t===n[0])return 1;if(t===n[1])return 0}return-1},r.prototype.markConstrainedEdgeByIndex=function(e){this.constrained_edge[e]=!0},r.prototype.markConstrainedEdgeByEdge=function(e){this.markConstrainedEdgeByPoints(e.p,e.q)},r.prototype.markConstrainedEdgeByPoints=function(e,t){var n=this.points_;t===n[0]&&e===n[1]||t===n[1]&&e===n[0]?this.constrained_edge[2]=!0:t===n[0]&&e===n[2]||t===n[2]&&e===n[0]?this.constrained_edge[1]=!0:(t===n[1]&&e===n[2]||t===n[2]&&e===n[1])&&(this.constrained_edge[0]=!0)},t.exports=r},{"./xy":11}],10:[function(e,t,n){function r(e,t,n){var r=(e.x-n.x)*(t.y-n.y),i=(e.y-n.y)*(t.x-n.x),s=r-i;return s>-o&&o>s?u.COLLINEAR:s>0?u.CCW:u.CW}function i(e,t,n,r){var i=(e.x-t.x)*(r.y-t.y)-(r.x-t.x)*(e.y-t.y);if(i>=-o)return!1;var s=(e.x-n.x)*(r.y-n.y)-(r.x-n.x)*(e.y-n.y);return o>=s?!1:!0}function s(e,t,n){var r=t.x-e.x,i=t.y-e.y,s=n.x-e.x,o=n.y-e.y;return 0>r*s+i*o}var o=1e-12;n.EPSILON=o;var u={CW:1,CCW:-1,COLLINEAR:0};n.Orientation=u,n.orient2d=r,n.inScanArea=i,n.isAngleObtuse=s},{}],11:[function(e,t){function n(e){return"("+e.x+";"+e.y+")"}function r(e){var t=e.toString();return"[object Object]"===t?n(e):t}function i(e,t){return e.y===t.y?e.x-t.x:e.y-t.y}function s(e,t){return e.x===t.x&&e.y===t.y}t.exports={toString:r,toStringBase:n,compare:i,equals:s}},{}]},{},[6])(6)}),r("polypartition",["./lib/poly2tri"],function(t){var n={};Point=function(e,t){this.x=e,this.y=t},n.Point=Point,Point.fromPointLike=function(e){return new Point(e.x,e.y)},Point.toString=function(e){return"x"+e.x+"y"+e.y},Point.prototype.add=function(e){return typeof e=="number"?new Point(this.x+e,this.y+e):new Point(this.x+e.x,this.y+e.y)},Point.prototype.sub=function(e){return typeof e=="number"?new Point(this.x-e,this.y-e):new Point(this.x-e.x,this.y-e.y)},Point.prototype.mul=function(e){return new Point(this.x*e,this.y*e)},Point.prototype.div=function(e){return new Point(this.x/e,this.y/e)},Point.prototype.eq=function(e){return this.x==e.x&&this.y==e.y},Point.prototype.neq=function(e){return this.x!=e.x||this.y!=e.y},Point.prototype.dot=function(e){return this.x*e.x+this.y*e.y},Point.prototype.cross=function(e){return this.x*e.y-this.y*e.x},Point.prototype.dist=function(e){var t=this.sub(e);return Math.sqrt(t.dot(t))},Point.prototype.dist2=function(e){var t=this.sub(e);return t.dot(t)},Point.prototype.zero=function(){return this.x==0&&this.y==0},Point.prototype.len=function(){return this.dist(new Point(0,0))},Point.prototype.normalize=function(){var e=this.dist(new Point(0,0));return e>0?this.div(e):new Point(0,0)},Point.prototype.toString=function(){return"x"+this.x+"y"+this.y},Point.prototype.clone=function(){return new Point(this.x,this.y)},Edge=function(e,t){this.p1=e,this.p2=t,this.center=e.add(t.sub(e).div(2)),this.points=[this.p1,this.center,this.p2]},n.Edge=Edge,Edge.prototype._CCW=function(t,n,r){return a=t.x,b=t.y,c=n.x,d=n.y,e=r.x,f=r.y,(f-b)*(c-a)>(d-b)*(e-a)},Edge.prototype.intersects=function(e){var t=e.p1,n=e.p2;return t.eq(this.p1)||t.eq(this.p2)||n.eq(this.p1)||n.eq(this.p2)?!1:this._CCW(this.p1,t,n)!=this._CCW(this.p2,t,n)&&this._CCW(this.p1,this.p2,t)!=this._CCW(this.p1,this.p2,n)},Poly=function(e){typeof e=="undefined"&&(e=!1),this.hole=!1,this.points=null,this.numpoints=0,e&&(this.numpoints=e.length,this.points=e.slice())},n.Poly=Poly,Poly.prototype.init=function(e){this.points=new Array(e),this.numpoints=e},Poly.prototype.update=function(){this.numpoints=this.points.length},Poly.prototype.triangle=function(e,t,n){this.init(3),this.points[0]=e,this.points[1]=t,this.points[2]=n},Poly.prototype.getPoint=function(e){return this.points&&this.numpoints>e?this.points[e]:null},Poly.prototype.setPoint=function(e,t){this.points&&this.points.length>e&&(this.points[e]=t)},Poly.prototype.getNextI=function(e){return(e+1)%this.numpoints},Poly.prototype.getPrevI=function(e){return e==0?this.numpoints-1:e-1},Poly.prototype.getArea=function(){var e=0;for(var t=0;t<this.numpoints;t++){var n=this.getNextI(t);e+=this.points[t].x*this.points[n].y-this.points[t].y*this.points[n].x}return e},Poly.prototype.getOrientation=function(){var e=this.getArea();return e>0?"CCW":e<0?"CW":0},Poly.prototype.setOrientation=function(e){var t=this.getOrientation();t&&t!==e&&this.invert()},Poly.prototype.invert=function(){var e=new Array(this.numpoints);for(var t=0;t<this.numpoints;t++)e[t]=this.points[this.numpoints-t-1];this.points=e},Poly.prototype.getCenter=function(){var e=this.points.map(function(e){return e.x}),t=this.points.map(function(e){return e.y}),n=Math.min.apply(null,e),r=Math.max.apply(null,e),i=Math.min.apply(null,t),s=Math.max.apply(null,t);return new Point((n+r)/2,(i+s)/2)},Poly.prototype.centroid=function(){var e=0,t=0,n,r,i,s,o;for(n=0,r=this.points.length-1;n<this.points.length;r=n,n+=1)s=this.points[n],o=this.points[r],i=s.x*o.y-o.x*s.y,e+=(s.x+o.x)*i,t+=(s.y+o.y)*i;return i=this.getArea()*3,e=Math.abs(e),t=Math.abs(t),new Point(e/i,t/i)},Poly.prototype.toPointString=function(e,t){e=e||" ",t=t||"\n";var n="";return this.points.forEach(function(r){n=n+r.x+e+r.y+t}),n},Poly.prototype.toString=function(){var e=this.centroid();return""+e.x+" "+e.y},Poly.prototype.containsPoint=function(e){var t=!1;for(var n=0,r=this.numpoints-1;n<this.numpoints;r=n++){var i=this.points[r],s=this.points[n];s.y>e.y!=i.y>e.y&&e.x<(i.x-s.x)*(e.y-s.y)/(i.y-s.y)+s.x&&(t=!t)}return t},Poly.prototype.clone=function(){return new Poly(this.points.slice().map(function(e){return e.clone()}))},Poly.prototype.translate=function(e){return new Poly(this.points.map(function(t){return t.add(e)}))},Poly.prototype.edges=function(){return this.hasOwnProperty("cached_edges")||(this.cached_edges=this.points.map(function(e,t){return new Edge(e,this.points[this.getNextI(t)])},this)),this.cached_edges},Poly.prototype.intersects=function(e){var t=e.points.some(function(e){return this.containsPoint(e)},this);t=t||this.points.some(function(t){return e.containsPoint(t)});if(t)return!0;var n=this.edges(),r=e.edges(),i=n.some(function(e){return r.some(function(t){return e.intersects(t)})});return i};var r={};return n.PolyUtils=r,r.isConvex=function(e,t,n){var r=(n.y-e.y)*(t.x-e.x)-(n.x-e.x)*(t.y-e.y);return r>0},r.findPolyForPoint=function(e,t){var n,r;for(n in t){r=t[n];if(r.containsPoint(e))return r}return null},r.lineCircleIntersection=function(e,t,n,r){var i={collides:!1,inside:!1,point:null,normal:null},s=n.sub(e);if(s.len()<=r)i.collides=!0,i.inside=s.len()!==r;else if(t.dot(s)>=0){var o=e.add(t.mul(t.dot(s))),u=n.sub(o).len();if(u<=r){i.collides=!0;var a=Math.sqrt(u*u+r*r);i.point=o.sub(t.mul(a)),i.normal=i.point.sub(n).normalize()}}return i},r.convexPartition=function(e,n,i){typeof n=="undefined"&&(n=!1),typeof i=="undefined"&&(i=5);var s,o,u,a,f,l,c=new Array;if(!n||n.length==0){var h=!1;for(var p=0;p<e.numpoints;p++){var d=e.getPrevI(p),v=e.getNextI(p);if(!r.isConvex(e.getPoint(d),e.getPoint(p),e.getPoint(v))){h=!0;break}}if(!h)return c.push(e),c}r._separatePolys(n.concat(e));var m=r._convertPolyToP2TPoly(e);n&&(n=n.map(r._convertPolyToP2TPoly));var g=new t.SweepContext(m);n&&g.addHoles(n);var y=g.triangulate().getTriangles();y=y.map(r._convertP2TPolyToPoly).filter(function(e){return e.getArea()>=i});for(var b=0;b<y.length;b++){var w=y[b],E=null;for(s=0;s<w.numpoints;s++){var S=w.getPoint(s);o=w.getNextI(s);var x=w.getPoint(o),T=!1;for(var N=b;N<y.length;N++){if(b==N)continue;var C=y[N];for(a=0;a<C.numpoints;a++){if(x.neq(C.getPoint(a)))continue;f=C.getNextI(a);if(S.neq(C.getPoint(f)))continue;T=!0,object_2_index=N;break}if(T)break}if(!T)continue;var k,L,A;L=w.getPoint(s),u=w.getPrevI(s),k=w.getPoint(u),l=C.getNextI(f),A=C.getPoint(l);if(!r.isConvex(k,L,A))continue;L=w.getPoint(o),u=w.getNextI(o),A=w.getPoint(u),l=C.getPrevI(a),k=C.getPoint(l);if(!r.isConvex(k,L,A))continue;var O=new Poly;O.init(w.numpoints+C.numpoints-2);var M=0;for(var _=o;_!=s;_=w.getNextI(_))O.setPoint(M,w.getPoint(_)),M++;for(var _=f;_!=a;_=C.getNextI(_))O.setPoint(M,C.getPoint(_)),M++;b>object_2_index?(y[b]=O,w=y[b],y.splice(object_2_index,1)):(y.splice(object_2_index,1),y[b]=O,w=y[b]),s=-1}}return y},r._separatePolys=function(e,t){t=t||1;var n={},r={};for(var i=0;i<e.length;i++){var s=e[i];for(var o=0;o<s.numpoints;o++){var u=s.points[o].toString();n.hasOwnProperty(u)?r[u]=!0:n[u]=!0}}var a=[],f;for(var i=0;i<e.length;i++){var s=e[i];for(var o=0;o<s.numpoints;o++){var u=s.points[o];r.hasOwnProperty(u.toString())&&(f=[u,o,s],a.push(f))}}a.sort(function(e,t){return t[1]-e[1]});var l,c,u,h,p,d;a.forEach(function(e,n,r){u=e[0],h=e[1],s=e[2],l=s.points[s.getPrevI(h)],c=s.points[s.getNextI(h)],p=u.add(l.sub(u).normalize().mul(t)),d=u.add(c.sub(u).normalize().mul(t)),s.points.splice(h,1,p,d),s.update()})},r._convertPolyToP2TPoly=function(e){return e.points.map(function(e){return new t.Point(e.x,e.y)})},r._convertP2TPolyToPoly=function(e){var t=e.getPoints().map(function(e){return new Point(e.x,e.y)});return new Poly(t)},n}),r("action-values",[],function(){return{"0-0-0-0":{v:!1,loc:"none"},"1-0-0-0":{v:!0,loc:"w"},"2-0-0-0":{v:!0,loc:"w"},"3-0-0-0":{v:!0,loc:"nw"},"0-1-0-0":{v:!0,loc:"n"},"1-1-0-0":{v:!1,loc:"w"},"2-1-0-0":[{v:!0,loc:{in_dir:"se",out_dir:"w"}},{v:!0,loc:{in_dir:"w",out_dir:"n"}}],"3-1-0-0":{v:!0,loc:"nw"},"0-2-0-0":{v:!0,loc:"ne"},"1-2-0-0":[{v:!0,loc:{in_dir:"s",out_dir:"w"}},{v:!0,loc:{in_dir:"w",out_dir:"ne"}}],"2-2-0-0":[{v:!0,loc:{in_dir:"se",out_dir:"w"}},{v:!0,loc:{in_dir:"w",out_dir:"ne"}}],"3-2-0-0":[{v:!0,loc:{in_dir:"w",out_dir:"ne"}},{v:!0,loc:{in_dir:"s",out_dir:"nw"}}],"0-3-0-0":{v:!0,loc:"n"},"1-3-0-0":{v:!0,loc:"w"},"2-3-0-0":[{v:!0,loc:{in_dir:"se",out_dir:"w"}},{v:!0,loc:{in_dir:"sw",out_dir:"n"}}],"3-3-0-0":{v:!0,loc:"nw"},"0-0-1-0":{v:!0,loc:"e"},"1-0-1-0":[{v:!0,loc:{in_dir:"s",out_dir:"w"}},{v:!0,loc:{in_dir:"n",out_dir:"e"}}],"2-0-1-0":[{v:!0,loc:{in_dir:"se",out_dir:"w"}},{v:!0,loc:{in_dir:"n",out_dir:"e"}}],"3-0-1-0":[{v:!0,loc:{in_dir:"n",out_dir:"e"}},{v:!0,loc:{in_dir:"s",out_dir:"nw"}}],"0-1-1-0":{v:!1,loc:"n"},"1-1-1-0":{v:!0,loc:"w"},"2-1-1-0":[{v:!0,loc:{in_dir:"se",out_dir:"w"}},{v:!1,loc:{in_dir:"n",out_dir:"n"}}],"3-1-1-0":{v:!0,loc:"nw"},"0-2-1-0":{v:!0,loc:"ne"},"1-2-1-0":[{v:!0,loc:{in_dir:"n",out_dir:"ne"}},{v:!0,loc:{in_dir:"s",out_dir:"w"}}],"2-2-1-0":[{v:!0,loc:{in_dir:"se",out_dir:"w"}},{v:!0,loc:{in_dir:"n",out_dir:"ne"}}],"3-2-1-0":[{v:!0,loc:{in_dir:"n",out_dir:"ne"}},{v:!0,loc:{in_dir:"s",out_dir:"nw"}}],"0-3-1-0":[{v:!0,loc:{in_dir:"n",out_dir:"e"}},{v:!0,loc:{in_dir:"sw",out_dir:"e"}}],"1-3-1-0":[{v:!0,loc:{in_dir:"n",out_dir:"e"}},{v:!0,loc:{in_dir:"sw",out_dir:"e"}}],"2-3-1-0":[{v:!0,loc:{in_dir:"se",out_dir:"w"}},{v:!0,loc:{in_dir:"n",out_dir:"e"}},{v:!0,loc:{in_dir:"sw",out_dir:"e"}}],"3-3-1-0":[{v:!0,loc:{in_dir:"n",out_dir:"e"}},{v:!0,loc:{in_dir:"sw",out_dir:"e"}}],"0-0-2-0":{v:!0,loc:"se"},"1-0-2-0":[{v:!0,loc:{in_dir:"s",out_dir:"w"}},{v:!0,loc:{in_dir:"n",out_dir:"se"}}],"2-0-2-0":[{v:!0,loc:{in_dir:"se",out_dir:"w"}},{v:!0,loc:{in_dir:"n",out_dir:"se"}}],"3-0-2-0":[{v:!0,loc:{in_dir:"s",out_dir:"nw"}},{v:!0,loc:{in_dir:"n",out_dir:"se"}}],"0-1-2-0":[{v:!0,loc:{in_dir:"w",out_dir:"n"}},{v:!0,loc:{in_dir:"n",out_dir:"se"}}],"1-1-2-0":[{v:!1,loc:{in_dir:"w",out_dir:"w"}},{v:!0,loc:{in_dir:"n",out_dir:"se"}}],"2-1-2-0":[{v:!0,loc:{in_dir:"se",out_dir:"w"}},{v:!0,loc:{in_dir:"w",out_dir:"n"}},{v:!0,loc:{in_dir:"n",out_dir:"se"}}],"3-1-2-0":[{v:!0,loc:{in_dir:"w",out_dir:"nw"}},{v:!0,loc:{in_dir:"n",out_dir:"se"}}],"0-2-2-0":[{v:!0,loc:{in_dir:"n",out_dir:"se"}},{v:!0,loc:{in_dir:"w",out_dir:"ne"}}],"1-2-2-0":[{v:!0,loc:{in_dir:"s",out_dir:"w"}},{v:!0,loc:{in_dir:"n",out_dir:"se"}},{v:!0,loc:{in_dir:"w",out_dir:"ne"}}],"2-2-2-0":[{v:!0,loc:{in_dir:"se",out_dir:"w"}},{v:!0,loc:{in_dir:"n",out_dir:"se"}},{v:!0,loc:{in_dir:"w",out_dir:"ne"}}],"3-2-2-0":[{v:!0,loc:{in_dir:"n",out_dir:"se"}},{v:!0,loc:{in_dir:"s",out_dir:"nw"}},{v:!0,loc:{in_dir:"w",out_dir:"ne"}}],"0-3-2-0":[{v:!0,loc:{in_dir:"sw",out_dir:"n"}},{v:!0,loc:{in_dir:"n",out_dir:"se"}}],"1-3-2-0":[{v:!0,loc:{in_dir:"sw",out_dir:"w"}},{v:!0,loc:{in_dir:"n",out_dir:"se"}}],"2-3-2-0":[{v:!0,loc:{in_dir:"se",out_dir:"w"}},{v:!0,loc:{in_dir:"sw",out_dir:"n"}},{v:!0,loc:{in_dir:"n",out_dir:"se"}}],"3-3-2-0":[{v:!0,loc:{in_dir:"sw",out_dir:"nw"}},{v:!0,loc:{in_dir:"n",out_dir:"se"}}],"0-0-3-0":{v:!0,loc:"e"},"1-0-3-0":[{v:!0,loc:{in_dir:"s",out_dir:"w"}},{v:!0,loc:{in_dir:"nw",out_dir:"e"}}],"2-0-3-0":[{v:!0,loc:{in_dir:"se",out_dir:"w"}},{v:!0,loc:{in_dir:"nw",out_dir:"e"}}],"3-0-3-0":[{v:!0,loc:{in_dir:"nw",out_dir:"e"}},{v:!0,loc:{in_dir:"s",out_dir:"nw"}}],"0-1-3-0":{v:!0,loc:"n"},"1-1-3-0":{v:!0,loc:"w"},"2-1-3-0":[{v:!0,loc:{in_dir:"se",out_dir:"w"}},{v:!0,loc:{in_dir:"nw",out_dir:"n"}}],"3-1-3-0":{v:!1,loc:"nw"},"0-2-3-0":{v:!0,loc:"ne"},"1-2-3-0":[{v:!0,loc:{in_dir:"nw",out_dir:"ne"}},{v:!0,loc:{in_dir:"s",out_dir:"w"}}],"2-2-3-0":[{v:!0,loc:{in_dir:"se",out_dir:"w"}},{v:!0,loc:{in_dir:"nw",out_dir:"ne"}}],"3-2-3-0":[{v:!0,loc:{in_dir:"nw",out_dir:"ne"}},{v:!0,loc:{in_dir:"s",out_dir:"nw"}}],"0-3-3-0":[{v:!0,loc:{in_dir:"sw",out_dir:"n"}},{v:!0,loc:{in_dir:"nw",out_dir:"e"}}],"1-3-3-0":[{v:!0,loc:{in_dir:"sw",out_dir:"e"}},{v:!0,loc:{in_dir:"nw",out_dir:"e"}}],"2-3-3-0":[{v:!0,loc:{in_dir:"se",out_dir:"w"}},{v:!0,loc:{in_dir:"sw",out_dir:"n"}},{v:!0,loc:{in_dir:"nw",out_dir:"e"}}],"3-3-3-0":[{v:!0,loc:{in_dir:"sw",out_dir:"e"}},{v:!0,loc:{in_dir:"nw",out_dir:"e"}}],"0-0-0-1":{v:!0,loc:"s"},"1-0-0-1":{v:!1,loc:"s"},"2-0-0-1":{v:!0,loc:"s"},"3-0-0-1":[{v:!0,loc:{in_dir:"e",out_dir:"s"}},{v:!0,loc:{in_dir:"s",out_dir:"nw"}}],"0-1-0-1":[{v:!0,loc:{in_dir:"e",out_dir:"s"}},{v:!0,loc:{in_dir:"w",out_dir:"n"}}],"1-1-0-1":{v:!0,loc:"s"},"2-1-0-1":[{v:!0,loc:{in_dir:"se",out_dir:"n"}},{v:!0,loc:{in_dir:"w",out_dir:"n"}}],"3-1-0-1":[{v:!0,loc:{in_dir:"e",out_dir:"s"}},{v:!0,loc:{in_dir:"w",out_dir:"nw"}}],"0-2-0-1":[{v:!0,loc:{in_dir:"e",out_dir:"s"}},{v:!0,loc:{in_dir:"w",out_dir:"ne"}}],"1-2-0-1":[{v:!1,loc:{in_dir:"s",out_dir:"s"}},{v:!0,loc:{in_dir:"w",out_dir:"ne"}}],"2-2-0-1":[{v:!0,loc:{in_dir:"se",out_dir:"s"}},{v:!0,loc:{in_dir:"w",out_dir:"ne"}}],"3-2-0-1":[{v:!0,loc:{in_dir:"e",out_dir:"s"}},{v:!0,loc:{in_dir:"w",out_dir:"ne"}},{v:!0,loc:{in_dir:"s",out_dir:"nw"}}],"0-3-0-1":[{v:!0,loc:{in_dir:"e",out_dir:"s"}},{v:!0,loc:{in_dir:"sw",out_dir:"n"}}],"1-3-0-1":{v:!0,loc:"s"},"2-3-0-1":[{v:!0,loc:{in_dir:"se",out_dir:"n"}},{v:!0,loc:{in_dir:"sw",out_dir:"n"}}],"3-3-0-1":[{v:!0,loc:{in_dir:"e",out_dir:"s"}},{v:!0,loc:{in_dir:"sw",out_dir:"nw"}}],"0-0-1-1":{v:!1,loc:"e"},"1-0-1-1":{v:!0,loc:"e"},"2-0-1-1":{v:!0,loc:"e"},"3-0-1-1":[{v:!1,loc:{in_dir:"e",out_dir:"e"}},{v:!0,loc:{in_dir:"s",out_dir:"nw"}}],"0-1-1-1":{v:!0,loc:"n"},"1-1-1-1":{v:!1,loc:"none"},"2-1-1-1":{v:!0,loc:"n"},"3-1-1-1":{v:!0,loc:"nw"},"0-2-1-1":{v:!0,loc:"ne"},"1-2-1-1":{v:!0,loc:"ne"},"2-2-1-1":{v:!0,loc:"ne"},"3-2-1-1":[{v:!0,loc:{in_dir:"e",out_dir:"ne"}},{v:!0,loc:{in_dir:"s",out_dir:"nw"}}],"0-3-1-1":[{v:!1,loc:{in_dir:"e",out_dir:"e"}},{v:!0,loc:{in_dir:"sw",out_dir:"e"}}],"1-3-1-1":{v:!0,loc:"e"},"2-3-1-1":[{v:!0,loc:{in_dir:"se",out_dir:"n"}},{v:!0,loc:{in_dir:"sw",out_dir:"e"}}],"3-3-1-1":[{v:!1,loc:{in_dir:"e",out_dir:"e"}},{v:!0,loc:{in_dir:"sw",out_dir:"e"}}],"0-0-2-1":{v:!0,loc:"se"},"1-0-2-1":{v:!0,loc:"se"},"2-0-2-1":{v:!1,loc:"se"},"3-0-2-1":[{v:!0,loc:{in_dir:"e",out_dir:"se"}},{v:!0,loc:{in_dir:"s",out_dir:"nw"}}],"0-1-2-1":[{v:!0,loc:{in_dir:"e",out_dir:"se"}},{v:!0,loc:{in_dir:"w",out_dir:"n"}}],"1-1-2-1":{v:!0,loc:"se"},"2-1-2-1":[{v:!0,loc:{in_dir:"se",out_dir:"n"}},{v:!0,loc:{in_dir:"w",out_dir:"n"}}],"3-1-2-1":[{v:!0,loc:{in_dir:"e",out_dir:"se"}},{v:!0,loc:{in_dir:"w",out_dir:"nw"}}],"0-2-2-1":[{v:!0,loc:{in_dir:"e",out_dir:"se"}},{v:!0,loc:{in_dir:"w",out_dir:"ne"}}],"1-2-2-1":[{v:!0,loc:{in_dir:"s",out_dir:"se"}},{v:!0,loc:{in_dir:"w",out_dir:"ne"}}],"2-2-2-1":[{v:!1,loc:{in_dir:"se",out_dir:"se"}},{v:!0,loc:{in_dir:"w",out_dir:"ne"}}],"3-2-2-1":[{v:!0,loc:{in_dir:"e",out_dir:"se"}},{v:!0,loc:{in_dir:"s",out_dir:"nw"}},{v:!0,loc:{in_dir:"w",out_dir:"ne"}}],"0-3-2-1":[{v:!0,loc:{in_dir:"e",out_dir:"se"}},{v:!0,loc:{in_dir:"sw",out_dir:"n"}}],"1-3-2-1":{v:!0,loc:"se"},"2-3-2-1":[{v:!0,loc:{in_dir:"se",out_dir:"n"}},{v:!0,loc:{in_dir:"sw",out_dir:"n"}}],"3-3-2-1":[{v:!0,loc:{in_dir:"e",out_dir:"se"}},{v:!0,loc:{in_dir:"sw",out_dir:"nw"}}],"0-0-3-1":[{v:!0,loc:{in_dir:"e",out_dir:"s"}},{v:!0,loc:{in_dir:"nw",out_dir:"s"}}],"1-0-3-1":[{v:!1,loc:{in_dir:"s",out_dir:"s"}},{v:!0,loc:{in_dir:"nw",out_dir:"s"}}],"2-0-3-1":[{v:!0,loc:{in_dir:"se",out_dir:"s"}},{v:!0,loc:{in_dir:"nw",out_dir:"s"}}],"3-0-3-1":[{v:!0,loc:{in_dir:"e",out_dir:"s"}},{v:!0,loc:{in_dir:"nw",out_dir:"s"}},{v:!0,loc:{in_dir:"s",out_dir:"nw"}}],"0-1-3-1":[{v:!0,loc:{in_dir:"e",out_dir:"s"}},{v:!0,loc:{in_dir:"nw",out_dir:"s"}}],"1-1-3-1":{v:!0,loc:"s"},"2-1-3-1":[{v:!0,loc:{in_dir:"se",out_dir:"n"}},{v:!0,loc:{in_dir:"nw",out_dir:"s"}}],"3-1-3-1":[{v:!0,loc:{in_dir:"e",out_dir:"s"}},{v:!0,loc:{in_dir:"nw",out_dir:"s"}}],"0-2-3-1":[{v:!0,loc:{in_dir:"e",out_dir:"s"}},{v:!0,loc:{in_dir:"nw",out_dir:"s"}}],"1-2-3-1":[{v:!0,loc:{in_dir:"nw",out_dir:"s"}},{v:!1,loc:{in_dir:"s",out_dir:"s"}}],"2-2-3-1":[{v:!0,loc:{in_dir:"se",out_dir:"s"}},{v:!0,loc:{in_dir:"nw",out_dir:"s"}}],"3-2-3-1":[{v:!0,loc:{in_dir:"e",out_dir:"s"}},{v:!0,loc:{in_dir:"nw",out_dir:"s"}},{v:!0,loc:{in_dir:"s",out_dir:"nw"}}],"0-3-3-1":[{v:!0,loc:{in_dir:"e",out_dir:"s"}},{v:!0,loc:{in_dir:"sw",out_dir:"n"}},{v:!0,loc:{in_dir:"nw",out_dir:"s"}}],"1-3-3-1":[{v:!0,loc:{in_dir:"sw",out_dir:"e"}},{v:!0,loc:{in_dir:"nw",out_dir:"s"}}],"2-3-3-1":[{v:!0,loc:{in_dir:"se",out_dir:"n"}},{v:!0,loc:{in_dir:"sw",out_dir:"n"}},{v:!0,loc:{in_dir:"nw",out_dir:"s"}}],"3-3-3-1":[{v:!0,loc:{in_dir:"e",out_dir:"s"}},{v:!0,loc:{in_dir:"sw",out_dir:"e"}},{v:!0,loc:{in_dir:"nw",out_dir:"s"}}],"0-0-0-2":{v:!0,loc:"s"},"1-0-0-2":[{v:!0,loc:{in_dir:"s",out_dir:"w"}},{v:!0,loc:{in_dir:"ne",out_dir:"w"}}],"2-0-0-2":[{v:!0,loc:{in_dir:"se",out_dir:"w"}},{v:!0,loc:{in_dir:"ne",out_dir:"w"}}],"3-0-0-2":[{v:!0,loc:{in_dir:"ne",out_dir:"s"}},{v:!0,loc:{in_dir:"s",out_dir:"nw"}}],"0-1-0-2":[{v:!0,loc:{in_dir:"w",out_dir:"n"}},{v:!0,loc:{in_dir:"ne",out_dir:"s"}}],"1-1-0-2":[{v:!1,loc:{in_dir:"w",out_dir:"w"}},{v:!0,loc:{in_dir:"ne",out_dir:"w"}}],"2-1-0-2":[{v:!0,loc:{in_dir:"se",out_dir:"w"}},{v:!0,loc:{in_dir:"w",out_dir:"n"}},{v:!0,loc:{in_dir:"ne",out_dir:"w"}}],"3-1-0-2":[{v:!0,loc:{in_dir:"w",out_dir:"nw"}},{v:!0,loc:{in_dir:"ne",out_dir:"s"}}],"0-2-0-2":[{v:!0,loc:{in_dir:"ne",out_dir:"s"}},{v:!0,loc:{in_dir:"w",out_dir:"ne"}}],"1-2-0-2":[{v:!0,loc:{in_dir:"ne",out_dir:"w"}},{v:!0,loc:{in_dir:"s",out_dir:"w"}},{v:!0,loc:{in_dir:"w",out_dir:"ne"}}],"2-2-0-2":[{v:!0,loc:{in_dir:"se",out_dir:"w"}},{v:!0,loc:{in_dir:"ne",out_dir:"w"}},{v:!0,loc:{in_dir:"w",out_dir:"ne"}}],"3-2-0-2":[{v:!0,loc:{in_dir:"ne",out_dir:"s"}},{v:!0,loc:{in_dir:"w",out_dir:"ne"}},{v:!0,loc:{in_dir:"s",out_dir:"nw"}}],"0-3-0-2":[{v:!0,loc:{in_dir:"sw",out_dir:"n"}},{v:!0,loc:{in_dir:"ne",out_dir:"s"}}],"1-3-0-2":[{v:!0,loc:{in_dir:"sw",out_dir:"w"}},{v:!0,loc:{in_dir:"ne",out_dir:"w"}}],"2-3-0-2":[{v:!0,loc:{in_dir:"se",out_dir:"w"}},{v:!0,loc:{in_dir:"sw",out_dir:"n"}},{v:!0,loc:{in_dir:"ne",out_dir:"w"}}],"3-3-0-2":[{v:!0,loc:{in_dir:"sw",out_dir:"nw"}},{v:!0,loc:{in_dir:"ne",out_dir:"s"}}],"0-0-1-2":{v:!0,loc:"e"},"1-0-1-2":[{v:!0,loc:{in_dir:"s",out_dir:"w"}},{v:!0,loc:{in_dir:"ne",out_dir:"w"}}],"2-0-1-2":[{v:!0,loc:{in_dir:"se",out_dir:"w"}},{v:!0,loc:{in_dir:"ne",out_dir:"w"}}],"3-0-1-2":[{v:!0,loc:{in_dir:"ne",out_dir:"e"}},{v:!0,loc:{in_dir:"s",out_dir:"nw"}}],"0-1-1-2":{v:!0,loc:"n"},"1-1-1-2":{v:!0,loc:"w"},"2-1-1-2":[{v:!0,loc:{in_dir:"se",out_dir:"w"}},{v:!0,loc:{in_dir:"ne",out_dir:"w"}}],"3-1-1-2":{v:!0,loc:"nw"},"0-2-1-2":{v:!1,loc:"ne"},"1-2-1-2":[{v:!0,loc:{in_dir:"ne",out_dir:"w"}},{v:!0,loc:{in_dir:"s",out_dir:"w"}}],"2-2-1-2":[{v:!0,loc:{in_dir:"se",out_dir:"w"}},{v:!0,loc:{in_dir:"ne",out_dir:"w"}}],"3-2-1-2":[{v:!1,loc:{in_dir:"ne",out_dir:"ne"}},{v:!0,loc:{in_dir:"s",out_dir:"nw"}}],"0-3-1-2":[{v:!0,loc:{in_dir:"sw",out_dir:"e"}},{v:!0,loc:{in_dir:"ne",out_dir:"e"}}],"1-3-1-2":[{v:!0,loc:{in_dir:"sw",out_dir:"e"}},{v:!0,loc:{in_dir:"ne",out_dir:"w"}}],"2-3-1-2":[{v:!0,loc:{in_dir:"se",out_dir:"w"}},{v:!0,loc:{in_dir:"sw",out_dir:"e"}},{v:!0,loc:{in_dir:"ne",out_dir:"w"}}],"3-3-1-2":[{v:!0,loc:{in_dir:"sw",out_dir:"e"}},{v:!0,loc:{in_dir:"ne",out_dir:"e"}}],"0-0-2-2":{v:!0,loc:"se"},"1-0-2-2":[{v:!0,loc:{in_dir:"s",out_dir:"w"}},{v:!0,loc:{in_dir:"ne",out_dir:"w"}}],"2-0-2-2":[{v:!0,loc:{in_dir:"se",out_dir:"w"}},{v:!0,loc:{in_dir:"ne",out_dir:"w"}}],"3-0-2-2":[{v:!0,loc:{in_dir:"ne",out_dir:"se"}},{v:!0,loc:{in_dir:"s",out_dir:"nw"}}],"0-1-2-2":[{v:!0,loc:{in_dir:"ne",out_dir:"se"}},{v:!0,loc:{in_dir:"w",out_dir:"n"}}],"1-1-2-2":[{v:!0,loc:{in_dir:"ne",out_dir:"w"}},{v:!1,loc:{in_dir:"w",out_dir:"w"}}],"2-1-2-2":[{v:!0,loc:{in_dir:"se",out_dir:"w"}},{v:!0,loc:{in_dir:"ne",out_dir:"w"}},{v:!0,loc:{in_dir:"w",out_dir:"n"}}],"3-1-2-2":[{v:!0,loc:{in_dir:"ne",out_dir:"se"}},{v:!0,loc:{in_dir:"w",out_dir:"nw"}}],"0-2-2-2":[{v:!0,loc:{in_dir:"ne",out_dir:"se"}},{v:!0,loc:{in_dir:"w",out_dir:"ne"}}],"1-2-2-2":[{v:!0,loc:{in_dir:"ne",out_dir:"w"}},{v:!0,loc:{in_dir:"s",out_dir:"w"}},{v:!0,loc:{in_dir:"w",out_dir:"ne"}}],"2-2-2-2":[{v:!0,loc:{in_dir:"se",out_dir:"w"}},{v:!0,loc:{in_dir:"ne",out_dir:"w"}},{v:!0,loc:{in_dir:"w",out_dir:"ne"}}],"3-2-2-2":[{v:!0,loc:{in_dir:"ne",out_dir:"se"}},{v:!0,loc:{in_dir:"s",out_dir:"nw"}},{v:!0,loc:{in_dir:"w",out_dir:"ne"}}],"0-3-2-2":[{v:!0,loc:{in_dir:"sw",out_dir:"n"}},{v:!0,loc:{in_dir:"ne",out_dir:"se"}}],"1-3-2-2":[{v:!0,loc:{in_dir:"sw",out_dir:"w"}},{v:!0,loc:{in_dir:"ne",out_dir:"w"}}],"2-3-2-2":[{v:!0,loc:{in_dir:"se",out_dir:"w"}},{v:!0,loc:{in_dir:"sw",out_dir:"n"}},{v:!0,loc:{in_dir:"ne",out_dir:"w"}}],"3-3-2-2":[{v:!0,loc:{in_dir:"sw",out_dir:"nw"}},{v:!0,loc:{in_dir:"ne",out_dir:"se"}}],"0-0-3-2":[{v:!0,loc:{in_dir:"nw",out_dir:"e"}},{v:!0,loc:{in_dir:"ne",out_dir:"s"}}],"1-0-3-2":[{v:!0,loc:{in_dir:"s",out_dir:"w"}},{v:!0,loc:{in_dir:"nw",out_dir:"e"}},{v:!0,loc:{in_dir:"ne",out_dir:"w"}}],"2-0-3-2":[{v:!0,loc:{in_dir:"se",out_dir:"w"}},{v:!0,loc:{in_dir:"nw",out_dir:"e"}},{v:!0,loc:{in_dir:"ne",out_dir:"w"}}],"3-0-3-2":[{v:!0,loc:{in_dir:"nw",out_dir:"e"}},{v:!0,loc:{in_dir:"ne",out_dir:"s"}},{v:!0,loc:{in_dir:"s",out_dir:"nw"}}],"0-1-3-2":[{v:!0,loc:{in_dir:"nw",out_dir:"s"}},{v:!0,loc:{in_dir:"ne",out_dir:"s"}}],"1-1-3-2":[{v:!0,loc:{in_dir:"nw",out_dir:"s"}},{v:!0,loc:{in_dir:"ne",out_dir:"w"}}],"2-1-3-2":[{v:!0,loc:{in_dir:"se",out_dir:"w"}},{v:!0,loc:{in_dir:"nw",out_dir:"s"}},{v:!0,loc:{in_dir:"ne",out_dir:"w"}}],"3-1-3-2":[{v:!0,loc:{in_dir:"nw",out_dir:"s"}},{v:!0,loc:{in_dir:"ne",out_dir:"s"}}],"0-2-3-2":[{v:!0,loc:{in_dir:"nw",out_dir:"s"}},{v:!0,loc:{in_dir:"ne",out_dir:"s"}}],"1-2-3-2":[{v:!0,loc:{in_dir:"nw",out_dir:"s"}},{v:!0,loc:{in_dir:"ne",out_dir:"w"}},{v:!0,loc:{in_dir:"s",out_dir:"w"}}],"2-2-3-2":[{v:!0,loc:{in_dir:"se",out_dir:"w"}},{v:!0,loc:{in_dir:"nw",out_dir:"s"}},{v:!0,loc:{in_dir:"ne",out_dir:"w"}}],"3-2-3-2":[{v:!0,loc:{in_dir:"nw",out_dir:"s"}},{v:!0,loc:{in_dir:"ne",out_dir:"s"}},{v:!0,loc:{in_dir:"s",out_dir:"nw"}}],"0-3-3-2":[{v:!0,loc:{in_dir:"sw",out_dir:"n"}},{v:!0,loc:{in_dir:"nw",out_dir:"e"}},{v:!0,loc:{in_dir:"ne",out_dir:"s"}}],"1-3-3-2":[{v:!0,loc:{in_dir:"sw",out_dir:"e"}},{v:!0,loc:{in_dir:"nw",out_dir:"e"}},{v:!0,loc:{in_dir:"ne",out_dir:"w"}}],"2-3-3-2":[{v:!0,loc:{in_dir:"se",out_dir:"w"}},{v:!0,loc:{in_dir:"sw",out_dir:"n"}},{v:!0,loc:{in_dir:"nw",out_dir:"e"}},{v:!0,loc:{in_dir:"ne",out_dir:"w"}}],"3-3-3-2":[{v:!0,loc:{in_dir:"sw",out_dir:"e"}},{v:!0,loc:{in_dir:"nw",out_dir:"e"}},{v:!0,loc:{in_dir:"ne",out_dir:"s"}}],"0-0-0-3":{v:!0,loc:"sw"},"1-0-0-3":{v:!0,loc:"sw"},"2-0-0-3":{v:!0,loc:"sw"},"3-0-0-3":[{v:!0,loc:{in_dir:"e",out_dir:"sw"}},{v:!0,loc:{in_dir:"s",out_dir:"nw"}}],"0-1-0-3":[{v:!0,loc:{in_dir:"e",out_dir:"sw"}},{v:!0,loc:{in_dir:"w",out_dir:"n"}}],"1-1-0-3":{v:!0,loc:"sw"},"2-1-0-3":[{v:!0,loc:{in_dir:"se",out_dir:"n"}},{v:!0,loc:{in_dir:"w",out_dir:"n"}}],"3-1-0-3":[{v:!0,loc:{in_dir:"e",out_dir:"sw"}},{v:!0,loc:{in_dir:"w",out_dir:"nw"}}],"0-2-0-3":[{v:!0,loc:{in_dir:"e",out_dir:"sw"}},{v:!0,loc:{in_dir:"w",out_dir:"ne"}}],"1-2-0-3":[{v:!0,loc:{in_dir:"s",out_dir:"sw"}},{v:!0,loc:{in_dir:"w",out_dir:"ne"}}],"2-2-0-3":[{v:!0,loc:{in_dir:"se",out_dir:"sw"}},{v:!0,loc:{in_dir:"w",out_dir:"ne"}}],"3-2-0-3":[{v:!0,loc:{in_dir:"e",out_dir:"sw"}},{v:!0,loc:{in_dir:"w",out_dir:"ne"}},{v:!0,loc:{in_dir:"s",out_dir:"nw"}}],"0-3-0-3":[{v:!0,loc:{in_dir:"e",out_dir:"sw"}},{v:!0,loc:{in_dir:"sw",out_dir:"n"}}],"1-3-0-3":{v:!1,loc:"sw"},"2-3-0-3":[{v:!0,loc:{in_dir:"se",out_dir:"n"}},{v:!0,loc:{in_dir:"sw",out_dir:"n"}}],"3-3-0-3":[{v:!0,loc:{in_dir:"e",out_dir:"sw"}},{v:!0,loc:{in_dir:"sw",out_dir:"nw"}}],"0-0-1-3":[{v:!0,loc:{in_dir:"e",out_dir:"sw"}},{v:!0,loc:{in_dir:"n",out_dir:"e"}}],"1-0-1-3":[{v:!0,loc:{in_dir:"s",out_dir:"sw"}},{v:!0,loc:{in_dir:"n",out_dir:"e"}}],"2-0-1-3":[{v:!0,loc:{in_dir:"se",out_dir:"sw"}},{v:!0,loc:{in_dir:"n",out_dir:"e"}}],"3-0-1-3":[{v:!0,loc:{in_dir:"e",out_dir:"sw"}},{v:!0,loc:{in_dir:"n",out_dir:"e"}},{v:!0,loc:{in_dir:"s",out_dir:"nw"}}],"0-1-1-3":[{v:!0,loc:{in_dir:"e",out_dir:"sw"}},{v:!1,loc:{in_dir:"n",out_dir:"n"}}],"1-1-1-3":{v:!0,loc:"sw"},"2-1-1-3":[{v:!0,loc:{in_dir:"se",out_dir:"n"}},{v:!1,loc:{in_dir:"n",out_dir:"n"}}],"3-1-1-3":[{v:!0,loc:{in_dir:"e",out_dir:"sw"}},{v:!0,loc:{in_dir:"n",out_dir:"nw"}}],"0-2-1-3":[{v:!0,loc:{in_dir:"e",out_dir:"sw"}},{v:!0,loc:{in_dir:"n",out_dir:"ne"}}],"1-2-1-3":[{v:!0,loc:{in_dir:"s",out_dir:"sw"}},{v:!0,loc:{in_dir:"n",out_dir:"ne"}}],"2-2-1-3":[{v:!0,loc:{in_dir:"se",out_dir:"sw"}},{v:!0,loc:{in_dir:"n",out_dir:"ne"}}],"3-2-1-3":[{v:!0,loc:{in_dir:"e",out_dir:"sw"}},{v:!0,loc:{in_dir:"n",out_dir:"ne"}},{v:!0,loc:{in_dir:"s",out_dir:"nw"}}],"0-3-1-3":[{v:!0,loc:{in_dir:"e",out_dir:"sw"}},{v:!0,loc:{in_dir:"sw",out_dir:"e"}},{v:!0,loc:{in_dir:"n",out_dir:"e"}}],"1-3-1-3":[{v:!0,loc:{in_dir:"sw",out_dir:"e"}},{v:!0,loc:{in_dir:"n",out_dir:"e"}}],"2-3-1-3":[{v:!0,loc:{in_dir:"se",out_dir:"n"}},{v:!0,loc:{in_dir:"sw",out_dir:"e"}},{v:!0,loc:{in_dir:"n",out_dir:"e"}}],"3-3-1-3":[{v:!0,loc:{in_dir:"e",out_dir:"sw"}},{v:!0,loc:{in_dir:"sw",out_dir:"e"}},{v:!0,loc:{in_dir:"n",out_dir:"e"}}],"0-0-2-3":[{v:!0,loc:{in_dir:"e",out_dir:"sw"}},{v:!0,loc:{in_dir:"n",out_dir:"se"}}],"1-0-2-3":[{v:!0,loc:{in_dir:"s",out_dir:"sw"}},{v:!0,loc:{in_dir:"n",out_dir:"se"}}],"2-0-2-3":[{v:!0,loc:{in_dir:"se",out_dir:"sw"}},{v:!0,loc:{in_dir:"n",out_dir:"se"}}],"3-0-2-3":[{v:!0,loc:{in_dir:"e",out_dir:"sw"}},{v:!0,loc:{in_dir:"s",out_dir:"nw"}},{v:!0,loc:{in_dir:"n",out_dir:"se"}}],"0-1-2-3":[{v:!0,loc:{in_dir:"e",out_dir:"sw"}},{v:!0,loc:{in_dir:"w",out_dir:"n"}},{v:!0,loc:{in_dir:"n",out_dir:"se"}}],"1-1-2-3":[{v:!0,loc:{in_dir:"w",out_dir:"sw"}},{v:!0,loc:{in_dir:"n",out_dir:"se"}}],"2-1-2-3":[{v:!0,loc:{in_dir:"se",out_dir:"n"}},{v:!0,loc:{in_dir:"w",out_dir:"n"}},{v:!0,loc:{in_dir:"n",out_dir:"se"}}],"3-1-2-3":[{v:!0,loc:{in_dir:"e",out_dir:"sw"}},{v:!0,loc:{in_dir:"w",out_dir:"nw"}},{v:!0,loc:{in_dir:"n",out_dir:"se"}}],"0-2-2-3":[{v:!0,loc:{in_dir:"e",out_dir:"sw"}},{v:!0,loc:{in_dir:"w",out_dir:"ne"}},{v:!0,loc:{in_dir:"n",out_dir:"se"}}],"1-2-2-3":[{v:!0,loc:{in_dir:"s",out_dir:"sw"}},{v:!0,loc:{in_dir:"w",out_dir:"ne"}},{v:!0,loc:{in_dir:"n",out_dir:"se"}}],"2-2-2-3":[{v:!0,loc:{in_dir:"se",out_dir:"sw"}},{v:!0,loc:{in_dir:"w",out_dir:"ne"}},{v:!0,loc:{in_dir:"n",out_dir:"se"}}],"3-2-2-3":[{v:!0,loc:{in_dir:"e",out_dir:"sw"}},{v:!0,loc:{in_dir:"s",out_dir:"nw"}},{v:!0,loc:{in_dir:"w",out_dir:"ne"}},{v:!0,loc:{in_dir:"n",out_dir:"se"}}],"0-3-2-3":[{v:!0,loc:{in_dir:"e",out_dir:"sw"}},{v:!0,loc:{in_dir:"sw",out_dir:"n"}},{v:!0,loc:{in_dir:"n",out_dir:"se"}}],"1-3-2-3":[{v:!1,loc:{in_dir:"sw",out_dir:"sw"}},{v:!0,loc:{in_dir:"n",out_dir:"se"}}],"2-3-2-3":[{v:!0,loc:{in_dir:"se",out_dir:"n"}},{v:!0,loc:{in_dir:"sw",out_dir:"n"}},{v:!0,loc:{in_dir:"n",out_dir:"se"}}],"3-3-2-3":[{v:!0,loc:{in_dir:"e",out_dir:"sw"}},{v:!0,loc:{in_dir:"sw",out_dir:"nw"}},{v:!0,loc:{in_dir:"n",out_dir:"se"}}],"0-0-3-3":[{v:!0,loc:{in_dir:"e",out_dir:"sw"}},{v:!0,loc:{in_dir:"nw",out_dir:"e"}}],"1-0-3-3":[{v:!0,loc:{in_dir:"s",out_dir:"sw"}},{v:!0,loc:{in_dir:"nw",out_dir:"e"}}],"2-0-3-3":[{v:!0,loc:{in_dir:"se",out_dir:"sw"}},{v:!0,loc:{in_dir:"nw",out_dir:"e"}}],"3-0-3-3":[{v:!0,loc:{in_dir:"e",out_dir:"sw"}},{v:!0,loc:{in_dir:"nw",out_dir:"e"}},{v:!0,loc:{in_dir:"s",out_dir:"nw"}}],"0-1-3-3":[{v:!0,loc:{in_dir:"e",out_dir:"sw"}},{v:!0,loc:{in_dir:"nw",out_dir:"n"}}],"1-1-3-3":{v:!0,loc:"sw"},"2-1-3-3":[{v:!0,loc:{in_dir:"se",out_dir:"n"}},{v:!0,loc:{in_dir:"nw",out_dir:"n"}}],"3-1-3-3":[{v:!0,loc:{in_dir:"e",out_dir:"sw"}},{v:!1,loc:{in_dir:"nw",out_dir:"nw"}}],"0-2-3-3":[{v:!0,loc:{in_dir:"e",out_dir:"sw"}},{v:!0,loc:{in_dir:"nw",out_dir:"ne"}}],"1-2-3-3":[{v:!0,loc:{in_dir:"nw",out_dir:"ne"}},{v:!0,loc:{in_dir:"s",out_dir:"sw"}}],"2-2-3-3":[{v:!0,loc:{in_dir:"se",out_dir:"sw"}},{v:!0,loc:{in_dir:"nw",out_dir:"ne"}}],"3-2-3-3":[{v:!0,loc:{in_dir:"e",out_dir:"sw"}},{v:!0,loc:{in_dir:"nw",out_dir:"ne"}},{v:!0,loc:{in_dir:"s",out_dir:"nw"}}],"0-3-3-3":[{v:!0,loc:{in_dir:"e",out_dir:"sw"}},{v:!0,loc:{in_dir:"sw",out_dir:"n"}},{v:!0,loc:{in_dir:"nw",out_dir:"e"}}],"1-3-3-3":[{v:!0,loc:{in_dir:"sw",out_dir:"e"}},{v:!0,loc:{in_dir:"nw",out_dir:"e"}}],"2-3-3-3":[{v:!0,loc:{in_dir:"se",out_dir:"n"}},{v:!0,loc:{in_dir:"sw",out_dir:"n"}},{v:!0,loc:{in_dir:"nw",out_dir:"e"}}],"3-3-3-3":[{v:!0,loc:{in_dir:"e",out_dir:"sw"}},{v:!0,loc:{in_dir:"sw",out_dir:"e"}},{v:!0,loc:{in_dir:"nw",out_dir:"e"}}]}}),r("parse-map",["./action-values","./polypartition"],function(e,t){function s(e,t){return e.map(function(e){return e.map(t)})}function o(e){var t=[1,1.1,1.2,1.3,1.4];return t.indexOf(e)!==-1?e==0?1:e:0}function u(e){var t=new Array(e.length-1);for(var n=0;n<t.length;n++)t[n]=new Array(e[0].length-1);var r=[1.1,1.2,1.3,1.4],i=[{1.1:3,1.2:0,1.3:2,1.4:1},{1.1:0,1.2:3,1.3:1,1.4:2},{1.1:3,1.2:1,1.3:2,1.4:0},{1.1:1,1.2:3,1.3:0,1.4:2}];for(var s=0;s<e.length-1;s++)for(var o=0;o<e[0].length-1;o++){var u=[e[s][o],e[s][o+1],e[s+1][o+1],e[s+1][o]];u.forEach(function(e,t,n){r.indexOf(e)!==-1&&(n[t]=i[t][e])}),t[s][o]=u}return t}function a(e,t,n){if(typeof n!="undefined"){for(var r=0;r<e.length;r++)if(n(e[r],t))return r;return-1}}function f(e,t){return e.c==t.c&&e.r==t.r}function l(e){function r(e,t){var r=0,i=0;if(t=="none")return null;var s=n[t];return{r:e.r+s[0],c:e.c+s[1]}}function i(t){return t.c+1<e[t.r].length?{r:t.r,c:t.c+1}:t.r+1<e.length?{r:t.r+1,c:0}:null}function s(e,t){return"r"+e.r+"c"+e.c+"d"+t}var t=e.length*e[0].length,n={n:[-1,0],e:[0,1],s:[1,0],w:[0,-1],ne:[-1,1],se:[1,1],sw:[1,-1],nw:[-1,-1]},o=[],u={r:0,c:0},l=[],c=[],h=null,p=null,d={},v=0;while(o.length!==t){if(!u)break;if(v>t*4)break;v++,a(o,u,f)==-1&&o.push(u);var m=e[u.r][u.c],g;if(m instanceof Array)if(p!=="none"){var y=!1;for(var b=0;b<m.length;b++){var w=m[b];if(w["loc"]["in_dir"]==p){m=w,g=w.loc.out_dir,y=!0;break}}if(!y)throw"Error!"}else{var y=!1;for(var b=0;b<m.length;b++){var w=m[b];if(!d[s(u,w.loc.out_dir)]){m=w,g=w.loc.out_dir,y=!0;break}}if(!y)throw"Error!"}else g=m.loc;d[s(u,g)]=!0,p=g;var E=r(u,g);if(E){var S=!1;c.length==0&&(S=!0,h=u,shape_node_start_action=p);if(!S&&f(u,h)&&p==shape_node_start_action){l.push(c),c=[],u=i(h);while(u&&a(o,u,f)!==-1)u=i(u);h=null}else(m.v||S)&&c.push(u),u=E}else{u=i(u);while(u&&a(o,u,f)!==-1)u=i(u)}}return o.length==t?l:null}function c(t){var n=t[0]+"-"+t[1]+"-"+t[2]+"-"+t[3];return e[n]}function h(e){var t=40,n=e.r*t,r=e.c*t;return{x:n,y:r}}function p(e){var t=40,n=s(e,function(e){var n=e.r*t,r=e.c*t;return{x:n,y:r}});return n}function d(e){var t=e.x+20,n=e.y+20,r=14,i=5.8;return[{x:t-r,y:n-i},{x:t-r,y:n+i},{x:t-i,y:n+r},{x:t+i,y:n+r},{x:t+r,y:n+i},{x:t+r,y:n-i},{x:t+i,y:n-r},{x:t-i,y:n-r}]}var n=t.Point,r=t.Poly,i={};i.extractSpikes=function(e){var t=[];return e.forEach(function(e,n){e.forEach(function(e,r,i){e==7&&(t.push({r:n,c:r}),i[r]=2)})}),t};var v=function(e,t){this.type=e,this.vals=[],this.info={},t.forEach(function(e){typeof e=="number"?(this.vals.push(e),this.info[e]=this.type):(this.vals.push(e.num),this.info[e]=e.name)},this)};v.prototype.describes=function(e){return this.vals.indexOf(Math.floor(+e))!==-1?this.info[+e]||this.info[Math.floor(+e)]:!1};var m=[new v("bomb",[10,10.1]),new v("boost",[5,5.1,{num:14,name:"redboost"},{num:15,name:"blueboost"}]),new v("gate",[9,{num:9.1,name:"greengate"},{num:9.2,name:"redgate"},{num:9.3,name:"bluegate"}])];return i.extractDynamicObstacles=function(e){var t=[];return e.forEach(function(n,r){n.forEach(function(n,i){m.some(function(s){var o=s.describes(n);return o?(t.push({type:o,x:r,y:i,v:n}),e[r][i]=0,!0):!1})})}),t},i.parse=function(e){e=JSON.parse(JSON.stringify(e));var t=i.extractSpikes(e),n=i.extractDynamicObstacles(e),r=[];for(var a=0;a<e[0].length+2;a++)r.push(1);e.forEach(function(e){e.unshift(1),e.push(1)}),e.unshift(r),e.push(r.slice());var f=s(e,o),v=u(f),m=s(v,c),g=l(m);if(!g)return null;var y=g.filter(function(e){return e.length>0}),b=p(y),w=t.map(function(e){return d(h(e))});return{walls:this.convertShapesToPolys(b),static_obstacles:this.convertShapesToPolys(w),dynamic_obstacles:n}},i.convertShapesToPolys=function(e){var t=e.map(function(e){return i.convertShapeToPoly(e)});return t},i.convertShapeToPoly=function(e){var t=new r;t.init(e.length);for(var i=0;i<e.length;i++){var s=new n(e[i].x,e[i].y);t.setPoint(i,s)}return t},i}),!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof r&&r.amd)r("lib/priority-queue",[],e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.PriorityQueue=e()}}(function(){return function e(t,r,i){function s(u,f){if(!r[u]){if(!t[u]){var l="function"==typeof n&&n;if(!f&&l)return l(u,!0);if(o)return o(u,!0);var c=new Error("Cannot find module '"+u+"'");throw c.code="MODULE_NOT_FOUND",c}var h=r[u]={exports:{}};t[u][0].call(h.exports,function(e){var n=t[u][1][e];return s(n?n:e)},h,h.exports,e,t,r,i)}return r[u].exports}for(var o="function"==typeof n&&n,u=0;u<i.length;u++)s(i[u]);return s}({1:[function(e,t){var n,r,i,s,o,u={}.hasOwnProperty,a=function(e,t){function n(){this.constructor=e}for(var r in t)u.call(t,r)&&(e[r]=t[r]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};n=e("./PriorityQueue/AbstractPriorityQueue"),r=e("./PriorityQueue/ArrayStrategy"),s=e("./PriorityQueue/BinaryHeapStrategy"),i=e("./PriorityQueue/BHeapStrategy"),o=function(e){function t(e){e||(e={}),e.strategy||(e.strategy=s),e.comparator||(e.comparator=function(e,t){return(e||0)-(t||0)}),t.__super__.constructor.call(this,e)}return a(t,e),t}(n),o.ArrayStrategy=r,o.BinaryHeapStrategy=s,o.BHeapStrategy=i,t.exports=o},{"./PriorityQueue/AbstractPriorityQueue":2,"./PriorityQueue/ArrayStrategy":3,"./PriorityQueue/BHeapStrategy":4,"./PriorityQueue/BinaryHeapStrategy":5}],2:[function(e,t){var n;t.exports=n=function(){function e(e){if(null==(null!=e?e.strategy:void 0))throw"Must pass options.strategy, a strategy";if(null==(null!=e?e.comparator:void 0))throw"Must pass options.comparator, a comparator";this.priv=new e.strategy(e),this.length=0}return e.prototype.queue=function(e){return this.length++,void this.priv.queue(e)},e.prototype.dequeue=function(){if(!this.length)throw"Empty queue";return this.length--,this.priv.dequeue()},e.prototype.peek=function(){if(!this.length)throw"Empty queue";return this.priv.peek()},e}()},{}],3:[function(e,t){var n,r;r=function(e,t,n){var r,i,s;for(i=0,r=e.length;r>i;)s=i+r>>>1,n(e[s],t)>=0?i=s+1:r=s;return i},t.exports=n=function(){function e(e){var t;this.options=e,this.comparator=this.options.comparator,this.data=(null!=(t=this.options.initialValues)?t.slice(0):void 0)||[],this.data.sort(this.comparator).reverse()}return e.prototype.queue=function(e){var t;return t=r(this.data,e,this.comparator),void this.data.splice(t,0,e)},e.prototype.dequeue=function(){return this.data.pop()},e.prototype.peek=function(){return this.data[this.data.length-1]},e}()},{}],4:[function(e,t){var n;t.exports=n=function(){function e(e){var t,n,r,i,s,o,u,a,f;for(this.comparator=(null!=e?e.comparator:void 0)||function(e,t){return e-t},this.pageSize=(null!=e?e.pageSize:void 0)||512,this.length=0,r=0;1<<r<this.pageSize;)r+=1;if(1<<r!==this.pageSize)throw"pageSize must be a power of two";for(this._shift=r,this._emptyMemoryPageTemplate=t=[],n=s=0,a=this.pageSize;a>=0?a>s:s>a;n=a>=0?++s:--s)t.push(null);if(this._memory=[],this._mask=this.pageSize-1,e.initialValues)for(f=e.initialValues,o=0,u=f.length;u>o;o++)i=f[o],this.queue(i)}return e.prototype.queue=function(e){return this.length+=1,this._write(this.length,e),void this._bubbleUp(this.length,e)},e.prototype.dequeue=function(){var e,t;return e=this._read(1),t=this._read(this.length),this.length-=1,this.length>0&&(this._write(1,t),this._bubbleDown(1,t)),e},e.prototype.peek=function(){return this._read(1)},e.prototype._write=function(e,t){var n;for(n=e>>this._shift;n>=this._memory.length;)this._memory.push(this._emptyMemoryPageTemplate.slice(0));return this._memory[n][e&this._mask]=t},e.prototype._read=function(e){return this._memory[e>>this._shift][e&this._mask]},e.prototype._bubbleUp=function(e,t){var n,r,i,s;for(n=this.comparator;e>1&&(r=e&this._mask,e<this.pageSize||r>3?i=e&~this._mask|r>>1:2>r?(i=e-this.pageSize>>this._shift,i+=i&~(this._mask>>1),i|=this.pageSize>>1):i=e-2,s=this._read(i),!(n(s,t)<0));)this._write(i,t),this._write(e,s),e=i;return void 0},e.prototype._bubbleDown=function(e,t){var n,r,i,s,o;for(o=this.comparator;e<this.length;)if(e>this._mask&&!(e&this._mask-1)?n=r=e+2:e&this.pageSize>>1?(n=(e&~this._mask)>>1,n|=e&this._mask>>1,n=n+1<<this._shift,r=n+1):(n=e+(e&this._mask),r=n+1),n!==r&&r<=this.length)if(i=this._read(n),s=this._read(r),o(i,t)<0&&o(i,s)<=0)this._write(n,t),this._write(e,i),e=n;else{if(!(o(s,t)<0))break;this._write(r,t),this._write(e,s),e=r}else{if(!(n<=this.length))break;if(i=this._read(n),!(o(i,t)<0))break;this._write(n,t),this._write(e,i),e=n}return void 0},e}()},{}],5:[function(e,t){var n;t.exports=n=function(){function e(e){var t;this.comparator=(null!=e?e.comparator:void 0)||function(e,t){return e-t},this.length=0,this.data=(null!=(t=e.initialValues)?t.slice(0):void 0)||[],this._heapify()}return e.prototype._heapify=function(){var e,t,n;if(this.data.length>0)for(e=t=1,n=this.data.length;n>=1?n>t:t>n;e=n>=1?++t:--t)this._bubbleUp(e);return void 0},e.prototype.queue=function(e){return this.data.push(e),void this._bubbleUp(this.data.length-1)},e.prototype.dequeue=function(){var e,t;return t=this.data[0],e=this.data.pop(),this.data.length>0&&(this.data[0]=e,this._bubbleDown(0)),t},e.prototype.peek=function(){return this.data[0]},e.prototype._bubbleUp=function(e){for(var t,n;e>0&&(t=e-1>>>1,this.comparator(this.data[e],this.data[t])<0);)n=this.data[t],this.data[t]=this.data[e],this.data[e]=n,e=t;return void 0},e.prototype._bubbleDown=function(e){var t,n,r,i,s;for(t=this.data.length-1;;){if(n=(e<<1)+1,i=n+1,r=e,t>=n&&this.comparator(this.data[n],this.data[r])<0&&(r=n),t>=i&&this.comparator(this.data[i],this.data[r])<0&&(r=i),r===e)break;s=this.data[r],this.data[r]=this.data[e],this.data[e]=s,e=r}return void 0},e}()},{}]},{},[1])(1)}),r("pathfinder",["./lib/priority-queue","./polypartition"],function(e,t){var n=t.PolyUtils,r=function(e,t){typeof t=="undefined"&&(t=!0),this.polys=e,t&&this.init()};return r.prototype.init=function(){this.grid=this.generateAdjacencyGrid(this.polys)},r.prototype.aStar=function(t,r){function i(e,t){return e.dist+u(e.point)-(t.dist+u(t.point))}function s(e,t){return e.dist(t)}function o(e,t){return e.r-t.r+(e.c-t.c)}function u(e){return s(e,r)}var a=n.findPolyForPoint(t,this.polys);if(!a){var f=[new Point(5,0),new Point(-5,0),new Point(0,-5),new Point(0,5)];for(var l=0;l<f.length;l++){var c=t.add(f[l]);a=n.findPolyForPoint(c,this.polys);if(a){t=c;break}}if(!a)return null}var h=n.findPolyForPoint(r,this.polys);if(a==h)return[t,r];var p=new WeakSet,d=new WeakSet,v=new e({comparator:i}),m=null;v.queue({dist:0,poly:a,point:t,parent:null});while(v.length>0){var g=v.dequeue();if(g.poly==h){m=g;break}p.add(g.poly),d.add(g.point);var y=this.grid.get(g.poly);for(var l=0;l<y.length;l++){var b=y[l],w=p.has(b.poly);for(var E=0;E<b.edge.points.length;E++){var S=b.edge.points[E];(!w||!d.has(S))&&v.queue({dist:g.dist+s(S,g.point),poly:b.poly,point:S,parent:g})}}}if(m){var x=[],T=m;while(T.parent)x.unshift(T.point),T=T.parent;return x.unshift(T.point),x.push(r),x}return null},r.prototype.generateAdjacencyGrid=function(e){var t=new WeakMap;return e.forEach(function(e,n,r){if(t.has(e)){if(t.get(e).length==e.numpoints)return}else t.set(e,new Array);e.points.forEach(function(i,s,o){var u=o[e.getNextI(s)];for(var a=n+1;a<r.length;a++){var f=r[a];f.points.some(function(n,r,s){var o=s[f.getNextI(r)],a=i.eq(o)&&u.eq(n);if(a){var l=new Edge(i,u);t.get(e).push({poly:f,edge:l}),t.has(f)||t.set(f,new Array),t.get(f).push({poly:e,edge:l})}return a});if(t.get(e).length==e.numpoints)break}})}),t},r}),r("lib/clipper",[],function(){function e(e,t,n){nn.biginteger_used=1,null!=e&&("number"==typeof e&&"undefined"==typeof t?this.fromInt(e):"number"==typeof e?this.fromNumber(e,t,n):null==t&&"string"!=typeof e?this.fromString(e,256):this.fromString(e,t))}function t(){return new e(null)}function n(e,t,n,r,i,s){for(;--s>=0;){var o=t*this[e++]+n[r]+i;i=Math.floor(o/67108864),n[r++]=67108863&o}return i}function r(e,t,n,r,i,s){for(var o=32767&t,u=t>>15;--s>=0;){var a=32767&this[e],f=this[e++]>>15,l=u*a+f*o;a=o*a+((32767&l)<<15)+n[r]+(1073741823&i),i=(a>>>30)+(l>>>15)+u*f+(i>>>30),n[r++]=1073741823&a}return i}function i(e,t,n,r,i,s){for(var o=16383&t,u=t>>14;--s>=0;){var a=16383&this[e],f=this[e++]>>14,l=u*a+f*o;a=o*a+((16383&l)<<14)+n[r]+i,i=(a>>28)+(l>>14)+u*f,n[r++]=268435455&a}return i}function s(e){return dn.charAt(e)}function o(e,t){var n=vn[e.charCodeAt(t)];return null==n?-1:n}function u(e){for(var t=this.t-1;t>=0;--t)e[t]=this[t];e.t=this.t,e.s=this.s}function a(e){this.t=1,this.s=0>e?-1:0,e>0?this[0]=e:-1>e?this[0]=e+this.DV:this.t=0}function f(e){var n=t();return n.fromInt(e),n}function l(t,n){var r;if(16==n)r=4;else if(8==n)r=3;else if(256==n)r=8;else if(2==n)r=1;else if(32==n)r=5;else{if(4!=n)return this.fromRadix(t,n),void 0;r=2}this.t=0,this.s=0;for(var i=t.length,s=!1,u=0;--i>=0;){var a=8==r?255&t[i]:o(t,i);0>a?"-"==t.charAt(i)&&(s=!0):(s=!1,0==u?this[this.t++]=a:u+r>this.DB?(this[this.t-1]|=(a&(1<<this.DB-u)-1)<<u,this[this.t++]=a>>this.DB-u):this[this.t-1]|=a<<u,u+=r,u>=this.DB&&(u-=this.DB))}8==r&&0!=(128&t[0])&&(this.s=-1,u>0&&(this[this.t-1]|=(1<<this.DB-u)-1<<u)),this.clamp(),s&&e.ZERO.subTo(this,this)}function c(){for(var e=this.s&this.DM;this.t>0&&this[this.t-1]==e;)--this.t}function h(e){if(this.s<0)return"-"+this.negate().toString(e);var t;if(16==e)t=4;else if(8==e)t=3;else if(2==e)t=1;else if(32==e)t=5;else{if(4!=e)return this.toRadix(e);t=2}var n,r=(1<<t)-1,i=!1,o="",u=this.t,a=this.DB-u*this.DB%t;if(u-->0)for(a<this.DB&&(n=this[u]>>a)>0&&(i=!0,o=s(n));u>=0;)t>a?(n=(this[u]&(1<<a)-1)<<t-a,n|=this[--u]>>(a+=this.DB-t)):(n=this[u]>>(a-=t)&r,0>=a&&(a+=this.DB,--u)),n>0&&(i=!0),i&&(o+=s(n));return i?o:"0"}function p(){var n=t();return e.ZERO.subTo(this,n),n}function d(){return this.s<0?this.negate():this}function v(e){var t=this.s-e.s;if(0!=t)return t;var n=this.t;if(t=n-e.t,0!=t)return this.s<0?-t:t;for(;--n>=0;)if(0!=(t=this[n]-e[n]))return t;return 0}function m(e){var t,n=1;return 0!=(t=e>>>16)&&(e=t,n+=16),0!=(t=e>>8)&&(e=t,n+=8),0!=(t=e>>4)&&(e=t,n+=4),0!=(t=e>>2)&&(e=t,n+=2),0!=(t=e>>1)&&(e=t,n+=1),n}function g(){return this.t<=0?0:this.DB*(this.t-1)+m(this[this.t-1]^this.s&this.DM)}function y(e,t){var n;for(n=this.t-1;n>=0;--n)t[n+e]=this[n];for(n=e-1;n>=0;--n)t[n]=0;t.t=this.t+e,t.s=this.s}function b(e,t){for(var n=e;n<this.t;++n)t[n-e]=this[n];t.t=Math.max(this.t-e,0),t.s=this.s}function w(e,t){var n,r=e%this.DB,i=this.DB-r,s=(1<<i)-1,o=Math.floor(e/this.DB),u=this.s<<r&this.DM;for(n=this.t-1;n>=0;--n)t[n+o+1]=this[n]>>i|u,u=(this[n]&s)<<r;for(n=o-1;n>=0;--n)t[n]=0;t[o]=u,t.t=this.t+o+1,t.s=this.s,t.clamp()}function E(e,t){t.s=this.s;var n=Math.floor(e/this.DB);if(n>=this.t)return t.t=0,void 0;var r=e%this.DB,i=this.DB-r,s=(1<<r)-1;t[0]=this[n]>>r;for(var o=n+1;o<this.t;++o)t[o-n-1]|=(this[o]&s)<<i,t[o-n]=this[o]>>r;r>0&&(t[this.t-n-1]|=(this.s&s)<<i),t.t=this.t-n,t.clamp()}function S(e,t){for(var n=0,r=0,i=Math.min(e.t,this.t);i>n;)r+=this[n]-e[n],t[n++]=r&this.DM,r>>=this.DB;if(e.t<this.t){for(r-=e.s;n<this.t;)r+=this[n],t[n++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;n<e.t;)r-=e[n],t[n++]=r&this.DM,r>>=this.DB;r-=e.s}t.s=0>r?-1:0,-1>r?t[n++]=this.DV+r:r>0&&(t[n++]=r),t.t=n,t.clamp()}function x(t,n){var r=this.abs(),i=t.abs(),s=r.t;for(n.t=s+i.t;--s>=0;)n[s]=0;for(s=0;s<i.t;++s)n[s+r.t]=r.am(0,i[s],n,s,0,r.t);n.s=0,n.clamp(),this.s!=t.s&&e.ZERO.subTo(n,n)}function T(e){for(var t=this.abs(),n=e.t=2*t.t;--n>=0;)e[n]=0;for(n=0;n<t.t-1;++n){var r=t.am(n,t[n],e,2*n,0,1);(e[n+t.t]+=t.am(n+1,2*t[n],e,2*n+1,r,t.t-n-1))>=t.DV&&(e[n+t.t]-=t.DV,e[n+t.t+1]=1)}e.t>0&&(e[e.t-1]+=t.am(n,t[n],e,2*n,0,1)),e.s=0,e.clamp()}function N(n,r,i){var s=n.abs();if(!(s.t<=0)){var o=this.abs();if(o.t<s.t)return null!=r&&r.fromInt(0),null!=i&&this.copyTo(i),void 0;null==i&&(i=t());var u=t(),a=this.s,f=n.s,l=this.DB-m(s[s.t-1]);l>0?(s.lShiftTo(l,u),o.lShiftTo(l,i)):(s.copyTo(u),o.copyTo(i));var c=u.t,h=u[c-1];if(0!=h){var p=h*(1<<this.F1)+(c>1?u[c-2]>>this.F2:0),d=this.FV/p,v=(1<<this.F1)/p,g=1<<this.F2,y=i.t,b=y-c,w=null==r?t():r;for(u.dlShiftTo(b,w),i.compareTo(w)>=0&&(i[i.t++]=1,i.subTo(w,i)),e.ONE.dlShiftTo(c,w),w.subTo(u,u);u.t<c;)u[u.t++]=0;for(;--b>=0;){var E=i[--y]==h?this.DM:Math.floor(i[y]*d+(i[y-1]+g)*v);if((i[y]+=u.am(0,E,i,b,0,c))<E)for(u.dlShiftTo(b,w),i.subTo(w,i);i[y]<--E;)i.subTo(w,i)}null!=r&&(i.drShiftTo(c,r),a!=f&&e.ZERO.subTo(r,r)),i.t=c,i.clamp(),l>0&&i.rShiftTo(l,i),0>a&&e.ZERO.subTo(i,i)}}}function C(n){var r=t();return this.abs().divRemTo(n,null,r),this.s<0&&r.compareTo(e.ZERO)>0&&n.subTo(r,r),r}function k(e){this.m=e}function L(e){return e.s<0||e.compareTo(this.m)>=0?e.mod(this.m):e}function A(e){return e}function O(e){e.divRemTo(this.m,null,e)}function M(e,t,n){e.multiplyTo(t,n),this.reduce(n)}function _(e,t){e.squareTo(t),this.reduce(t)}function D(){if(this.t<1)return 0;var e=this[0];if(0==(1&e))return 0;var t=3&e;return t=15&t*(2-(15&e)*t),t=255&t*(2-(255&e)*t),t=65535&t*(2-(65535&(65535&e)*t)),t=t*(2-e*t%this.DV)%this.DV,t>0?this.DV-t:-t}function P(e){this.m=e,this.mp=e.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}function H(n){var r=t();return n.abs().dlShiftTo(this.m.t,r),r.divRemTo(this.m,null,r),n.s<0&&r.compareTo(e.ZERO)>0&&this.m.subTo(r,r),r}function B(e){var n=t();return e.copyTo(n),this.reduce(n),n}function j(e){for(;e.t<=this.mt2;)e[e.t++]=0;for(var t=0;t<this.m.t;++t){var n=32767&e[t],r=n*this.mpl+((n*this.mph+(e[t]>>15)*this.mpl&this.um)<<15)&e.DM;for(n=t+this.m.t,e[n]+=this.m.am(0,r,e,t,0,this.m.t);e[n]>=e.DV;)e[n]-=e.DV,e[++n]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)}function F(e,t){e.squareTo(t),this.reduce(t)}function I(e,t,n){e.multiplyTo(t,n),this.reduce(n)}function q(){return 0==(this.t>0?1&this[0]:this.s)}function R(n,r){if(n>4294967295||1>n)return e.ONE;var i=t(),s=t(),o=r.convert(this),u=m(n)-1;for(o.copyTo(i);--u>=0;)if(r.sqrTo(i,s),(n&1<<u)>0)r.mulTo(s,o,i);else{var a=i;i=s,s=a}return r.revert(i)}function U(e,t){var n;return n=256>e||t.isEven()?new k(t):new P(t),this.exp(e,n)}function z(){var e=t();return this.copyTo(e),e}function W(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function X(){return 0==this.t?this.s:this[0]<<24>>24}function V(){return 0==this.t?this.s:this[0]<<16>>16}function $(e){return Math.floor(Math.LN2*this.DB/Math.log(e))}function J(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1}function K(e){if(null==e&&(e=10),0==this.signum()||2>e||e>36)return"0";var n=this.chunkSize(e),r=Math.pow(e,n),i=f(r),s=t(),o=t(),u="";for(this.divRemTo(i,s,o);s.signum()>0;)u=(r+o.intValue()).toString(e).substr(1)+u,s.divRemTo(i,s,o);return o.intValue().toString(e)+u}function Q(t,n){this.fromInt(0),null==n&&(n=10);for(var r=this.chunkSize(n),i=Math.pow(n,r),s=!1,u=0,a=0,f=0;f<t.length;++f){var l=o(t,f);0>l?"-"==t.charAt(f)&&0==this.signum()&&(s=!0):(a=n*a+l,++u>=r&&(this.dMultiply(i),this.dAddOffset(a,0),u=0,a=0))}u>0&&(this.dMultiply(Math.pow(n,u)),this.dAddOffset(a,0)),s&&e.ZERO.subTo(this,this)}function G(t,n,r){if("number"==typeof n)if(2>t)this.fromInt(1);else for(this.fromNumber(t,r),this.testBit(t-1)||this.bitwiseTo(e.ONE.shiftLeft(t-1),st,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(n);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(e.ONE.shiftLeft(t-1),this);else{var i=new Array,s=7&t;i.length=(t>>3)+1,n.nextBytes(i),s>0?i[0]&=(1<<s)-1:i[0]=0,this.fromString(i,256)}}function Y(){var e=this.t,t=new Array;t[0]=this.s;var n,r=this.DB-e*this.DB%8,i=0;if(e-->0)for(r<this.DB&&(n=this[e]>>r)!=(this.s&this.DM)>>r&&(t[i++]=n|this.s<<this.DB-r);e>=0;)8>r?(n=(this[e]&(1<<r)-1)<<8-r,n|=this[--e]>>(r+=this.DB-8)):(n=255&this[e]>>(r-=8),0>=r&&(r+=this.DB,--e)),0!=(128&n)&&(n|=-256),0==i&&(128&this.s)!=(128&n)&&++i,(i>0||n!=this.s)&&(t[i++]=n);return t}function Z(e){return 0==this.compareTo(e)}function et(e){return this.compareTo(e)<0?this:e}function tt(e){return this.compareTo(e)>0?this:e}function nt(e,t,n){var r,i,s=Math.min(e.t,this.t);for(r=0;s>r;++r)n[r]=t(this[r],e[r]);if(e.t<this.t){for(i=e.s&this.DM,r=s;r<this.t;++r)n[r]=t(this[r],i);n.t=this.t}else{for(i=this.s&this.DM,r=s;r<e.t;++r)n[r]=t(i,e[r]);n.t=e.t}n.s=t(this.s,e.s),n.clamp()}function rt(e,t){return e&t}function it(e){var n=t();return this.bitwiseTo(e,rt,n),n}function st(e,t){return e|t}function ot(e){var n=t();return this.bitwiseTo(e,st,n),n}function ut(e,t){return e^t}function at(e){var n=t();return this.bitwiseTo(e,ut,n),n}function ft(e,t){return e&~t}function lt(e){var n=t();return this.bitwiseTo(e,ft,n),n}function ct(){for(var e=t(),n=0;n<this.t;++n)e[n]=this.DM&~this[n];return e.t=this.t,e.s=~this.s,e}function ht(e){var n=t();return 0>e?this.rShiftTo(-e,n):this.lShiftTo(e,n),n}function pt(e){var n=t();return 0>e?this.lShiftTo(-e,n):this.rShiftTo(e,n),n}function dt(e){if(0==e)return-1;var t=0;return 0==(65535&e)&&(e>>=16,t+=16),0==(255&e)&&(e>>=8,t+=8),0==(15&e)&&(e>>=4,t+=4),0==(3&e)&&(e>>=2,t+=2),0==(1&e)&&++t,t}function vt(){for(var e=0;e<this.t;++e)if(0!=this[e])return e*this.DB+dt(this[e]);return this.s<0?this.t*this.DB:-1}function mt(e){for(var t=0;0!=e;)e&=e-1,++t;return t}function gt(){for(var e=0,t=this.s&this.DM,n=0;n<this.t;++n)e+=mt(this[n]^t);return e}function yt(e){var t=Math.floor(e/this.DB);return t>=this.t?0!=this.s:0!=(this[t]&1<<e%this.DB)}function bt(t,n){var r=e.ONE.shiftLeft(t);return this.bitwiseTo(r,n,r),r}function wt(e){return this.changeBit(e,st)}function Et(e){return this.changeBit(e,ft)}function St(e){return this.changeBit(e,ut)}function xt(e,t){for(var n=0,r=0,i=Math.min(e.t,this.t);i>n;)r+=this[n]+e[n],t[n++]=r&this.DM,r>>=this.DB;if(e.t<this.t){for(r+=e.s;n<this.t;)r+=this[n],t[n++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;n<e.t;)r+=e[n],t[n++]=r&this.DM,r>>=this.DB;r+=e.s}t.s=0>r?-1:0,r>0?t[n++]=r:-1>r&&(t[n++]=this.DV+r),t.t=n,t.clamp()}function Tt(e){var n=t();return this.addTo(e,n),n}function Nt(e){var n=t();return this.subTo(e,n),n}function Ct(e){var n=t();return this.multiplyTo(e,n),n}function kt(){var e=t();return this.squareTo(e),e}function Lt(e){var n=t();return this.divRemTo(e,n,null),n}function At(e){var n=t();return this.divRemTo(e,null,n),n}function Ot(e){var n=t(),r=t();return this.divRemTo(e,n,r),new Array(n,r)}function Mt(e){this[this.t]=this.am(0,e-1,this,0,0,this.t),++this.t,this.clamp()}function _t(e,t){if(0!=e){for(;this.t<=t;)this[this.t++]=0;for(this[t]+=e;this[t]>=this.DV;)this[t]-=this.DV,++t>=this.t&&(this[this.t++]=0),++this[t]}}function Dt(){}function Pt(e){return e}function Ht(e,t,n){e.multiplyTo(t,n)}function Bt(e,t){e.squareTo(t)}function jt(e){return this.exp(e,new Dt)}function Ft(e,t,n){var r=Math.min(this.t+e.t,t);for(n.s=0,n.t=r;r>0;)n[--r]=0;var i;for(i=n.t-this.t;i>r;++r)n[r+this.t]=this.am(0,e[r],n,r,0,this.t);for(i=Math.min(e.t,t);i>r;++r)this.am(0,e[r],n,r,0,t-r);n.clamp()}function It(e,t,n){--t;var r=n.t=this.t+e.t-t;for(n.s=0;--r>=0;)n[r]=0;for(r=Math.max(t-this.t,0);r<e.t;++r)n[this.t+r-t]=this.am(t-r,e[r],n,0,0,this.t+r-t);n.clamp(),n.drShiftTo(1,n)}function qt(n){this.r2=t(),this.q3=t(),e.ONE.dlShiftTo(2*n.t,this.r2),this.mu=this.r2.divide(n),this.m=n}function Rt(e){if(e.s<0||e.t>2*this.m.t)return e.mod(this.m);if(e.compareTo(this.m)<0)return e;var n=t();return e.copyTo(n),this.reduce(n),n}function Ut(e){return e}function zt(e){for(e.drShiftTo(this.m.t-1,this.r2),e.t>this.m.t+1&&(e.t=this.m.t+1,e.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);e.compareTo(this.r2)<0;)e.dAddOffset(1,this.m.t+1);for(e.subTo(this.r2,e);e.compareTo(this.m)>=0;)e.subTo(this.m,e)}function Wt(e,t){e.squareTo(t),this.reduce(t)}function Xt(e,t,n){e.multiplyTo(t,n),this.reduce(n)}function Vt(e,n){var r,i,s=e.bitLength(),o=f(1);if(0>=s)return o;r=18>s?1:48>s?3:144>s?4:768>s?5:6,i=8>s?new k(n):n.isEven()?new qt(n):new P(n);var u=new Array,a=3,l=r-1,c=(1<<r)-1;if(u[1]=i.convert(this),r>1){var h=t();for(i.sqrTo(u[1],h);c>=a;)u[a]=t(),i.mulTo(h,u[a-2],u[a]),a+=2}var p,d,v=e.t-1,g=!0,y=t();for(s=m(e[v])-1;v>=0;){for(s>=l?p=e[v]>>s-l&c:(p=(e[v]&(1<<s+1)-1)<<l-s,v>0&&(p|=e[v-1]>>this.DB+s-l)),a=r;0==(1&p);)p>>=1,--a;if((s-=a)<0&&(s+=this.DB,--v),g)u[p].copyTo(o),g=!1;else{for(;a>1;)i.sqrTo(o,y),i.sqrTo(y,o),a-=2;a>0?i.sqrTo(o,y):(d=o,o=y,y=d),i.mulTo(y,u[p],o)}for(;v>=0&&0==(e[v]&1<<s);)i.sqrTo(o,y),d=o,o=y,y=d,--s<0&&(s=this.DB-1,--v)}return i.revert(o)}function $t(e){var t=this.s<0?this.negate():this.clone(),n=e.s<0?e.negate():e.clone();if(t.compareTo(n)<0){var r=t;t=n,n=r}var i=t.getLowestSetBit(),s=n.getLowestSetBit();if(0>s)return t;for(s>i&&(s=i),s>0&&(t.rShiftTo(s,t),n.rShiftTo(s,n));t.signum()>0;)(i=t.getLowestSetBit())>0&&t.rShiftTo(i,t),(i=n.getLowestSetBit())>0&&n.rShiftTo(i,n),t.compareTo(n)>=0?(t.subTo(n,t),t.rShiftTo(1,t)):(n.subTo(t,n),n.rShiftTo(1,n));return s>0&&n.lShiftTo(s,n),n}function Jt(e){if(0>=e)return 0;var t=this.DV%e,n=this.s<0?e-1:0;if(this.t>0)if(0==t)n=this[0]%e;else for(var r=this.t-1;r>=0;--r)n=(t*n+this[r])%e;return n}function Kt(t){var n=t.isEven();if(this.isEven()&&n||0==t.signum())return e.ZERO;for(var r=t.clone(),i=this.clone(),s=f(1),o=f(0),u=f(0),a=f(1);0!=r.signum();){for(;r.isEven();)r.rShiftTo(1,r),n?(s.isEven()&&o.isEven()||(s.addTo(this,s),o.subTo(t,o)),s.rShiftTo(1,s)):o.isEven()||o.subTo(t,o),o.rShiftTo(1,o);for(;i.isEven();)i.rShiftTo(1,i),n?(u.isEven()&&a.isEven()||(u.addTo(this,u),a.subTo(t,a)),u.rShiftTo(1,u)):a.isEven()||a.subTo(t,a),a.rShiftTo(1,a);r.compareTo(i)>=0?(r.subTo(i,r),n&&s.subTo(u,s),o.subTo(a,o)):(i.subTo(r,i),n&&u.subTo(s,u),a.subTo(o,a))}return 0!=i.compareTo(e.ONE)?e.ZERO:a.compareTo(t)>=0?a.subtract(t):a.signum()<0?(a.addTo(t,a),a.signum()<0?a.add(t):a):a}function Qt(e){var t,n=this.abs();if(1==n.t&&n[0]<=mn[mn.length-1]){for(t=0;t<mn.length;++t)if(n[0]==mn[t])return!0;return!1}if(n.isEven())return!1;for(t=1;t<mn.length;){for(var r=mn[t],i=t+1;i<mn.length&&gn>r;)r*=mn[i++];for(r=n.modInt(r);i>t;)if(0==r%mn[t++])return!1}return n.millerRabin(e)}function Gt(n){var r=this.subtract(e.ONE),i=r.getLowestSetBit();if(0>=i)return!1;var s=r.shiftRight(i);n=n+1>>1,n>mn.length&&(n=mn.length);for(var o=t(),u=0;n>u;++u){o.fromInt(mn[Math.floor(Math.random()*mn.length)]);var a=o.modPow(s,this);if(0!=a.compareTo(e.ONE)&&0!=a.compareTo(r)){for(var f=1;f++<i&&0!=a.compareTo(r);)if(a=a.modPowInt(2,this),0==a.compareTo(e.ONE))return!1;if(0!=a.compareTo(r))return!1}}return!0}var Yt=!1,Zt=!1,en=!0,tn=!1,nn={},rn=!1;"undefined"!=typeof module&&module.exports?(module.exports=nn,rn=!0):"undefined"!=typeof document?window.ClipperLib=nn:self.ClipperLib=nn;var sn;if(rn){var on="chrome";sn="Netscape"}else{var on=navigator.userAgent.toString().toLowerCase();sn=navigator.appName}var un={};un.chrome=-1!=on.indexOf("chrome")&&-1==on.indexOf("chromium")?1:0,un.chromium=-1!=on.indexOf("chromium")?1:0,un.safari=-1!=on.indexOf("safari")&&-1==on.indexOf("chrome")&&-1==on.indexOf("chromium")?1:0,un.firefox=-1!=on.indexOf("firefox")?1:0,un.firefox17=-1!=on.indexOf("firefox/17")?1:0,un.firefox15=-1!=on.indexOf("firefox/15")?1:0,un.firefox3=-1!=on.indexOf("firefox/3")?1:0,un.opera=-1!=on.indexOf("opera")?1:0,un.msie10=-1!=on.indexOf("msie 10")?1:0,un.msie9=-1!=on.indexOf("msie 9")?1:0,un.msie8=-1!=on.indexOf("msie 8")?1:0,un.msie7=-1!=on.indexOf("msie 7")?1:0,un.msie=-1!=on.indexOf("msie ")?1:0,nn.biginteger_used=null;var an,fn=0xdeadbeefcafe,ln=15715070==(16777215&fn);ln&&"Microsoft Internet Explorer"==sn?(e.prototype.am=r,an=30):ln&&"Netscape"!=sn?(e.prototype.am=n,an=26):(e.prototype.am=i,an=28),e.prototype.DB=an,e.prototype.DM=(1<<an)-1,e.prototype.DV=1<<an;var cn=52;e.prototype.FV=Math.pow(2,cn),e.prototype.F1=cn-an,e.prototype.F2=2*an-cn;var hn,pn,dn="0123456789abcdefghijklmnopqrstuvwxyz",vn=new Array;for(hn="0".charCodeAt(0),pn=0;9>=pn;++pn)vn[hn++]=pn;for(hn="a".charCodeAt(0),pn=10;36>pn;++pn)vn[hn++]=pn;for(hn="A".charCodeAt(0),pn=10;36>pn;++pn)vn[hn++]=pn;k.prototype.convert=L,k.prototype.revert=A,k.prototype.reduce=O,k.prototype.mulTo=M,k.prototype.sqrTo=_,P.prototype.convert=H,P.prototype.revert=B,P.prototype.reduce=j,P.prototype.mulTo=I,P.prototype.sqrTo=F,e.prototype.copyTo=u,e.prototype.fromInt=a,e.prototype.fromString=l,e.prototype.clamp=c,e.prototype.dlShiftTo=y,e.prototype.drShiftTo=b,e.prototype.lShiftTo=w,e.prototype.rShiftTo=E,e.prototype.subTo=S,e.prototype.multiplyTo=x,e.prototype.squareTo=T,e.prototype.divRemTo=N,e.prototype.invDigit=D,e.prototype.isEven=q,e.prototype.exp=R,e.prototype.toString=h,e.prototype.negate=p,e.prototype.abs=d,e.prototype.compareTo=v,e.prototype.bitLength=g,e.prototype.mod=C,e.prototype.modPowInt=U,e.ZERO=f(0),e.ONE=f(1),Dt.prototype.convert=Pt,Dt.prototype.revert=Pt,Dt.prototype.mulTo=Ht,Dt.prototype.sqrTo=Bt,qt.prototype.convert=Rt,qt.prototype.revert=Ut,qt.prototype.reduce=zt,qt.prototype.mulTo=Xt,qt.prototype.sqrTo=Wt;var mn=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],gn=(1<<26)/mn[mn.length-1];e.prototype.chunkSize=$,e.prototype.toRadix=K,e.prototype.fromRadix=Q,e.prototype.fromNumber=G,e.prototype.bitwiseTo=nt,e.prototype.changeBit=bt,e.prototype.addTo=xt,e.prototype.dMultiply=Mt,e.prototype.dAddOffset=_t,e.prototype.multiplyLowerTo=Ft,e.prototype.multiplyUpperTo=It,e.prototype.modInt=Jt,e.prototype.millerRabin=Gt,e.prototype.clone=z,e.prototype.intValue=W,e.prototype.byteValue=X,e.prototype.shortValue=V,e.prototype.signum=J,e.prototype.toByteArray=Y,e.prototype.equals=Z,e.prototype.min=et,e.prototype.max=tt,e.prototype.and=it,e.prototype.or=ot,e.prototype.xor=at,e.prototype.andNot=lt,e.prototype.not=ct,e.prototype.shiftLeft=ht,e.prototype.shiftRight=pt,e.prototype.getLowestSetBit=vt,e.prototype.bitCount=gt,e.prototype.testBit=yt,e.prototype.setBit=wt,e.prototype.clearBit=Et,e.prototype.flipBit=St,e.prototype.add=Tt,e.prototype.subtract=Nt,e.prototype.multiply=Ct,e.prototype.divide=Lt,e.prototype.remainder=At,e.prototype.divideAndRemainder=Ot,e.prototype.modPow=Vt,e.prototype.modInverse=Kt,e.prototype.pow=jt,e.prototype.gcd=$t,e.prototype.isProbablePrime=Qt,e.prototype.square=kt;var yn=e;if(yn.prototype.IsNegative=function(){return-1==this.compareTo(yn.ZERO)?!0:!1},yn.op_Equality=function(e,t){return 0==e.compareTo(t)?!0:!1},yn.op_Inequality=function(e,t){return 0!=e.compareTo(t)?!0:!1},yn.op_GreaterThan=function(e,t){return e.compareTo(t)>0?!0:!1},yn.op_LessThan=function(e,t){return e.compareTo(t)<0?!0:!1},yn.op_Addition=function(e,t){return(new yn(e)).add(new yn(t))},yn.op_Subtraction=function(e,t){return(new yn(e)).subtract(new yn(t))},yn.Int128Mul=function(e,t){return(new yn(e)).multiply(new yn(t))},yn.op_Division=function(e,t){return e.divide(t)},yn.prototype.ToDouble=function(){return parseFloat(this.toString())},"undefined"==typeof bn)var bn=function(e,t){var n;if("undefined"==typeof Object.getOwnPropertyNames){for(n in t.prototype)("undefined"==typeof e.prototype[n]||e.prototype[n]==Object.prototype[n])&&(e.prototype[n]=t.prototype[n]);for(n in t)"undefined"==typeof e[n]&&(e[n]=t[n]);e.$baseCtor=t}else{for(var r=Object.getOwnPropertyNames(t.prototype),i=0;i<r.length;i++)"undefined"==typeof Object.getOwnPropertyDescriptor(e.prototype,r[i])&&Object.defineProperty(e.prototype,r[i],Object.getOwnPropertyDescriptor(t.prototype,r[i]));for(n in t)"undefined"==typeof e[n]&&(e[n]=t[n]);e.$baseCtor=t}};nn.Path=function(){return[]},nn.Paths=function(){return[]},nn.DoublePoint=function(){var e=arguments;this.X=0,this.Y=0,1==e.length?(this.X=e[0].X,this.Y=e[0].Y):2==e.length&&(this.X=e[0],this.Y=e[1])},nn.DoublePoint0=function(){this.X=0,this.Y=0},nn.DoublePoint1=function(e){this.X=e.X,this.Y=e.Y},nn.DoublePoint2=function(e,t){this.X=e,this.Y=t},nn.PolyNode=function(){this.m_Parent=null,this.m_polygon=new nn.Path,this.m_Index=0,this.m_jointype=0,this.m_endtype=0,this.m_Childs=[],this.IsOpen=!1},nn.PolyNode.prototype.IsHoleNode=function(){for(var e=!0,t=this.m_Parent;null!==t;)e=!e,t=t.m_Parent;return e},nn.PolyNode.prototype.ChildCount=function(){return this.m_Childs.length},nn.PolyNode.prototype.Contour=function(){return this.m_polygon},nn.PolyNode.prototype.AddChild=function(e){var t=this.m_Childs.length;this.m_Childs.push(e),e.m_Parent=this,e.m_Index=t},nn.PolyNode.prototype.GetNext=function(){return this.m_Childs.length>0?this.m_Childs[0]:this.GetNextSiblingUp()},nn.PolyNode.prototype.GetNextSiblingUp=function(){return null===this.m_Parent?null:this.m_Index==this.m_Parent.m_Childs.length-1?this.m_Parent.GetNextSiblingUp():this.m_Parent.m_Childs[this.m_Index+1]},nn.PolyNode.prototype.Childs=function(){return this.m_Childs},nn.PolyNode.prototype.Parent=function(){return this.m_Parent},nn.PolyNode.prototype.IsHole=function(){return this.IsHoleNode()},nn.PolyTree=function(){this.m_AllPolys=[],nn.PolyNode.call(this)},nn.PolyTree.prototype.Clear=function(){for(var e=0,t=this.m_AllPolys.length;t>e;e++)this.m_AllPolys[e]=null;this.m_AllPolys.length=0,this.m_Childs.length=0},nn.PolyTree.prototype.GetFirst=function(){return this.m_Childs.length>0?this.m_Childs[0]:null},nn.PolyTree.prototype.Total=function(){return this.m_AllPolys.length},bn(nn.PolyTree,nn.PolyNode),nn.Math_Abs_Int64=nn.Math_Abs_Int32=nn.Math_Abs_Double=function(e){return Math.abs(e)},nn.Math_Max_Int32_Int32=function(e,t){return Math.max(e,t)},nn.Cast_Int32=un.msie||un.opera||un.safari?function(e){return 0|e}:function(e){return~~e},nn.Cast_Int64=un.chrome?function(e){return-2147483648>e||e>2147483647?0>e?Math.ceil(e):Math.floor(e):~~e}:un.firefox&&"function"==typeof Number.toInteger?function(e){return Number.toInteger(e)}:un.msie7||un.msie8?function(e){return parseInt(e,10)}:un.msie?function(e){return-2147483648>e||e>2147483647?0>e?Math.ceil(e):Math.floor(e):0|e}:function(e){return 0>e?Math.ceil(e):Math.floor(e)},nn.Clear=function(e){e.length=0},nn.PI=3.141592653589793,nn.PI2=6.283185307179586,nn.IntPoint=function(){var e=arguments,t=e.length;if(this.X=0,this.Y=0,Zt)if(this.Z=0,3==t)this.X=e[0],this.Y=e[1],this.Z=e[2];else if(2==t)this.X=e[0],this.Y=e[1],this.Z=0;else if(1==t)if(e[0]instanceof nn.DoublePoint){var n=e[0];this.X=nn.Clipper.Round(n.X),this.Y=nn.Clipper.Round(n.Y),this.Z=0}else{var r=e[0];"undefined"==typeof r.Z&&(r.Z=0),this.X=r.X,this.Y=r.Y,this.Z=r.Z}else this.X=0,this.Y=0,this.Z=0;else if(2==t)this.X=e[0],this.Y=e[1];else if(1==t)if(e[0]instanceof nn.DoublePoint){var n=e[0];this.X=nn.Clipper.Round(n.X),this.Y=nn.Clipper.Round(n.Y)}else{var r=e[0];this.X=r.X,this.Y=r.Y}else this.X=0,this.Y=0},nn.IntPoint.op_Equality=function(e,t){return e.X==t.X&&e.Y==t.Y},nn.IntPoint.op_Inequality=function(e,t){return e.X!=t.X||e.Y!=t.Y},Zt?(nn.IntPoint0=function(){this.X=0,this.Y=0,this.Z=0},nn.IntPoint1=function(e){this.X=e.X,this.Y=e.Y,this.Z=e.Z},nn.IntPoint1dp=function(e){this.X=nn.Clipper.Round(e.X),this.Y=nn.Clipper.Round(e.Y),this.Z=0},nn.IntPoint2=function(e,t){this.X=e,this.Y=t,this.Z=0},nn.IntPoint3=function(e,t,n){this.X=e,this.Y=t,this.Z=n}):(nn.IntPoint0=function(){this.X=0,this.Y=0},nn.IntPoint1=function(e){this.X=e.X,this.Y=e.Y},nn.IntPoint1dp=function(e){this.X=nn.Clipper.Round(e.X),this.Y=nn.Clipper.Round(e.Y)},nn.IntPoint2=function(e,t){this.X=e,this.Y=t}),nn.IntRect=function(){var e=arguments,t=e.length;4==t?(this.left=e[0],this.top=e[1],this.right=e[2],this.bottom=e[3]):1==t?(this.left=ir.left,this.top=ir.top,this.right=ir.right,this.bottom=ir.bottom):(this.left=0,this.top=0,this.right=0,this.bottom=0)},nn.IntRect0=function(){this.left=0,this.top=0,this.right=0,this.bottom=0},nn.IntRect1=function(e){this.left=e.left,this.top=e.top,this.right=e.right,this.bottom=e.bottom},nn.IntRect4=function(e,t,n,r){this.left=e,this.top=t,this.right=n,this.bottom=r},nn.ClipType={ctIntersection:0,ctUnion:1,ctDifference:2,ctXor:3},nn.PolyType={ptSubject:0,ptClip:1},nn.PolyFillType={pftEvenOdd:0,pftNonZero:1,pftPositive:2,pftNegative:3},nn.JoinType={jtSquare:0,jtRound:1,jtMiter:2},nn.EndType={etOpenSquare:0,etOpenRound:1,etOpenButt:2,etClosedLine:3,etClosedPolygon:4},tn&&(nn.EndType_={etSquare:0,etRound:1,etButt:2,etClosed:3}),nn.EdgeSide={esLeft:0,esRight:1},nn.Direction={dRightToLeft:0,dLeftToRight:1},nn.TEdge=function(){this.Bot=new nn.IntPoint,this.Curr=new nn.IntPoint,this.Top=new nn.IntPoint,this.Delta=new nn.IntPoint,this.Dx=0,this.PolyTyp=nn.PolyType.ptSubject,this.Side=nn.EdgeSide.esLeft,this.WindDelta=0,this.WindCnt=0,this.WindCnt2=0,this.OutIdx=0,this.Next=null,this.Prev=null,this.NextInLML=null,this.NextInAEL=null,this.PrevInAEL=null,this.NextInSEL=null,this.PrevInSEL=null},nn.IntersectNode=function(){this.Edge1=null,this.Edge2=null,this.Pt=new nn.IntPoint},nn.MyIntersectNodeSort=function(){},nn.MyIntersectNodeSort.Compare=function(e,t){return t.Pt.Y-e.Pt.Y},nn.LocalMinima=function(){this.Y=0,this.LeftBound=null,this.RightBound=null,this.Next=null},nn.Scanbeam=function(){this.Y=0,this.Next=null},nn.OutRec=function(){this.Idx=0,this.IsHole=!1,this.IsOpen=!1,this.FirstLeft=null,this.Pts=null,this.BottomPt=null,this.PolyNode=null},nn.OutPt=function(){this.Idx=0,this.Pt=new nn.IntPoint,this.Next=null,this.Prev=null},nn.Join=function(){this.OutPt1=null,this.OutPt2=null,this.OffPt=new nn.IntPoint},nn.ClipperBase=function(){this.m_MinimaList=null,this.m_CurrentLM=null,this.m_edges=new Array,this.m_UseFullRange=!1,this.m_HasOpenPaths=!1,this.PreserveCollinear=!1,this.m_MinimaList=null,this.m_CurrentLM=null,this.m_UseFullRange=!1,this.m_HasOpenPaths=!1},nn.ClipperBase.horizontal=-9007199254740992,nn.ClipperBase.Skip=-2,nn.ClipperBase.Unassigned=-1,nn.ClipperBase.tolerance=1e-20,Yt?(nn.ClipperBase.loRange=46340,nn.ClipperBase.hiRange=46340):(nn.ClipperBase.loRange=47453132,nn.ClipperBase.hiRange=0xfffffffffffff),nn.ClipperBase.near_zero=function(e){return e>-nn.ClipperBase.tolerance&&e<nn.ClipperBase.tolerance},nn.ClipperBase.IsHorizontal=function(e){return 0===e.Delta.Y},nn.ClipperBase.prototype.PointIsVertex=function(e,t){var n=t;do{if(nn.IntPoint.op_Equality(n.Pt,e))return!0;n=n.Next}while(n!=t);return!1},nn.ClipperBase.prototype.PointOnLineSegment=function(e,t,n,r){return r?e.X==t.X&&e.Y==t.Y||e.X==n.X&&e.Y==n.Y||e.X>t.X==e.X<n.X&&e.Y>t.Y==e.Y<n.Y&&yn.op_Equality(yn.Int128Mul(e.X-t.X,n.Y-t.Y),yn.Int128Mul(n.X-t.X,e.Y-t.Y)):e.X==t.X&&e.Y==t.Y||e.X==n.X&&e.Y==n.Y||e.X>t.X==e.X<n.X&&e.Y>t.Y==e.Y<n.Y&&(e.X-t.X)*(n.Y-t.Y)==(n.X-t.X)*(e.Y-t.Y)},nn.ClipperBase.prototype.PointOnPolygon=function(e,t,n){for(var r=t;;){if(this.PointOnLineSegment(e,r.Pt,r.Next.Pt,n))return!0;if(r=r.Next,r==t)break}return!1},nn.ClipperBase.prototype.SlopesEqual=nn.ClipperBase.SlopesEqual=function(){var e,t,n,r,i,s,o,u=arguments,a=u.length;return 3==a?(e=u[0],t=u[1],o=u[2],o?yn.op_Equality(yn.Int128Mul(e.Delta.Y,t.Delta.X),yn.Int128Mul(e.Delta.X,t.Delta.Y)):nn.Cast_Int64(e.Delta.Y*t.Delta.X)==nn.Cast_Int64(e.Delta.X*t.Delta.Y)):4==a?(n=u[0],r=u[1],i=u[2],o=u[3],o?yn.op_Equality(yn.Int128Mul(n.Y-r.Y,r.X-i.X),yn.Int128Mul(n.X-r.X,r.Y-i.Y)):0===nn.Cast_Int64((n.Y-r.Y)*(r.X-i.X))-nn.Cast_Int64((n.X-r.X)*(r.Y-i.Y))):(n=u[0],r=u[1],i=u[2],s=u[3],o=u[4],o?yn.op_Equality(yn.Int128Mul(n.Y-r.Y,i.X-s.X),yn.Int128Mul(n.X-r.X,i.Y-s.Y)):0===nn.Cast_Int64((n.Y-r.Y)*(i.X-s.X))-nn.Cast_Int64((n.X-r.X)*(i.Y-s.Y)))},nn.ClipperBase.SlopesEqual3=function(e,t,n){return n?yn.op_Equality(yn.Int128Mul(e.Delta.Y,t.Delta.X),yn.Int128Mul(e.Delta.X,t.Delta.Y)):nn.Cast_Int64(e.Delta.Y*t.Delta.X)==nn.Cast_Int64(e.Delta.X*t.Delta.Y)},nn.ClipperBase.SlopesEqual4=function(e,t,n,r){return r?yn.op_Equality(yn.Int128Mul(e.Y-t.Y,t.X-n.X),yn.Int128Mul(e.X-t.X,t.Y-n.Y)):0===nn.Cast_Int64((e.Y-t.Y)*(t.X-n.X))-nn.Cast_Int64((e.X-t.X)*(t.Y-n.Y))},nn.ClipperBase.SlopesEqual5=function(e,t,n,r,i){return i?yn.op_Equality(yn.Int128Mul(e.Y-t.Y,n.X-r.X),yn.Int128Mul(e.X-t.X,n.Y-r.Y)):0===nn.Cast_Int64((e.Y-t.Y)*(n.X-r.X))-nn.Cast_Int64((e.X-t.X)*(n.Y-r.Y))},nn.ClipperBase.prototype.Clear=function(){this.DisposeLocalMinimaList();for(var e=0,t=this.m_edges.length;t>e;++e){for(var n=0,r=this.m_edges[e].length;r>n;++n)this.m_edges[e][n]=null;nn.Clear(this.m_edges[e])}nn.Clear(this.m_edges),this.m_UseFullRange=!1,this.m_HasOpenPaths=!1},nn.ClipperBase.prototype.DisposeLocalMinimaList=function(){for(;null!==this.m_MinimaList;){var e=this.m_MinimaList.Next;this.m_MinimaList=null,this.m_MinimaList=e}this.m_CurrentLM=null},nn.ClipperBase.prototype.RangeTest=function(e,t){t.Value?(e.X>nn.ClipperBase.hiRange||e.Y>nn.ClipperBase.hiRange||-e.X>nn.ClipperBase.hiRange||-e.Y>nn.ClipperBase.hiRange)&&nn.Error("Coordinate outside allowed range in RangeTest()."):(e.X>nn.ClipperBase.loRange||e.Y>nn.ClipperBase.loRange||-e.X>nn.ClipperBase.loRange||-e.Y>nn.ClipperBase.loRange)&&(t.Value=!0,this.RangeTest(e,t))},nn.ClipperBase.prototype.InitEdge=function(e,t,n,r){e.Next=t,e.Prev=n,e.Curr.X=r.X,e.Curr.Y=r.Y,e.OutIdx=-1},nn.ClipperBase.prototype.InitEdge2=function(e,t){e.Curr.Y>=e.Next.Curr.Y?(e.Bot.X=e.Curr.X,e.Bot.Y=e.Curr.Y,e.Top.X=e.Next.Curr.X,e.Top.Y=e.Next.Curr.Y):(e.Top.X=e.Curr.X,e.Top.Y=e.Curr.Y,e.Bot.X=e.Next.Curr.X,e.Bot.Y=e.Next.Curr.Y),this.SetDx(e),e.PolyTyp=t},nn.ClipperBase.prototype.FindNextLocMin=function(e){for(var t;;){for(;nn.IntPoint.op_Inequality(e.Bot,e.Prev.Bot)||nn.IntPoint.op_Equality(e.Curr,e.Top);)e=e.Next;if(e.Dx!=nn.ClipperBase.horizontal&&e.Prev.Dx!=nn.ClipperBase.horizontal)break;for(;e.Prev.Dx==nn.ClipperBase.horizontal;)e=e.Prev;for(t=e;e.Dx==nn.ClipperBase.horizontal;)e=e.Next;if(e.Top.Y!=e.Prev.Bot.Y){t.Prev.Bot.X<e.Bot.X&&(e=t);break}}return e},nn.ClipperBase.prototype.ProcessBound=function(e,t){var n,r,i=e,s=e;if(e.Dx==nn.ClipperBase.horizontal&&(r=t?e.Prev.Bot.X:e.Next.Bot.X,e.Bot.X!=r&&this.ReverseHorizontal(e)),s.OutIdx!=nn.ClipperBase.Skip)if(t){for(;s.Top.Y==s.Next.Bot.Y&&s.Next.OutIdx!=nn.ClipperBase.Skip;)s=s.Next;if(s.Dx==nn.ClipperBase.horizontal&&s.Next.OutIdx!=nn.ClipperBase.Skip){for(n=s;n.Prev.Dx==nn.ClipperBase.horizontal;)n=n.Prev;n.Prev.Top.X==s.Next.Top.X?t||(s=n.Prev):n.Prev.Top.X>s.Next.Top.X&&(s=n.Prev)}for(;e!=s;)e.NextInLML=e.Next,e.Dx==nn.ClipperBase.horizontal&&e!=i&&e.Bot.X!=e.Prev.Top.X&&this.ReverseHorizontal(e),e=e.Next;e.Dx==nn.ClipperBase.horizontal&&e!=i&&e.Bot.X!=e.Prev.Top.X&&this.ReverseHorizontal(e),s=s.Next}else{for(;s.Top.Y==s.Prev.Bot.Y&&s.Prev.OutIdx!=nn.ClipperBase.Skip;)s=s.Prev;if(s.Dx==nn.ClipperBase.horizontal&&s.Prev.OutIdx!=nn.ClipperBase.Skip){for(n=s;n.Next.Dx==nn.ClipperBase.horizontal;)n=n.Next;n.Next.Top.X==s.Prev.Top.X?t||(s=n.Next):n.Next.Top.X>s.Prev.Top.X&&(s=n.Next)}for(;e!=s;)e.NextInLML=e.Prev,e.Dx==nn.ClipperBase.horizontal&&e!=i&&e.Bot.X!=e.Next.Top.X&&this.ReverseHorizontal(e),e=e.Prev;e.Dx==nn.ClipperBase.horizontal&&e!=i&&e.Bot.X!=e.Next.Top.X&&this.ReverseHorizontal(e),s=s.Prev}if(s.OutIdx==nn.ClipperBase.Skip){if(e=s,t){for(;e.Top.Y==e.Next.Bot.Y;)e=e.Next;for(;e!=s&&e.Dx==nn.ClipperBase.horizontal;)e=e.Prev}else{for(;e.Top.Y==e.Prev.Bot.Y;)e=e.Prev;for(;e!=s&&e.Dx==nn.ClipperBase.horizontal;)e=e.Next}if(e==s)s=t?e.Next:e.Prev;else{e=t?s.Next:s.Prev;var o=new nn.LocalMinima;o.Next=null,o.Y=e.Bot.Y,o.LeftBound=null,o.RightBound=e,o.RightBound.WindDelta=0,s=this.ProcessBound(o.RightBound,t),this.InsertLocalMinima(o)}}return s},nn.ClipperBase.prototype.AddPath=function(e,t,n){en?n||t!=nn.PolyType.ptClip||nn.Error("AddPath: Open paths must be subject."):n||nn.Error("AddPath: Open paths have been disabled.");var r=e.length-1;if(n)for(;r>0&&nn.IntPoint.op_Equality(e[r],e[0]);)--r;for(;r>0&&nn.IntPoint.op_Equality(e[r],e[r-1]);)--r;if(n&&2>r||!n&&1>r)return!1;for(var i=new Array,s=0;r>=s;s++)i.push(new nn.TEdge);var o=!0;i[1].Curr.X=e[1].X,i[1].Curr.Y=e[1].Y;var u={Value:this.m_UseFullRange};this.RangeTest(e[0],u),this.m_UseFullRange=u.Value,u.Value=this.m_UseFullRange,this.RangeTest(e[r],u),this.m_UseFullRange=u.Value,this.InitEdge(i[0],i[1],i[r],e[0]),this.InitEdge(i[r],i[0],i[r-1],e[r]);for(var s=r-1;s>=1;--s)u.Value=this.m_UseFullRange,this.RangeTest(e[s],u),this.m_UseFullRange=u.Value,this.InitEdge(i[s],i[s+1],i[s-1],e[s]);for(var a=i[0],f=a,l=a;;)if(nn.IntPoint.op_Equality(f.Curr,f.Next.Curr)){if(f==f.Next)break;f==a&&(a=f.Next),f=this.RemoveEdge(f),l=f}else{if(f.Prev==f.Next)break;if(!n||!nn.ClipperBase.SlopesEqual(f.Prev.Curr,f.Curr,f.Next.Curr,this.m_UseFullRange)||this.PreserveCollinear&&this.Pt2IsBetweenPt1AndPt3(f.Prev.Curr,f.Curr,f.Next.Curr)){if(f=f.Next,f==l)break}else f==a&&(a=f.Next),f=this.RemoveEdge(f),f=f.Prev,l=f}if(!n&&f==f.Next||n&&f.Prev==f.Next)return!1;n||(this.m_HasOpenPaths=!0,a.Prev.OutIdx=nn.ClipperBase.Skip),f=a;do this.InitEdge2(f,t),f=f.Next,o&&f.Curr.Y!=a.Curr.Y&&(o=!1);while(f!=a);if(o){if(n)return!1;f.Prev.OutIdx=nn.ClipperBase.Skip,f.Prev.Bot.X<f.Prev.Top.X&&this.ReverseHorizontal(f.Prev);var c=new nn.LocalMinima;for(c.Next=null,c.Y=f.Bot.Y,c.LeftBound=null,c.RightBound=f,c.RightBound.Side=nn.EdgeSide.esRight,c.RightBound.WindDelta=0;f.Next.OutIdx!=nn.ClipperBase.Skip;)f.NextInLML=f.Next,f.Bot.X!=f.Prev.Top.X&&this.ReverseHorizontal(f),f=f.Next;return this.InsertLocalMinima(c),this.m_edges.push(i),!0}this.m_edges.push(i);for(var h,p=null;f=this.FindNextLocMin(f),f!=p;){null==p&&(p=f);var c=new nn.LocalMinima;c.Next=null,c.Y=f.Bot.Y,f.Dx<f.Prev.Dx?(c.LeftBound=f.Prev,c.RightBound=f,h=!1):(c.LeftBound=f,c.RightBound=f.Prev,h=!0),c.LeftBound.Side=nn.EdgeSide.esLeft,c.RightBound.Side=nn.EdgeSide.esRight,c.LeftBound.WindDelta=n?c.LeftBound.Next==c.RightBound?-1:1:0,c.RightBound.WindDelta=-c.LeftBound.WindDelta,f=this.ProcessBound(c.LeftBound,h);var d=this.ProcessBound(c.RightBound,!h);c.LeftBound.OutIdx==nn.ClipperBase.Skip?c.LeftBound=null:c.RightBound.OutIdx==nn.ClipperBase.Skip&&(c.RightBound=null),this.InsertLocalMinima(c),h||(f=d)}return!0},nn.ClipperBase.prototype.AddPaths=function(e,t,n){for(var r=!1,i=0,s=e.length;s>i;++i)this.AddPath(e[i],t,n)&&(r=!0);return r},nn.ClipperBase.prototype.Pt2IsBetweenPt1AndPt3=function(e,t,n){return nn.IntPoint.op_Equality(e,n)||nn.IntPoint.op_Equality(e,t)||nn.IntPoint.op_Equality(n,t)?!1:e.X!=n.X?t.X>e.X==t.X<n.X:t.Y>e.Y==t.Y<n.Y},nn.ClipperBase.prototype.RemoveEdge=function(e){e.Prev.Next=e.Next,e.Next.Prev=e.Prev;var t=e.Next;return e.Prev=null,t},nn.ClipperBase.prototype.SetDx=function(e){e.Delta.X=e.Top.X-e.Bot.X,e.Delta.Y=e.Top.Y-e.Bot.Y,e.Dx=0===e.Delta.Y?nn.ClipperBase.horizontal:e.Delta.X/e.Delta.Y},nn.ClipperBase.prototype.InsertLocalMinima=function(e){if(null===this.m_MinimaList)this.m_MinimaList=e;else if(e.Y>=this.m_MinimaList.Y)e.Next=this.m_MinimaList,this.m_MinimaList=e;else{for(var t=this.m_MinimaList;null!==t.Next&&e.Y<t.Next.Y;)t=t.Next;e.Next=t.Next,t.Next=e}},nn.ClipperBase.prototype.PopLocalMinima=function(){null!==this.m_CurrentLM&&(this.m_CurrentLM=this.m_CurrentLM.Next)},nn.ClipperBase.prototype.ReverseHorizontal=function(e){var t=e.Top.X;e.Top.X=e.Bot.X,e.Bot.X=t,Zt&&(t=e.Top.Z,e.Top.Z=e.Bot.Z,e.Bot.Z=t)},nn.ClipperBase.prototype.Reset=function(){if(this.m_CurrentLM=this.m_MinimaList,null!=this.m_CurrentLM)for(var e=this.m_MinimaList;null!=e;){var t=e.LeftBound;null!=t&&(t.Curr.X=t.Bot.X,t.Curr.Y=t.Bot.Y,t.Side=nn.EdgeSide.esLeft,t.OutIdx=nn.ClipperBase.Unassigned),t=e.RightBound,null!=t&&(t.Curr.X=t.Bot.X,t.Curr.Y=t.Bot.Y,t.Side=nn.EdgeSide.esRight,t.OutIdx=nn.ClipperBase.Unassigned),e=e.Next}},nn.Clipper=function(e){"undefined"==typeof e&&(e=0),this.m_PolyOuts=null,this.m_ClipType=nn.ClipType.ctIntersection,this.m_Scanbeam=null,this.m_ActiveEdges=null,this.m_SortedEdges=null,this.m_IntersectList=null,this.m_IntersectNodeComparer=null,this.m_ExecuteLocked=!1,this.m_ClipFillType=nn.PolyFillType.pftEvenOdd,this.m_SubjFillType=nn.PolyFillType.pftEvenOdd,this.m_Joins=null,this.m_GhostJoins=null,this.m_UsingPolyTree=!1,this.ReverseSolution=!1,this.StrictlySimple=!1,nn.ClipperBase.call(this),this.m_Scanbeam=null,this.m_ActiveEdges=null,this.m_SortedEdges=null,this.m_IntersectList=new Array,this.m_IntersectNodeComparer=nn.MyIntersectNodeSort.Compare,this.m_ExecuteLocked=!1,this.m_UsingPolyTree=!1,this.m_PolyOuts=new Array,this.m_Joins=new Array,this.m_GhostJoins=new Array,this.ReverseSolution=0!==(1&e),this.StrictlySimple=0!==(2&e),this.PreserveCollinear=0!==(4&e),Zt&&(this.ZFillFunction=null)},nn.Clipper.ioReverseSolution=1,nn.Clipper.ioStrictlySimple=2,nn.Clipper.ioPreserveCollinear=4,nn.Clipper.prototype.Clear=function(){0!==this.m_edges.length&&(this.DisposeAllPolyPts(),nn.ClipperBase.prototype.Clear.call(this))},nn.Clipper.prototype.DisposeScanbeamList=function(){for(;null!==this.m_Scanbeam;){var e=this.m_Scanbeam.Next;this.m_Scanbeam=null,this.m_Scanbeam=e}},nn.Clipper.prototype.Reset=function(){nn.ClipperBase.prototype.Reset.call(this),this.m_Scanbeam=null,this.m_ActiveEdges=null,this.m_SortedEdges=null;for(var e=this.m_MinimaList;null!==e;)this.InsertScanbeam(e.Y),e=e.Next},nn.Clipper.prototype.InsertScanbeam=function(e){if(null===this.m_Scanbeam)this.m_Scanbeam=new nn.Scanbeam,this.m_Scanbeam.Next=null,this.m_Scanbeam.Y=e;else if(e>this.m_Scanbeam.Y){var t=new nn.Scanbeam;t.Y=e,t.Next=this.m_Scanbeam,this.m_Scanbeam=t}else{for(var n=this.m_Scanbeam;null!==n.Next&&e<=n.Next.Y;)n=n.Next;if(e==n.Y)return;var t=new nn.Scanbeam;t.Y=e,t.Next=n.Next,n.Next=t}},nn.Clipper.prototype.Execute=function(){var e=arguments,t=e.length,n=e[1]instanceof nn.PolyTree;if(4==t&&!n){var r=e[0],i=e[1],s=e[2],o=e[3];if(this.m_ExecuteLocked)return!1;this.m_HasOpenPaths&&nn.Error("Error: PolyTree struct is need for open path clipping."),this.m_ExecuteLocked=!0,nn.Clear(i),this.m_SubjFillType=s,this.m_ClipFillType=o,this.m_ClipType=r,this.m_UsingPolyTree=!1;try{var u=this.ExecuteInternal();u&&this.BuildResult(i)}finally{this.DisposeAllPolyPts(),this.m_ExecuteLocked=!1}return u}if(4==t&&n){var r=e[0],a=e[1],s=e[2],o=e[3];if(this.m_ExecuteLocked)return!1;this.m_ExecuteLocked=!0,this.m_SubjFillType=s,this.m_ClipFillType=o,this.m_ClipType=r,this.m_UsingPolyTree=!0;try{var u=this.ExecuteInternal();u&&this.BuildResult2(a)}finally{this.DisposeAllPolyPts(),this.m_ExecuteLocked=!1}return u}if(2==t&&!n){var r=e[0],i=e[1];return this.Execute(r,i,nn.PolyFillType.pftEvenOdd,nn.PolyFillType.pftEvenOdd)}if(2==t&&n){var r=e[0],a=e[1];return this.Execute(r,a,nn.PolyFillType.pftEvenOdd,nn.PolyFillType.pftEvenOdd)}},nn.Clipper.prototype.FixHoleLinkage=function(e){if(null!==e.FirstLeft&&(e.IsHole==e.FirstLeft.IsHole||null===e.FirstLeft.Pts)){for(var t=e.FirstLeft;null!==t&&(t.IsHole==e.IsHole||null===t.Pts);)t=t.FirstLeft;e.FirstLeft=t}},nn.Clipper.prototype.ExecuteInternal=function(){try{if(this.Reset(),null===this.m_CurrentLM)return!1;var e=this.PopScanbeam();do{if(this.InsertLocalMinimaIntoAEL(e),nn.Clear(this.m_GhostJoins),this.ProcessHorizontals(!1),null===this.m_Scanbeam)break;var t=this.PopScanbeam();if(!this.ProcessIntersections(e,t))return!1;this.ProcessEdgesAtTopOfScanbeam(t),e=t}while(null!==this.m_Scanbeam||null!==this.m_CurrentLM);for(var n=0,r=this.m_PolyOuts.length;r>n;n++){var i=this.m_PolyOuts[n];null===i.Pts||i.IsOpen||(i.IsHole^this.ReverseSolution)==this.Area(i)>0&&this.ReversePolyPtLinks(i.Pts)}this.JoinCommonEdges();for(var n=0,r=this.m_PolyOuts.length;r>n;n++){var i=this.m_PolyOuts[n];null===i.Pts||i.IsOpen||this.FixupOutPolygon(i)}return this.StrictlySimple&&this.DoSimplePolygons(),!0}finally{nn.Clear(this.m_Joins),nn.Clear(this.m_GhostJoins)}},nn.Clipper.prototype.PopScanbeam=function(){var e=this.m_Scanbeam.Y,t=this.m_Scanbeam;return this.m_Scanbeam=this.m_Scanbeam.Next,t=null,e},nn.Clipper.prototype.DisposeAllPolyPts=function(){for(var e=0,t=this.m_PolyOuts.length;t>e;++e)this.DisposeOutRec(e);nn.Clear(this.m_PolyOuts)},nn.Clipper.prototype.DisposeOutRec=function(e){var t=this.m_PolyOuts[e];null!==t.Pts&&this.DisposeOutPts(t.Pts),t=null,this.m_PolyOuts[e]=null},nn.Clipper.prototype.DisposeOutPts=function(e){if(null!==e){var t=null;for(e.Prev.Next=null;null!==e;)t=e,e=e.Next,t=null}},nn.Clipper.prototype.AddJoin=function(e,t,n){var r=new nn.Join;r.OutPt1=e,r.OutPt2=t,r.OffPt.X=n.X,r.OffPt.Y=n.Y,this.m_Joins.push(r)},nn.Clipper.prototype.AddGhostJoin=function(e,t){var n=new nn.Join;n.OutPt1=e,n.OffPt.X=t.X,n.OffPt.Y=t.Y,this.m_GhostJoins.push(n)},Zt&&(nn.Clipper.prototype.SetZ=function(e,t){e.Z=0,null!==this.ZFillFunction&&(t.OutIdx<0?this.ZFillFunction(t.Bot,t.Top,e):this.ZFillFunction(t.Top,t.Bot,e))}),nn.Clipper.prototype.InsertLocalMinimaIntoAEL=function(e){for(;null!==this.m_CurrentLM&&this.m_CurrentLM.Y==e;){var t=this.m_CurrentLM.LeftBound,n=this.m_CurrentLM.RightBound;this.PopLocalMinima();var r=null;if(null===t?(this.InsertEdgeIntoAEL(n,null),this.SetWindingCount(n),this.IsContributing(n)&&(r=this.AddOutPt(n,n.Bot))):null==n?(this.InsertEdgeIntoAEL(t,null),this.SetWindingCount(t),this.IsContributing(t)&&(r=this.AddOutPt(t,t.Bot)),this.InsertScanbeam(t.Top.Y)):(this.InsertEdgeIntoAEL(t,null),this.InsertEdgeIntoAEL(n,t),this.SetWindingCount(t),n.WindCnt=t.WindCnt,n.WindCnt2=t.WindCnt2,this.IsContributing(t)&&(r=this.AddLocalMinPoly(t,n,t.Bot)),this.InsertScanbeam(t.Top.Y)),null!=n&&(nn.ClipperBase.IsHorizontal(n)?this.AddEdgeToSEL(n):this.InsertScanbeam(n.Top.Y)),null!=t&&null!=n){if(null!==r&&nn.ClipperBase.IsHorizontal(n)&&this.m_GhostJoins.length>0&&0!==n.WindDelta)for(var i=0,s=this.m_GhostJoins.length;s>i;i++){var o=this.m_GhostJoins[i];this.HorzSegmentsOverlap(o.OutPt1.Pt,o.OffPt,n.Bot,n.Top)&&this.AddJoin(o.OutPt1,r,o.OffPt)}if(t.OutIdx>=0&&null!==t.PrevInAEL&&t.PrevInAEL.Curr.X==t.Bot.X&&t.PrevInAEL.OutIdx>=0&&nn.ClipperBase.SlopesEqual(t.PrevInAEL,t,this.m_UseFullRange)&&0!==t.WindDelta&&0!==t.PrevInAEL.WindDelta){var u=this.AddOutPt(t.PrevInAEL,t.Bot);this.AddJoin(r,u,t.Top)}if(t.NextInAEL!=n){if(n.OutIdx>=0&&n.PrevInAEL.OutIdx>=0&&nn.ClipperBase.SlopesEqual(n.PrevInAEL,n,this.m_UseFullRange)&&0!==n.WindDelta&&0!==n.PrevInAEL.WindDelta){var u=this.AddOutPt(n.PrevInAEL,n.Bot);this.AddJoin(r,u,n.Top)}var a=t.NextInAEL;if(null!==a)for(;a!=n;)this.IntersectEdges(n,a,t.Curr,!1),a=a.NextInAEL}}}},nn.Clipper.prototype.InsertEdgeIntoAEL=function(e,t){if(null===this.m_ActiveEdges)e.PrevInAEL=null,e.NextInAEL=null,this.m_ActiveEdges=e;else if(null===t&&this.E2InsertsBeforeE1(this.m_ActiveEdges,e))e.PrevInAEL=null,e.NextInAEL=this.m_ActiveEdges,this.m_ActiveEdges.PrevInAEL=e,this.m_ActiveEdges=e;else{for(null===t&&(t=this.m_ActiveEdges);null!==t.NextInAEL&&!this.E2InsertsBeforeE1(t.NextInAEL,e);)t=t.NextInAEL;e.NextInAEL=t.NextInAEL,null!==t.NextInAEL&&(t.NextInAEL.PrevInAEL=e),e.PrevInAEL=t,t.NextInAEL=e}},nn.Clipper.prototype.E2InsertsBeforeE1=function(e,t){return t.Curr.X==e.Curr.X?t.Top.Y>e.Top.Y?t.Top.X<nn.Clipper.TopX(e,t.Top.Y):e.Top.X>nn.Clipper.TopX(t,e.Top.Y):t.Curr.X<e.Curr.X},nn.Clipper.prototype.IsEvenOddFillType=function(e){return e.PolyTyp==nn.PolyType.ptSubject?this.m_SubjFillType==nn.PolyFillType.pftEvenOdd:this.m_ClipFillType==nn.PolyFillType.pftEvenOdd},nn.Clipper.prototype.IsEvenOddAltFillType=function(e){return e.PolyTyp==nn.PolyType.ptSubject?this.m_ClipFillType==nn.PolyFillType.pftEvenOdd:this.m_SubjFillType==nn.PolyFillType.pftEvenOdd},nn.Clipper.prototype.IsContributing=function(e){var t,n;switch(e.PolyTyp==nn.PolyType.ptSubject?(t=this.m_SubjFillType,n=this.m_ClipFillType):(t=this.m_ClipFillType,n=this.m_SubjFillType),t){case nn.PolyFillType.pftEvenOdd:if(0===e.WindDelta&&1!=e.WindCnt)return!1;break;case nn.PolyFillType.pftNonZero:if(1!=Math.abs(e.WindCnt))return!1;break;case nn.PolyFillType.pftPositive:if(1!=e.WindCnt)return!1;break;default:if(-1!=e.WindCnt)return!1}switch(this.m_ClipType){case nn.ClipType.ctIntersection:switch(n){case nn.PolyFillType.pftEvenOdd:case nn.PolyFillType.pftNonZero:return 0!==e.WindCnt2;case nn.PolyFillType.pftPositive:return e.WindCnt2>0;default:return e.WindCnt2<0};case nn.ClipType.ctUnion:switch(n){case nn.PolyFillType.pftEvenOdd:case nn.PolyFillType.pftNonZero:return 0===e.WindCnt2;case nn.PolyFillType.pftPositive:return e.WindCnt2<=0;default:return e.WindCnt2>=0};case nn.ClipType.ctDifference:if(e.PolyTyp==nn.PolyType.ptSubject)switch(n){case nn.PolyFillType.pftEvenOdd:case nn.PolyFillType.pftNonZero:return 0===e.WindCnt2;case nn.PolyFillType.pftPositive:return e.WindCnt2<=0;default:return e.WindCnt2>=0}else switch(n){case nn.PolyFillType.pftEvenOdd:case nn.PolyFillType.pftNonZero:return 0!==e.WindCnt2;case nn.PolyFillType.pftPositive:return e.WindCnt2>0;default:return e.WindCnt2<0};case nn.ClipType.ctXor:if(0!==e.WindDelta)return!0;switch(n){case nn.PolyFillType.pftEvenOdd:case nn.PolyFillType.pftNonZero:return 0===e.WindCnt2;case nn.PolyFillType.pftPositive:return e.WindCnt2<=0;default:return e.WindCnt2>=0}}return!0},nn.Clipper.prototype.SetWindingCount=function(e){for(var t=e.PrevInAEL;null!==t&&(t.PolyTyp!=e.PolyTyp||0===t.WindDelta);)t=t.PrevInAEL;if(null===t)e.WindCnt=0===e.WindDelta?1:e.WindDelta,e.WindCnt2=0,t=this.m_ActiveEdges;else if(0===e.WindDelta&&this.m_ClipType!=nn.ClipType.ctUnion)e.WindCnt=1,e.WindCnt2=t.WindCnt2,t=t.NextInAEL;else if(this.IsEvenOddFillType(e)){if(0===e.WindDelta){for(var n=!0,r=t.PrevInAEL;null!==r;)r.PolyTyp==t.PolyTyp&&0!==r.WindDelta&&(n=!n),r=r.PrevInAEL;e.WindCnt=n?0:1}else e.WindCnt=e.WindDelta;e.WindCnt2=t.WindCnt2,t=t.NextInAEL}else e.WindCnt=t.WindCnt*t.WindDelta<0?Math.abs(t.WindCnt)>1?t.WindDelta*e.WindDelta<0?t.WindCnt:t.WindCnt+e.WindDelta:0===e.WindDelta?1:e.WindDelta:0===e.WindDelta?t.WindCnt<0?t.WindCnt-1:t.WindCnt+1:t.WindDelta*e.WindDelta<0?t.WindCnt:t.WindCnt+e.WindDelta,e.WindCnt2=t.WindCnt2,t=t.NextInAEL;if(this.IsEvenOddAltFillType(e))for(;t!=e;)0!==t.WindDelta&&(e.WindCnt2=0===e.WindCnt2?1:0),t=t.NextInAEL;else for(;t!=e;)e.WindCnt2+=t.WindDelta,t=t.NextInAEL},nn.Clipper.prototype.AddEdgeToSEL=function(e){null===this.m_SortedEdges?(this.m_SortedEdges=e,e.PrevInSEL=null,e.NextInSEL=null):(e.NextInSEL=this.m_SortedEdges,e.PrevInSEL=null,this.m_SortedEdges.PrevInSEL=e,this.m_SortedEdges=e)},nn.Clipper.prototype.CopyAELToSEL=function(){var e=this.m_ActiveEdges;for(this.m_SortedEdges=e;null!==e;)e.PrevInSEL=e.PrevInAEL,e.NextInSEL=e.NextInAEL,e=e.NextInAEL},nn.Clipper.prototype.SwapPositionsInAEL=function(e,t){if(e.NextInAEL!=e.PrevInAEL&&t.NextInAEL!=t.PrevInAEL){if(e.NextInAEL==t){var n=t.NextInAEL;null!==n&&(n.PrevInAEL=e);var r=e.PrevInAEL;null!==r&&(r.NextInAEL=t),t.PrevInAEL=r,t.NextInAEL=e,e.PrevInAEL=t,e.NextInAEL=n}else if(t.NextInAEL==e){var n=e.NextInAEL;null!==n&&(n.PrevInAEL=t);var r=t.PrevInAEL;null!==r&&(r.NextInAEL=e),e.PrevInAEL=r,e.NextInAEL=t,t.PrevInAEL=e,t.NextInAEL=n}else{var n=e.NextInAEL,r=e.PrevInAEL;e.NextInAEL=t.NextInAEL,null!==e.NextInAEL&&(e.NextInAEL.PrevInAEL=e),e.PrevInAEL=t.PrevInAEL,null!==e.PrevInAEL&&(e.PrevInAEL.NextInAEL=e),t.NextInAEL=n,null!==t.NextInAEL&&(t.NextInAEL.PrevInAEL=t),t.PrevInAEL=r,null!==t.PrevInAEL&&(t.PrevInAEL.NextInAEL=t)}null===e.PrevInAEL?this.m_ActiveEdges=e:null===t.PrevInAEL&&(this.m_ActiveEdges=t)}},nn.Clipper.prototype.SwapPositionsInSEL=function(e,t){if(!(null===e.NextInSEL&&null===e.PrevInSEL||null===t.NextInSEL&&null===t.PrevInSEL)){if(e.NextInSEL==t){var n=t.NextInSEL;null!==n&&(n.PrevInSEL=e);var r=e.PrevInSEL;null!==r&&(r.NextInSEL=t),t.PrevInSEL=r,t.NextInSEL=e,e.PrevInSEL=t,e.NextInSEL=n}else if(t.NextInSEL==e){var n=e.NextInSEL;null!==n&&(n.PrevInSEL=t);var r=t.PrevInSEL;null!==r&&(r.NextInSEL=e),e.PrevInSEL=r,e.NextInSEL=t,t.PrevInSEL=e,t.NextInSEL=n}else{var n=e.NextInSEL,r=e.PrevInSEL;e.NextInSEL=t.NextInSEL,null!==e.NextInSEL&&(e.NextInSEL.PrevInSEL=e),e.PrevInSEL=t.PrevInSEL,null!==e.PrevInSEL&&(e.PrevInSEL.NextInSEL=e),t.NextInSEL=n,null!==t.NextInSEL&&(t.NextInSEL.PrevInSEL=t),t.PrevInSEL=r,null!==t.PrevInSEL&&(t.PrevInSEL.NextInSEL=t)}null===e.PrevInSEL?this.m_SortedEdges=e:null===t.PrevInSEL&&(this.m_SortedEdges=t)}},nn.Clipper.prototype.AddLocalMaxPoly=function(e,t,n){this.AddOutPt(e,n),0==t.WindDelta&&this.AddOutPt(t,n),e.OutIdx==t.OutIdx?(e.OutIdx=-1,t.OutIdx=-1):e.OutIdx<t.OutIdx?this.AppendPolygon(e,t):this.AppendPolygon(t,e)},nn.Clipper.prototype.AddLocalMinPoly=function(e,t,n){var r,i,s;if(nn.ClipperBase.IsHorizontal(t)||e.Dx>t.Dx?(r=this.AddOutPt(e,n),t.OutIdx=e.OutIdx,e.Side=nn.EdgeSide.esLeft,t.Side=nn.EdgeSide.esRight,i=e,s=i.PrevInAEL==t?t.PrevInAEL:i.PrevInAEL):(r=this.AddOutPt(t,n),e.OutIdx=t.OutIdx,e.Side=nn.EdgeSide.esRight,t.Side=nn.EdgeSide.esLeft,i=t,s=i.PrevInAEL==e?e.PrevInAEL:i.PrevInAEL),null!==s&&s.OutIdx>=0&&nn.Clipper.TopX(s,n.Y)==nn.Clipper.TopX(i,n.Y)&&nn.ClipperBase.SlopesEqual(i,s,this.m_UseFullRange)&&0!==i.WindDelta&&0!==s.WindDelta){var o=this.AddOutPt(s,n);this.AddJoin(r,o,i.Top)}return r},nn.Clipper.prototype.CreateOutRec=function(){var e=new nn.OutRec;return e.Idx=-1,e.IsHole=!1,e.IsOpen=!1,e.FirstLeft=null,e.Pts=null,e.BottomPt=null,e.PolyNode=null,this.m_PolyOuts.push(e),e.Idx=this.m_PolyOuts.length-1,e},nn.Clipper.prototype.AddOutPt=function(e,t){var n=e.Side==nn.EdgeSide.esLeft;if(e.OutIdx<0){var r=this.CreateOutRec();r.IsOpen=0===e.WindDelta;var i=new nn.OutPt;return r.Pts=i,i.Idx=r.Idx,i.Pt.X=t.X,i.Pt.Y=t.Y,i.Next=i,i.Prev=i,r.IsOpen||this.SetHoleState(e,r),Zt&&(nn.IntPoint.op_Equality(t,e.Bot)?(i.Pt.X=e.Bot.X,i.Pt.Y=e.Bot.Y,i.Pt.Z=e.Bot.Z):nn.IntPoint.op_Equality(t,e.Top)?(i.Pt.X=e.Top.X,i.Pt.Y=e.Top.Y,i.Pt.Z=e.Top.Z):this.SetZ(i.Pt,e)),e.OutIdx=r.Idx,i}var r=this.m_PolyOuts[e.OutIdx],s=r.Pts;if(n&&nn.IntPoint.op_Equality(t,s.Pt))return s;if(!n&&nn.IntPoint.op_Equality(t,s.Prev.Pt))return s.Prev;var i=new nn.OutPt;return i.Idx=r.Idx,i.Pt.X=t.X,i.Pt.Y=t.Y,i.Next=s,i.Prev=s.Prev,i.Prev.Next=i,s.Prev=i,n&&(r.Pts=i),Zt&&(nn.IntPoint.op_Equality(t,e.Bot)?(i.Pt.X=e.Bot.X,i.Pt.Y=e.Bot.Y,i.Pt.Z=e.Bot.Z):nn.IntPoint.op_Equality(t,e.Top)?(i.Pt.X=e.Top.X,i.Pt.Y=e.Top.Y,i.Pt.Z=e.Top.Z):this.SetZ(i.Pt,e)),i},nn.Clipper.prototype.SwapPoints=function(e,t){var n=new nn.IntPoint(e.Value);e.Value.X=t.Value.X,e.Value.Y=t.Value.Y,t.Value.X=n.X,t.Value.Y=n.Y},nn.Clipper.prototype.HorzSegmentsOverlap=function(e,t,n,r){return e.X>n.X==e.X<r.X?!0:t.X>n.X==t.X<r.X?!0:n.X>e.X==n.X<t.X?!0:r.X>e.X==r.X<t.X?!0:e.X==n.X&&t.X==r.X?!0:e.X==r.X&&t.X==n.X?!0:!1},nn.Clipper.prototype.InsertPolyPtBetween=function(e,t,n){var r=new nn.OutPt;return r.Pt.X=n.X,r.Pt.Y=n.Y,t==e.Next?(e.Next=r,t.Prev=r,r.Next=t,r.Prev=e):(t.Next=r,e.Prev=r,r.Next=e,r.Prev=t),r},nn.Clipper.prototype.SetHoleState=function(e,t){for(var n=!1,r=e.PrevInAEL;null!==r;)r.OutIdx>=0&&0!=r.WindDelta&&(n=!n,null===t.FirstLeft&&(t.FirstLeft=this.m_PolyOuts[r.OutIdx])),r=r.PrevInAEL;n&&(t.IsHole=!0)},nn.Clipper.prototype.GetDx=function(e,t){return e.Y==t.Y?nn.ClipperBase.horizontal:(t.X-e.X)/(t.Y-e.Y)},nn.Clipper.prototype.FirstIsBottomPt=function(e,t){for(var n=e.Prev;nn.IntPoint.op_Equality(n.Pt,e.Pt)&&n!=e;)n=n.Prev;var r=Math.abs(this.GetDx(e.Pt,n.Pt));for(n=e.Next;nn.IntPoint.op_Equality(n.Pt,e.Pt)&&n!=e;)n=n.Next;var i=Math.abs(this.GetDx(e.Pt,n.Pt));for(n=t.Prev;nn.IntPoint.op_Equality(n.Pt,t.Pt)&&n!=t;)n=n.Prev;var s=Math.abs(this.GetDx(t.Pt,n.Pt));for(n=t.Next;nn.IntPoint.op_Equality(n.Pt,t.Pt)&&n!=t;)n=n.Next;var o=Math.abs(this.GetDx(t.Pt,n.Pt));return r>=s&&r>=o||i>=s&&i>=o},nn.Clipper.prototype.GetBottomPt=function(e){for(var t=null,n=e.Next;n!=e;)n.Pt.Y>e.Pt.Y?(e=n,t=null):n.Pt.Y==e.Pt.Y&&n.Pt.X<=e.Pt.X&&(n.Pt.X<e.Pt.X?(t=null,e=n):n.Next!=e&&n.Prev!=e&&(t=n)),n=n.Next;if(null!==t)for(;t!=n;)for(this.FirstIsBottomPt(n,t)||(e=t),t=t.Next;nn.IntPoint.op_Inequality(t.Pt,e.Pt);)t=t.Next;return e},nn.Clipper.prototype.GetLowermostRec=function(e,t){null===e.BottomPt&&(e.BottomPt=this.GetBottomPt(e.Pts)),null===t.BottomPt&&(t.BottomPt=this.GetBottomPt(t.Pts));var n=e.BottomPt,r=t.BottomPt;return n.Pt.Y>r.Pt.Y?e:n.Pt.Y<r.Pt.Y?t:n.Pt.X<r.Pt.X?e:n.Pt.X>r.Pt.X?t:n.Next==n?t:r.Next==r?e:this.FirstIsBottomPt(n,r)?e:t},nn.Clipper.prototype.Param1RightOfParam2=function(e,t){do if(e=e.FirstLeft,e==t)return!0;while(null!==e);return!1},nn.Clipper.prototype.GetOutRec=function(e){for(var t=this.m_PolyOuts[e];t!=this.m_PolyOuts[t.Idx];)t=this.m_PolyOuts[t.Idx];return t},nn.Clipper.prototype.AppendPolygon=function(e,t){var n,r=this.m_PolyOuts[e.OutIdx],i=this.m_PolyOuts[t.OutIdx];n=this.Param1RightOfParam2(r,i)?i:this.Param1RightOfParam2(i,r)?r:this.GetLowermostRec(r,i);var s,o=r.Pts,u=o.Prev,a=i.Pts,f=a.Prev;e.Side==nn.EdgeSide.esLeft?(t.Side==nn.EdgeSide.esLeft?(this.ReversePolyPtLinks(a),a.Next=o,o.Prev=a,u.Next=f,f.Prev=u,r.Pts=f):(f.Next=o,o.Prev=f,a.Prev=u,u.Next=a,r.Pts=a),s=nn.EdgeSide.esLeft):(t.Side==nn.EdgeSide.esRight?(this.ReversePolyPtLinks(a),u.Next=f,f.Prev=u,a.Next=o,o.Prev=a):(u.Next=a,a.Prev=u,o.Prev=f,f.Next=o),s=nn.EdgeSide.esRight),r.BottomPt=null,n==i&&(i.FirstLeft!=r&&(r.FirstLeft=i.FirstLeft),r.IsHole=i.IsHole),i.Pts=null,i.BottomPt=null,i.FirstLeft=r;var l=e.OutIdx,c=t.OutIdx;e.OutIdx=-1,t.OutIdx=-1;for(var h=this.m_ActiveEdges;null!==h;){if(h.OutIdx==c){h.OutIdx=l,h.Side=s;break}h=h.NextInAEL}i.Idx=r.Idx},nn.Clipper.prototype.ReversePolyPtLinks=function(e){if(null!==e){var t,n;t=e;do n=t.Next,t.Next=t.Prev,t.Prev=n,t=n;while(t!=e)}},nn.Clipper.SwapSides=function(e,t){var n=e.Side;e.Side=t.Side,t.Side=n},nn.Clipper.SwapPolyIndexes=function(e,t){var n=e.OutIdx;e.OutIdx=t.OutIdx,t.OutIdx=n},nn.Clipper.prototype.IntersectEdges=function(e,t,n,r){var i=!r&&null===e.NextInLML&&e.Top.X==n.X&&e.Top.Y==n.Y,s=!r&&null===t.NextInLML&&t.Top.X==n.X&&t.Top.Y==n.Y,o=e.OutIdx>=0,u=t.OutIdx>=0;if(!(!en||0!==e.WindDelta&&0!==t.WindDelta))return 0===e.WindDelta&&0===t.WindDelta?(i||s)&&o&&u&&this.AddLocalMaxPoly(e,t,n):e.PolyTyp==t.PolyTyp&&e.WindDelta!=t.WindDelta&&this.m_ClipType==nn.ClipType.ctUnion?0===e.WindDelta?u&&(this.AddOutPt(e,n),o&&(e.OutIdx=-1)):o&&(this.AddOutPt(t,n),u&&(t.OutIdx=-1)):e.PolyTyp!=t.PolyTyp&&(0!==e.WindDelta||1!=Math.abs(t.WindCnt)||this.m_ClipType==nn.ClipType.ctUnion&&0!==t.WindCnt2?0!==t.WindDelta||1!=Math.abs(e.WindCnt)||this.m_ClipType==nn.ClipType.ctUnion&&0!==e.WindCnt2||(this.AddOutPt(t,n),u&&(t.OutIdx=-1)):(this.AddOutPt(e,n),o&&(e.OutIdx=-1))),i&&(e.OutIdx<0?this.DeleteFromAEL(e):nn.Error("Error intersecting polylines")),s&&(t.OutIdx<0?this.DeleteFromAEL(t):nn.Error("Error intersecting polylines")),void 0;if(e.PolyTyp==t.PolyTyp)if(this.IsEvenOddFillType(e)){var a=e.WindCnt;e.WindCnt=t.WindCnt,t.WindCnt=a}else 0===e.WindCnt+t.WindDelta?e.WindCnt=-e.WindCnt:e.WindCnt+=t.WindDelta,0===t.WindCnt-e.WindDelta?t.WindCnt=-t.WindCnt:t.WindCnt-=e.WindDelta;else this.IsEvenOddFillType(t)?e.WindCnt2=0===e.WindCnt2?1:0:e.WindCnt2+=t.WindDelta,this.IsEvenOddFillType(e)?t.WindCnt2=0===t.WindCnt2?1:0:t.WindCnt2-=e.WindDelta;var f,l,c,h;e.PolyTyp==nn.PolyType.ptSubject?(f=this.m_SubjFillType,c=this.m_ClipFillType):(f=this.m_ClipFillType,c=this.m_SubjFillType),t.PolyTyp==nn.PolyType.ptSubject?(l=this.m_SubjFillType,h=this.m_ClipFillType):(l=this.m_ClipFillType,h=this.m_SubjFillType);var p,d;switch(f){case nn.PolyFillType.pftPositive:p=e.WindCnt;break;case nn.PolyFillType.pftNegative:p=-e.WindCnt;break;default:p=Math.abs(e.WindCnt)}switch(l){case nn.PolyFillType.pftPositive:d=t.WindCnt;break;case nn.PolyFillType.pftNegative:d=-t.WindCnt;break;default:d=Math.abs(t.WindCnt)}if(o&&u)i||s||0!==p&&1!=p||0!==d&&1!=d||e.PolyTyp!=t.PolyTyp&&this.m_ClipType!=nn.ClipType.ctXor?this.AddLocalMaxPoly(e,t,n):(this.AddOutPt(e,n),this.AddOutPt(t,n),nn.Clipper.SwapSides(e,t),nn.Clipper.SwapPolyIndexes(e,t));else if(o)(0===d||1==d)&&(this.AddOutPt(e,n),nn.Clipper.SwapSides(e,t),nn.Clipper.SwapPolyIndexes(e,t));else if(u)(0===p||1==p)&&(this.AddOutPt(t,n),nn.Clipper.SwapSides(e,t),nn.Clipper.SwapPolyIndexes(e,t));else if(!(0!==p&&1!=p||0!==d&&1!=d||i||s)){var v,m;switch(c){case nn.PolyFillType.pftPositive:v=e.WindCnt2;break;case nn.PolyFillType.pftNegative:v=-e.WindCnt2;break;default:v=Math.abs(e.WindCnt2)}switch(h){case nn.PolyFillType.pftPositive:m=t.WindCnt2;break;case nn.PolyFillType.pftNegative:m=-t.WindCnt2;break;default:m=Math.abs(t.WindCnt2)}if(e.PolyTyp!=t.PolyTyp)this.AddLocalMinPoly(e,t,n);else if(1==p&&1==d)switch(this.m_ClipType){case nn.ClipType.ctIntersection:v>0&&m>0&&this.AddLocalMinPoly(e,t,n);break;case nn.ClipType.ctUnion:0>=v&&0>=m&&this.AddLocalMinPoly(e,t,n);break;case nn.ClipType.ctDifference:(e.PolyTyp==nn.PolyType.ptClip&&v>0&&m>0||e.PolyTyp==nn.PolyType.ptSubject&&0>=v&&0>=m)&&this.AddLocalMinPoly(e,t,n);break;case nn.ClipType.ctXor:this.AddLocalMinPoly(e,t,n)}else nn.Clipper.SwapSides(e,t)}i!=s&&(i&&e.OutIdx>=0||s&&t.OutIdx>=0)&&(nn.Clipper.SwapSides(e,t),nn.Clipper.SwapPolyIndexes(e,t)),i&&this.DeleteFromAEL(e),s&&this.DeleteFromAEL(t)},nn.Clipper.prototype.DeleteFromAEL=function(e){var t=e.PrevInAEL,n=e.NextInAEL;(null!==t||null!==n||e==this.m_ActiveEdges)&&(null!==t?t.NextInAEL=n:this.m_ActiveEdges=n,null!==n&&(n.PrevInAEL=t),e.NextInAEL=null,e.PrevInAEL=null)},nn.Clipper.prototype.DeleteFromSEL=function(e){var t=e.PrevInSEL,n=e.NextInSEL;(null!==t||null!==n||e==this.m_SortedEdges)&&(null!==t?t.NextInSEL=n:this.m_SortedEdges=n,null!==n&&(n.PrevInSEL=t),e.NextInSEL=null,e.PrevInSEL=null)},nn.Clipper.prototype.UpdateEdgeIntoAEL=function(e){null===e.NextInLML&&nn.Error("UpdateEdgeIntoAEL: invalid call");var t=e.PrevInAEL,n=e.NextInAEL;return e.NextInLML.OutIdx=e.OutIdx,null!==t?t.NextInAEL=e.NextInLML:this.m_ActiveEdges=e.NextInLML,null!==n&&(n.PrevInAEL=e.NextInLML),e.NextInLML.Side=e.Side,e.NextInLML.WindDelta=e.WindDelta,e.NextInLML.WindCnt=e.WindCnt,e.NextInLML.WindCnt2=e.WindCnt2,e=e.NextInLML,e.Curr.X=e.Bot.X,e.Curr.Y=e.Bot.Y,e.PrevInAEL=t,e.NextInAEL=n,nn.ClipperBase.IsHorizontal(e)||this.InsertScanbeam(e.Top.Y),e},nn.Clipper.prototype.ProcessHorizontals=function(e){for(var t=this.m_SortedEdges;null!==t;)this.DeleteFromSEL(t),this.ProcessHorizontal(t,e),t=this.m_SortedEdges},nn.Clipper.prototype.GetHorzDirection=function(e,t){e.Bot.X<e.Top.X?(t.Left=e.Bot.X,t.Right=e.Top.X,t.Dir=nn.Direction.dLeftToRight):(t.Left=e.Top.X,t.Right=e.Bot.X,t.Dir=nn.Direction.dRightToLeft)},nn.Clipper.prototype.PrepareHorzJoins=function(e,t){var n=this.m_PolyOuts[e.OutIdx].Pts;e.Side!=nn.EdgeSide.esLeft&&(n=n.Prev),t&&(nn.IntPoint.op_Equality(n.Pt,e.Top)?this.AddGhostJoin(n,e.Bot):this.AddGhostJoin(n,e.Top))},nn.Clipper.prototype.ProcessHorizontal=function(e,t){var n={Dir:null,Left:null,Right:null};this.GetHorzDirection(e,n);for(var r=n.Dir,i=n.Left,s=n.Right,o=e,u=null;null!==o.NextInLML&&nn.ClipperBase.IsHorizontal(o.NextInLML);)o=o.NextInLML;for(null===o.NextInLML&&(u=this.GetMaximaPair(o));;){for(var a=e==o,f=this.GetNextInAEL(e,r);null!==f&&!(f.Curr.X==e.Top.X&&null!==e.NextInLML&&f.Dx<e.NextInLML.Dx);){var l=this.GetNextInAEL(f,r);if(r==nn.Direction.dLeftToRight&&f.Curr.X<=s||r==nn.Direction.dRightToLeft&&f.Curr.X>=i){if(e.OutIdx>=0&&0!=e.WindDelta&&this.PrepareHorzJoins(e,t),f==u&&a)return r==nn.Direction.dLeftToRight?this.IntersectEdges(e,f,f.Top,!1):this.IntersectEdges(f,e,f.Top,!1),u.OutIdx>=0&&nn.Error("ProcessHorizontal error"),void 0;if(r==nn.Direction.dLeftToRight){var c=new nn.IntPoint(f.Curr.X,e.Curr.Y);this.IntersectEdges(e,f,c,!0)}else{var c=new nn.IntPoint(f.Curr.X,e.Curr.Y);this.IntersectEdges(f,e,c,!0)}this.SwapPositionsInAEL(e,f)}else if(r==nn.Direction.dLeftToRight&&f.Curr.X>=s||r==nn.Direction.dRightToLeft&&f.Curr.X<=i)break;f=l}if(e.OutIdx>=0&&0!==e.WindDelta&&this.PrepareHorzJoins(e,t),null===e.NextInLML||!nn.ClipperBase.IsHorizontal(e.NextInLML))break;e=this.UpdateEdgeIntoAEL(e),e.OutIdx>=0&&this.AddOutPt(e,e.Bot);var n={Dir:r,Left:i,Right:s};this.GetHorzDirection(e,n),r=n.Dir,i=n.Left,s=n.Right}if(null!==e.NextInLML)if(e.OutIdx>=0){var h=this.AddOutPt(e,e.Top);if(e=this.UpdateEdgeIntoAEL(e),0===e.WindDelta)return;var p=e.PrevInAEL,l=e.NextInAEL;if(null!==p&&p.Curr.X==e.Bot.X&&p.Curr.Y==e.Bot.Y&&0!==p.WindDelta&&p.OutIdx>=0&&p.Curr.Y>p.Top.Y&&nn.ClipperBase.SlopesEqual(e,p,this.m_UseFullRange)){var d=this.AddOutPt(p,e.Bot);this.AddJoin(h,d,e.Top)}else if(null!==l&&l.Curr.X==e.Bot.X&&l.Curr.Y==e.Bot.Y&&0!==l.WindDelta&&l.OutIdx>=0&&l.Curr.Y>l.Top.Y&&nn.ClipperBase.SlopesEqual(e,l,this.m_UseFullRange)){var d=this.AddOutPt(l,e.Bot);this.AddJoin(h,d,e.Top)}}else e=this.UpdateEdgeIntoAEL(e);else null!==u?u.OutIdx>=0?(r==nn.Direction.dLeftToRight?this.IntersectEdges(e,u,e.Top,!1):this.IntersectEdges(u,e,e.Top,!1),u.OutIdx>=0&&nn.Error("ProcessHorizontal error")):(this.DeleteFromAEL(e),this.DeleteFromAEL(u)):(e.OutIdx>=0&&this.AddOutPt(e,e.Top),this.DeleteFromAEL(e))},nn.Clipper.prototype.GetNextInAEL=function(e,t){return t==nn.Direction.dLeftToRight?e.NextInAEL:e.PrevInAEL},nn.Clipper.prototype.IsMinima=function(e){return null!==e&&e.Prev.NextInLML!=e&&e.Next.NextInLML!=e},nn.Clipper.prototype.IsMaxima=function(e,t){return null!==e&&e.Top.Y==t&&null===e.NextInLML},nn.Clipper.prototype.IsIntermediate=function(e,t){return e.Top.Y==t&&null!==e.NextInLML},nn.Clipper.prototype.GetMaximaPair=function(e){var t=null;return nn.IntPoint.op_Equality(e.Next.Top,e.Top)&&null===e.Next.NextInLML?t=e.Next:nn.IntPoint.op_Equality(e.Prev.Top,e.Top)&&null===e.Prev.NextInLML&&(t=e.Prev),null===t||-2!=t.OutIdx&&(t.NextInAEL!=t.PrevInAEL||nn.ClipperBase.IsHorizontal(t))?t:null},nn.Clipper.prototype.ProcessIntersections=function(e,t){if(null==this.m_ActiveEdges)return!0;try{if(this.BuildIntersectList(e,t),0==this.m_IntersectList.length)return!0;if(1!=this.m_IntersectList.length&&!this.FixupIntersectionOrder())return!1;this.ProcessIntersectList()}catch(n){this.m_SortedEdges=null,this.m_IntersectList.length=0,nn.Error("ProcessIntersections error")}return this.m_SortedEdges=null,!0},nn.Clipper.prototype.BuildIntersectList=function(e,t){if(null!==this.m_ActiveEdges){var n=this.m_ActiveEdges;for(this.m_SortedEdges=n;null!==n;)n.PrevInSEL=n.PrevInAEL,n.NextInSEL=n.NextInAEL,n.Curr.X=nn.Clipper.TopX(n,t),n=n.NextInAEL;for(var r=!0;r&&null!==this.m_SortedEdges;){for(r=!1,n=this.m_SortedEdges;null!==n.NextInSEL;){var i=n.NextInSEL,s=new nn.IntPoint;if(n.Curr.X>i.Curr.X){!this.IntersectPoint(n,i,s)&&n.Curr.X>i.Curr.X+1&&nn.Error("Intersection error"),s.Y>e&&(s.Y=e,s.X=Math.abs(n.Dx)>Math.abs(i.Dx)?nn.Clipper.TopX(i,e):nn.Clipper.TopX(n,e));var o=new nn.IntersectNode;o.Edge1=n,o.Edge2=i,o.Pt.X=s.X,o.Pt.Y=s.Y,this.m_IntersectList.push(o),this.SwapPositionsInSEL(n,i),r=!0}else n=i}if(null===n.PrevInSEL)break;n.PrevInSEL.NextInSEL=null}this.m_SortedEdges=null}},nn.Clipper.prototype.EdgesAdjacent=function(e){return e.Edge1.NextInSEL==e.Edge2||e.Edge1.PrevInSEL==e.Edge2},nn.Clipper.IntersectNodeSort=function(e,t){return t.Pt.Y-e.Pt.Y},nn.Clipper.prototype.FixupIntersectionOrder=function(){this.m_IntersectList.sort(this.m_IntersectNodeComparer),this.CopyAELToSEL();for(var e=this.m_IntersectList.length,t=0;e>t;t++){if(!this.EdgesAdjacent(this.m_IntersectList[t])){for(var n=t+1;e>n&&!this.EdgesAdjacent(this.m_IntersectList[n]);)n++;if(n==e)return!1;var r=this.m_IntersectList[t];this.m_IntersectList[t]=this.m_IntersectList[n],this.m_IntersectList[n]=r}this.SwapPositionsInSEL(this.m_IntersectList[t].Edge1,this.m_IntersectList[t].Edge2)}return!0},nn.Clipper.prototype.ProcessIntersectList=function(){for(var e=0,t=this.m_IntersectList.length;t>e;e++){var n=this.m_IntersectList[e];this.IntersectEdges(n.Edge1,n.Edge2,n.Pt,!0),this.SwapPositionsInAEL(n.Edge1,n.Edge2)}this.m_IntersectList.length=0};var wn=function(e){return 0>e?Math.ceil(e-.5):Math.round(e)},En=function(e){return 0>e?Math.ceil(e-.5):Math.floor(e+.5)},Sn=function(e){return 0>e?-Math.round(Math.abs(e)):Math.round(e)},xn=function(e){return 0>e?(e-=.5,-2147483648>e?Math.ceil(e):0|e):(e+=.5,e>2147483647?Math.floor(e):0|e)};return nn.Clipper.Round=un.msie?wn:un.chromium?Sn:un.safari?xn:En,nn.Clipper.TopX=function(e,t){return t==e.Top.Y?e.Top.X:e.Bot.X+nn.Clipper.Round(e.Dx*(t-e.Bot.Y))},nn.Clipper.prototype.IntersectPoint=function(e,t,n){n.X=0,n.Y=0;var r,i;if(nn.ClipperBase.SlopesEqual(e,t,this.m_UseFullRange)||e.Dx==t.Dx)return t.Bot.Y>e.Bot.Y?(n.X=t.Bot.X,n.Y=t.Bot.Y):(n.X=e.Bot.X,n.Y=e.Bot.Y),!1;if(0===e.Delta.X)n.X=e.Bot.X,nn.ClipperBase.IsHorizontal(t)?n.Y=t.Bot.Y:(i=t.Bot.Y-t.Bot.X/t.Dx,n.Y=nn.Clipper.Round(n.X/t.Dx+i));else if(0===t.Delta.X)n.X=t.Bot.X,nn.ClipperBase.IsHorizontal(e)?n.Y=e.Bot.Y:(r=e.Bot.Y-e.Bot.X/e.Dx,n.Y=nn.Clipper.Round(n.X/e.Dx+r));else{r=e.Bot.X-e.Bot.Y*e.Dx,i=t.Bot.X-t.Bot.Y*t.Dx;var s=(i-r)/(e.Dx-t.Dx);n.Y=nn.Clipper.Round(s),n.X=Math.abs(e.Dx)<Math.abs(t.Dx)?nn.Clipper.Round(e.Dx*s+r):nn.Clipper.Round(t.Dx*s+i)}if(n.Y<e.Top.Y||n.Y<t.Top.Y){if(e.Top.Y>t.Top.Y)return n.Y=e.Top.Y,n.X=nn.Clipper.TopX(t,e.Top.Y),n.X<e.Top.X;n.Y=t.Top.Y,n.X=Math.abs(e.Dx)<Math.abs(t.Dx)?nn.Clipper.TopX(e,n.Y):nn.Clipper.TopX(t,n.Y)}return!0},nn.Clipper.prototype.ProcessEdgesAtTopOfScanbeam=function(e){for(var t=this.m_ActiveEdges;null!==t;){var n=this.IsMaxima(t,e);if(n){var r=this.GetMaximaPair(t);n=null===r||!nn.ClipperBase.IsHorizontal(r)}if(n){var i=t.PrevInAEL;this.DoMaxima(t),t=null===i?this.m_ActiveEdges:i.NextInAEL}else{if(this.IsIntermediate(t,e)&&nn.ClipperBase.IsHorizontal(t.NextInLML)?(t=this.UpdateEdgeIntoAEL(t),t.OutIdx>=0&&this.AddOutPt(t,t.Bot),this.AddEdgeToSEL(t)):(t.Curr.X=nn.Clipper.TopX(t,e),t.Curr.Y=e),this.StrictlySimple){var i=t.PrevInAEL;if(t.OutIdx>=0&&0!==t.WindDelta&&null!==i&&i.OutIdx>=0&&i.Curr.X==t.Curr.X&&0!==i.WindDelta){var s=this.AddOutPt(i,t.Curr),o=this.AddOutPt(t,t.Curr);this.AddJoin(s,o,t.Curr)}}t=t.NextInAEL}}for(this.ProcessHorizontals(!0),t=this.m_ActiveEdges;null!==t;){if(this.IsIntermediate(t,e)){var s=null;t.OutIdx>=0&&(s=this.AddOutPt(t,t.Top)),t=this.UpdateEdgeIntoAEL(t);var i=t.PrevInAEL,u=t.NextInAEL;if(null!==i&&i.Curr.X==t.Bot.X&&i.Curr.Y==t.Bot.Y&&null!==s&&i.OutIdx>=0&&i.Curr.Y>i.Top.Y&&nn.ClipperBase.SlopesEqual(t,i,this.m_UseFullRange)&&0!==t.WindDelta&&0!==i.WindDelta){var o=this.AddOutPt(i,t.Bot);this.AddJoin(s,o,t.Top)}else if(null!==u&&u.Curr.X==t.Bot.X&&u.Curr.Y==t.Bot.Y&&null!==s&&u.OutIdx>=0&&u.Curr.Y>u.Top.Y&&nn.ClipperBase.SlopesEqual(t,u,this.m_UseFullRange)&&0!==t.WindDelta&&0!==u.WindDelta){var o=this.AddOutPt(u,t.Bot);this.AddJoin(s,o,t.Top)}}t=t.NextInAEL}},nn.Clipper.prototype.DoMaxima=function(e){var t=this.GetMaximaPair(e);if(null===t)return e.OutIdx>=0&&this.AddOutPt(e,e.Top),this.DeleteFromAEL(e),void 0;for(var n=e.NextInAEL,r=!0;null!==n&&n!=t;)this.IntersectEdges(e,n,e.Top,!0),this.SwapPositionsInAEL(e,n),n=e.NextInAEL;-1==e.OutIdx&&-1==t.OutIdx?(this.DeleteFromAEL(e),this.DeleteFromAEL(t)):e.OutIdx>=0&&t.OutIdx>=0?this.IntersectEdges(e,t,e.Top,!1):r&&0===e.WindDelta?(e.OutIdx>=0&&(this.AddOutPt(e,e.Top),e.OutIdx=-1),this.DeleteFromAEL(e),t.OutIdx>=0&&(this.AddOutPt(t,e.Top),t.OutIdx=-1),this.DeleteFromAEL(t)):nn.Error("DoMaxima error")},nn.Clipper.ReversePaths=function(e){for(var t=0,n=e.length;n>t;t++)e[t].reverse()},nn.Clipper.Orientation=function(e){return nn.Clipper.Area(e)>=0},nn.Clipper.prototype.PointCount=function(e){if(null===e)return 0;var t=0,n=e;do t++,n=n.Next;while(n!=e);return t},nn.Clipper.prototype.BuildResult=function(e){nn.Clear(e);for(var t=0,n=this.m_PolyOuts.length;n>t;t++){var r=this.m_PolyOuts[t];if(null!==r.Pts){var i=r.Pts.Prev,s=this.PointCount(i);if(!(2>s)){for(var o=new Array(s),u=0;s>u;u++)o[u]=i.Pt,i=i.Prev;e.push(o)}}}},nn.Clipper.prototype.BuildResult2=function(e){e.Clear();for(var t=0,n=this.m_PolyOuts.length;n>t;t++){var r=this.m_PolyOuts[t],i=this.PointCount(r.Pts);if(!(r.IsOpen&&2>i||!r.IsOpen&&3>i)){this.FixHoleLinkage(r);var s=new nn.PolyNode;e.m_AllPolys.push(s),r.PolyNode=s,s.m_polygon.length=i;for(var o=r.Pts.Prev,u=0;i>u;u++)s.m_polygon[u]=o.Pt,o=o.Prev}}for(var t=0,n=this.m_PolyOuts.length;n>t;t++){var r=this.m_PolyOuts[t];null!==r.PolyNode&&(r.IsOpen?(r.PolyNode.IsOpen=!0,e.AddChild(r.PolyNode)):null!==r.FirstLeft&&null!=r.FirstLeft.PolyNode?r.FirstLeft.PolyNode.AddChild(r.PolyNode):e.AddChild(r.PolyNode))}},nn.Clipper.prototype.FixupOutPolygon=function(e){var t=null;e.BottomPt=null;for(var n=e.Pts;;){if(n.Prev==n||n.Prev==n.Next)return this.DisposeOutPts(n),e.Pts=null,void 0;if(nn.IntPoint.op_Equality(n.Pt,n.Next.Pt)||nn.IntPoint.op_Equality(n.Pt,n.Prev.Pt)||nn.ClipperBase.SlopesEqual(n.Prev.Pt,n.Pt,n.Next.Pt,this.m_UseFullRange)&&(!this.PreserveCollinear||!this.Pt2IsBetweenPt1AndPt3(n.Prev.Pt,n.Pt,n.Next.Pt))){t=null;var r=n;n.Prev.Next=n.Next,n.Next.Prev=n.Prev,n=n.Prev,r=null}else{if(n==t)break;null===t&&(t=n),n=n.Next}}e.Pts=n},nn.Clipper.prototype.DupOutPt=function(e,t){var n=new nn.OutPt;return n.Pt.X=e.Pt.X,n.Pt.Y=e.Pt.Y,n.Idx=e.Idx,t?(n.Next=e.Next,n.Prev=e,e.Next.Prev=n,e.Next=n):(n.Prev=e.Prev,n.Next=e,e.Prev.Next=n,e.Prev=n),n},nn.Clipper.prototype.GetOverlap=function(e,t,n,r,i){return t>e?r>n?(i.Left=Math.max(e,n),i.Right=Math.min(t,r)):(i.Left=Math.max(e,r),i.Right=Math.min(t,n)):r>n?(i.Left=Math.max(t,n),i.Right=Math.min(e,r)):(i.Left=Math.max(t,r),i.Right=Math.min(e,n)),i.Left<i.Right},nn.Clipper.prototype.JoinHorz=function(e,t,n,r,i,s){var o=e.Pt.X>t.Pt.X?nn.Direction.dRightToLeft:nn.Direction.dLeftToRight,u=n.Pt.X>r.Pt.X?nn.Direction.dRightToLeft:nn.Direction.dLeftToRight;if(o==u)return!1;if(o==nn.Direction.dLeftToRight){for(;e.Next.Pt.X<=i.X&&e.Next.Pt.X>=e.Pt.X&&e.Next.Pt.Y==i.Y;)e=e.Next;s&&e.Pt.X!=i.X&&(e=e.Next),t=this.DupOutPt(e,!s),nn.IntPoint.op_Inequality(t.Pt,i)&&(e=t,e.Pt.X=i.X,e.Pt.Y=i.Y,t=this.DupOutPt(e,!s))}else{for(;e.Next.Pt.X>=i.X&&e.Next.Pt.X<=e.Pt.X&&e.Next.Pt.Y==i.Y;)e=e.Next;s||e.Pt.X==i.X||(e=e.Next),t=this.DupOutPt(e,s),nn.IntPoint.op_Inequality(t.Pt,i)&&(e=t,e.Pt.X=i.X,e.Pt.Y=i.Y,t=this.DupOutPt(e,s))}if(u==nn.Direction.dLeftToRight){for(;n.Next.Pt.X<=i.X&&n.Next.Pt.X>=n.Pt.X&&n.Next.Pt.Y==i.Y;)n=n.Next;s&&n.Pt.X!=i.X&&(n=n.Next),r=this.DupOutPt(n,!s),nn.IntPoint.op_Inequality(r.Pt,i)&&(n=r,n.Pt.X=i.X,n.Pt.Y=i.Y,r=this.DupOutPt(n,!s))}else{for(;n.Next.Pt.X>=i.X&&n.Next.Pt.X<=n.Pt.X&&n.Next.Pt.Y==i.Y;)n=n.Next;s||n.Pt.X==i.X||(n=n.Next),r=this.DupOutPt(n,s),nn.IntPoint.op_Inequality(r.Pt,i)&&(n=r,n.Pt.X=i.X,n.Pt.Y=i.Y,r=this.DupOutPt(n,s))}return o==nn.Direction.dLeftToRight==s?(e.Prev=n,n.Next=e,t.Next=r,r.Prev=t):(e.Next=n,n.Prev=e,t.Prev=r,r.Next=t),!0},nn.Clipper.prototype.JoinPoints=function(e,t,n){var r=e.OutPt1,i=new nn.OutPt,s=e.OutPt2,o=new nn.OutPt,u=e.OutPt1.Pt.Y==e.OffPt.Y;if(u&&nn.IntPoint.op_Equality(e.OffPt,e.OutPt1.Pt)&&nn.IntPoint.op_Equality(e.OffPt,e.OutPt2.Pt)){for(i=e.OutPt1.Next;i!=r&&nn.IntPoint.op_Equality(i.Pt,e.OffPt);)i=i.Next;var a=i.Pt.Y>e.OffPt.Y;for(o=e.OutPt2.Next;o!=s&&nn.IntPoint.op_Equality(o.Pt,e.OffPt);)o=o.Next;var f=o.Pt.Y>e.OffPt.Y;return a==f?!1:a?(i=this.DupOutPt(r,!1),o=this.DupOutPt(s,!0),r.Prev=s,s.Next=r,i.Next=o,o.Prev=i,e.OutPt1=r,e.OutPt2=i,!0):(i=this.DupOutPt(r,!0),o=this.DupOutPt(s,!1),r.Next=s,s.Prev=r,i.Prev=o,o.Next=i,e.OutPt1=r,e.OutPt2=i,!0)}if(u){for(i=r;r.Prev.Pt.Y==r.Pt.Y&&r.Prev!=i&&r.Prev!=s;)r=r.Prev;for(;i.Next.Pt.Y==i.Pt.Y&&i.Next!=r&&i.Next!=s;)i=i.Next;if(i.Next==r||i.Next==s)return!1;for(o=s;s.Prev.Pt.Y==s.Pt.Y&&s.Prev!=o&&s.Prev!=i;)s=s.Prev;for(;o.Next.Pt.Y==o.Pt.Y&&o.Next!=s&&o.Next!=r;)o=o.Next;if(o.Next==s||o.Next==r)return!1;var l={Left:null,Right:null};if(!this.GetOverlap(r.Pt.X,i.Pt.X,s.Pt.X,o.Pt.X,l))return!1;var c,h=l.Left,p=l.Right,d=new nn.IntPoint;return r.Pt.X>=h&&r.Pt.X<=p?(d.X=r.Pt.X,d.Y=r.Pt.Y,c=r.Pt.X>i.Pt.X):s.Pt.X>=h&&s.Pt.X<=p?(d.X=s.Pt.X,d.Y=s.Pt.Y,c=s.Pt.X>o.Pt.X):i.Pt.X>=h&&i.Pt.X<=p?(d.X=i.Pt.X,d.Y=i.Pt.Y,c=i.Pt.X>r.Pt.X):(d.X=o.Pt.X,d.Y=o.Pt.Y,c=o.Pt.X>s.Pt.X),e.OutPt1=r,e.OutPt2=s,this.JoinHorz(r,i,s,o,d,c)}for(i=r.Next;nn.IntPoint.op_Equality(i.Pt,r.Pt)&&i!=r;)i=i.Next;var v=i.Pt.Y>r.Pt.Y||!nn.ClipperBase.SlopesEqual(r.Pt,i.Pt,e.OffPt,this.m_UseFullRange);if(v){for(i=r.Prev;nn.IntPoint.op_Equality(i.Pt,r.Pt)&&i!=r;)i=i.Prev;if(i.Pt.Y>r.Pt.Y||!nn.ClipperBase.SlopesEqual(r.Pt,i.Pt,e.OffPt,this.m_UseFullRange))return!1}for(o=s.Next;nn.IntPoint.op_Equality(o.Pt,s.Pt)&&o!=s;)o=o.Next;var m=o.Pt.Y>s.Pt.Y||!nn.ClipperBase.SlopesEqual(s.Pt,o.Pt,e.OffPt,this.m_UseFullRange);if(m){for(o=s.Prev;nn.IntPoint.op_Equality(o.Pt,s.Pt)&&o!=s;)o=o.Prev;if(o.Pt.Y>s.Pt.Y||!nn.ClipperBase.SlopesEqual(s.Pt,o.Pt,e.OffPt,this.m_UseFullRange))return!1}return i==r||o==s||i==o||t==n&&v==m?!1:v?(i=this.DupOutPt(r,!1),o=this.DupOutPt(s,!0),r.Prev=s,s.Next=r,i.Next=o,o.Prev=i,e.OutPt1=r,e.OutPt2=i,!0):(i=this.DupOutPt(r,!0),o=this.DupOutPt(s,!1),r.Next=s,s.Prev=r,i.Prev=o,o.Next=i,e.OutPt1=r,e.OutPt2=i,!0)},nn.Clipper.GetBounds=function(e){for(var t=0,n=e.length;n>t&&0==e[t].length;)t++;if(t==n)return new nn.IntRect(0,0,0,0);var r=new nn.IntRect;for(r.left=e[t][0].X,r.right=r.left,r.top=e[t][0].Y,r.bottom=r.top;n>t;t++)for(var i=0,s=e[t].length;s>i;i++)e[t][i].X<r.left?r.left=e[t][i].X:e[t][i].X>r.right&&(r.right=e[t][i].X),e[t][i].Y<r.top?r.top=e[t][i].Y:e[t][i].Y>r.bottom&&(r.bottom=e[t][i].Y);return r},nn.Clipper.prototype.GetBounds2=function(e){var t=e,n=new nn.IntRect;for(n.left=e.Pt.X,n.right=e.Pt.X,n.top=e.Pt.Y,n.bottom=e.Pt.Y,e=e.Next;e!=t;)e.Pt.X<n.left&&(n.left=e.Pt.X),e.Pt.X>n.right&&(n.right=e.Pt.X),e.Pt.Y<n.top&&(n.top=e.Pt.Y),e.Pt.Y>n.bottom&&(n.bottom=e.Pt.Y),e=e.Next;return n},nn.Clipper.PointInPolygon=function(e,t){var n=0,r=t.length;if(3>r)return 0;for(var i=t[0],s=1;r>=s;++s){var o=s==r?t[0]:t[s];if(o.Y==e.Y&&(o.X==e.X||i.Y==e.Y&&o.X>e.X==i.X<e.X))return-1;if(i.Y<e.Y!=o.Y<e.Y)if(i.X>=e.X)if(o.X>e.X)n=1-n;else{var u=(i.X-e.X)*(o.Y-e.Y)-(o.X-e.X)*(i.Y-e.Y);if(0==u)return-1;u>0==o.Y>i.Y&&(n=1-n)}else if(o.X>e.X){var u=(i.X-e.X)*(o.Y-e.Y)-(o.X-e.X)*(i.Y-e.Y);if(0==u)return-1;u>0==o.Y>i.Y&&(n=1-n)}i=o}return n},nn.Clipper.prototype.PointInPolygon=function(e,t){for(var n=0,r=t;;){var i=t.Pt.X,s=t.Pt.Y,o=t.Next.Pt.X,u=t.Next.Pt.Y;if(u==e.Y&&(o==e.X||s==e.Y&&o>e.X==i<e.X))return-1;if(s<e.Y!=u<e.Y)if(i>=e.X)if(o>e.X)n=1-n;else{var a=(i-e.X)*(u-e.Y)-(o-e.X)*(s-e.Y);if(0==a)return-1;a>0==u>s&&(n=1-n)}else if(o>e.X){var a=(i-e.X)*(u-e.Y)-(o-e.X)*(s-e.Y);if(0==a)return-1;a>0==u>s&&(n=1-n)}if(t=t.Next,r==t)break}return n},nn.Clipper.prototype.Poly2ContainsPoly1=function(e,t){var n=e;do{var r=this.PointInPolygon(n.Pt,t);if(r>=0)return 0!=r;n=n.Next}while(n!=e);return!0},nn.Clipper.prototype.FixupFirstLefts1=function(e,t){for(var n=0,r=this.m_PolyOuts.length;r>n;n++){var i=this.m_PolyOuts[n];null!==i.Pts&&i.FirstLeft==e&&this.Poly2ContainsPoly1(i.Pts,t.Pts)&&(i.FirstLeft=t)}},nn.Clipper.prototype.FixupFirstLefts2=function(e,t){for(var n=0,r=this.m_PolyOuts,i=r.length,s=r[n];i>n;n++,s=r[n])s.FirstLeft==e&&(s.FirstLeft=t)},nn.Clipper.ParseFirstLeft=function(e){for(;null!=e&&null==e.Pts;)e=e.FirstLeft;return e},nn.Clipper.prototype.JoinCommonEdges=function(){for(var e=0,t=this.m_Joins.length;t>e;e++){var n=this.m_Joins[e],r=this.GetOutRec(n.OutPt1.Idx),i=this.GetOutRec(n.OutPt2.Idx);if(null!=r.Pts&&null!=i.Pts){var s;if(s=r==i?r:this.Param1RightOfParam2(r,i)?i:this.Param1RightOfParam2(i,r)?r:this.GetLowermostRec(r,i),this.JoinPoints(n,r,i))if(r==i){if(r.Pts=n.OutPt1,r.BottomPt=null,i=this.CreateOutRec(),i.Pts=n.OutPt2,this.UpdateOutPtIdxs(i),this.m_UsingPolyTree)for(var o=0,u=this.m_PolyOuts.length;u-1>o;o++){var a=this.m_PolyOuts[o];null!=a.Pts&&nn.Clipper.ParseFirstLeft(a.FirstLeft)==r&&a.IsHole!=r.IsHole&&this.Poly2ContainsPoly1(a.Pts,n.OutPt2)&&(a.FirstLeft=i)}this.Poly2ContainsPoly1(i.Pts,r.Pts)?(i.IsHole=!r.IsHole,i.FirstLeft=r,this.m_UsingPolyTree&&this.FixupFirstLefts2(i,r),(i.IsHole^this.ReverseSolution)==this.Area(i)>0&&this.ReversePolyPtLinks(i.Pts)):this.Poly2ContainsPoly1(r.Pts,i.Pts)?(i.IsHole=r.IsHole,r.IsHole=!i.IsHole,i.FirstLeft=r.FirstLeft,r.FirstLeft=i,this.m_UsingPolyTree&&this.FixupFirstLefts2(r,i),(r.IsHole^this.ReverseSolution)==this.Area(r)>0&&this.ReversePolyPtLinks(r.Pts)):(i.IsHole=r.IsHole,i.FirstLeft=r.FirstLeft,this.m_UsingPolyTree&&this.FixupFirstLefts1(r,i))}else i.Pts=null,i.BottomPt=null,i.Idx=r.Idx,r.IsHole=s.IsHole,s==i&&(r.FirstLeft=i.FirstLeft),i.FirstLeft=r,this.m_UsingPolyTree&&this.FixupFirstLefts2(i,r)}}},nn.Clipper.prototype.UpdateOutPtIdxs=function(e){var t=e.Pts;do t.Idx=e.Idx,t=t.Prev;while(t!=e.Pts)},nn.Clipper.prototype.DoSimplePolygons=function(){for(var e=0;e<this.m_PolyOuts.length;){var t=this.m_PolyOuts[e++],n=t.Pts;if(null!==n)do{for(var r=n.Next;r!=t.Pts;){if(nn.IntPoint.op_Equality(n.Pt,r.Pt)&&r.Next!=n&&r.Prev!=n){var i=n.Prev,s=r.Prev;n.Prev=s,s.Next=n,r.Prev=i,i.Next=r,t.Pts=n;var o=this.CreateOutRec();o.Pts=r,this.UpdateOutPtIdxs(o),this.Poly2ContainsPoly1(o.Pts,t.Pts)?(o.IsHole=!t.IsHole,o.FirstLeft=t):this.Poly2ContainsPoly1(t.Pts,o.Pts)?(o.IsHole=t.IsHole,t.IsHole=!o.IsHole,o.FirstLeft=t.FirstLeft,t.FirstLeft=o):(o.IsHole=t.IsHole,o.FirstLeft=t.FirstLeft),r=n}r=r.Next}n=n.Next}while(n!=t.Pts)}},nn.Clipper.Area=function(e){var t=e.length;if(3>t)return 0;for(var n=0,r=0,i=t-1;t>r;++r)n+=(e[i].X+e[r].X)*(e[i].Y-e[r].Y),i=r;return.5*-n},nn.Clipper.prototype.Area=function(e){var t=e.Pts;if(null==t)return 0;var n=0;do n+=(t.Prev.Pt.X+t.Pt.X)*(t.Prev.Pt.Y-t.Pt.Y),t=t.Next;while(t!=e.Pts);return.5*n},tn&&(nn.Clipper.OffsetPaths=function(e,t,n,r,i){var s=new nn.Paths,o=new nn.ClipperOffset(i,i);return o.AddPaths(e,n,r),o.Execute(s,t),s}),nn.Clipper.SimplifyPolygon=function(e,t){var n=new Array,r=new nn.Clipper(0);return r.StrictlySimple=!0,r.AddPath(e,nn.PolyType.ptSubject,!0),r.Execute(nn.ClipType.ctUnion,n,t,t),n},nn.Clipper.SimplifyPolygons=function(e,t){"undefined"==typeof t&&(t=nn.PolyFillType.pftEvenOdd);var n=new Array,r=new nn.Clipper(0);return r.StrictlySimple=!0,r.AddPaths(e,nn.PolyType.ptSubject,!0),r.Execute(nn.ClipType.ctUnion,n,t,t),n},nn.Clipper.DistanceSqrd=function(e,t){var n=e.X-t.X,r=e.Y-t.Y;return n*n+r*r},nn.Clipper.DistanceFromLineSqrd=function(e,t,n){var r=t.Y-n.Y,i=n.X-t.X,s=r*t.X+i*t.Y;return s=r*e.X+i*e.Y-s,s*s/(r*r+i*i)},nn.Clipper.SlopesNearCollinear=function(e,t,n,r){return nn.Clipper.DistanceFromLineSqrd(t,e,n)<r},nn.Clipper.PointsAreClose=function(e,t,n){var r=e.X-t.X,i=e.Y-t.Y;return n>=r*r+i*i},nn.Clipper.ExcludeOp=function(e){var t=e.Prev;return t.Next=e.Next,e.Next.Prev=t,t.Idx=0,t},nn.Clipper.CleanPolygon=function(e,t){"undefined"==typeof t&&(t=1.415);var n=e.length;if(0==n)return new Array;for(var r=new Array(n),i=0;n>i;++i)r[i]=new nn.OutPt;for(var i=0;n>i;++i)r[i].Pt=e[i],r[i].Next=r[(i+1)%n],r[i].Next.Prev=r[i],r[i].Idx=0;for(var s=t*t,o=r[0];0==o.Idx&&o.Next!=o.Prev;)nn.Clipper.PointsAreClose(o.Pt,o.Prev.Pt,s)?(o=nn.Clipper.ExcludeOp(o),n--):nn.Clipper.PointsAreClose(o.Prev.Pt,o.Next.Pt,s)?(nn.Clipper.ExcludeOp(o.Next),o=nn.Clipper.ExcludeOp(o),n-=2):nn.Clipper.SlopesNearCollinear(o.Prev.Pt,o.Pt,o.Next.Pt,s)?(o=nn.Clipper.ExcludeOp(o),n--):(o.Idx=1,o=o.Next);3>n&&(n=0);for(var u=new Array(n),i=0;n>i;++i)u[i]=new nn.IntPoint(o.Pt),o=o.Next;return r=null,u},nn.Clipper.CleanPolygons=function(e,t){for(var n=new Array(e.length),r=0,i=e.length;i>r;r++)n[r]=nn.Clipper.CleanPolygon(e[r],t);return n},nn.Clipper.Minkowski=function(e,t,n,r){var i=r?1:0,s=e.length,o=t.length,u=new Array;if(n)for(var a=0;o>a;a++){for(var f=new Array(s),l=0,c=e.length,h=e[l];c>l;l++,h=e[l])f[l]=new nn.IntPoint(t[a].X+h.X,t[a].Y+h.Y);u.push(f)}else for(var a=0;o>a;a++){for(var f=new Array(s),l=0,c=e.length,h=e[l];c>l;l++,h=e[l])f[l]=new nn.IntPoint(t[a].X-h.X,t[a].Y-h.Y);u.push(f)}for(var p=new Array,a=0;o-1+i>a;a++)for(var l=0;s>l;l++){var d=new Array;d.push(u[a%o][l%s]),d.push(u[(a+1)%o][l%s]),d.push(u[(a+1)%o][(l+1)%s]),d.push(u[a%o][(l+1)%s]),nn.Clipper.Orientation(d)||d.reverse(),p.push(d)}var v=new nn.Clipper(0);return v.AddPaths(p,nn.PolyType.ptSubject,!0),v.Execute(nn.ClipType.ctUnion,u,nn.PolyFillType.pftNonZero,nn.PolyFillType.pftNonZero),u},nn.Clipper.MinkowskiSum=function(){var e=arguments,t=e.length;if(3==t){var n=e[0],r=e[1],i=e[2];return nn.Clipper.Minkowski(n,r,!0,i)}if(4==t){for(var s,n=e[0],o=e[1],u=e[2],i=e[3],a=new nn.Clipper,f=0,l=o.length;l>f;++f){var s=nn.Clipper.Minkowski(n,o[f],!0,i);a.AddPaths(s,nn.PolyType.ptSubject,!0)}i&&a.AddPaths(o,nn.PolyType.ptClip,!0);var c=new nn.Paths;return a.Execute(nn.ClipType.ctUnion,c,u,u),c}},nn.Clipper.MinkowskiDiff=function(e,t,n){return nn.Clipper.Minkowski(e,t,!1,n)},nn.Clipper.PolyTreeToPaths=function(e){var t=new Array;return nn.Clipper.AddPolyNodeToPaths(e,nn.Clipper.NodeType.ntAny,t),t},nn.Clipper.AddPolyNodeToPaths=function(e,t,n){var r=!0;switch(t){case nn.Clipper.NodeType.ntOpen:return;case nn.Clipper.NodeType.ntClosed:r=!e.IsOpen}e.m_polygon.length>0&&r&&n.push(e.m_polygon);for(var i=0,s=e.Childs(),o=s.length,u=s[i];o>i;i++,u=s[i])nn.Clipper.AddPolyNodeToPaths(u,t,n)},nn.Clipper.OpenPathsFromPolyTree=function(e){for(var t=new nn.Paths,n=0,r=e.ChildCount();r>n;n++)e.Childs()[n].IsOpen&&t.push(e.Childs()[n].m_polygon);return t},nn.Clipper.ClosedPathsFromPolyTree=function(e){var t=new nn.Paths;return nn.Clipper.AddPolyNodeToPaths(e,nn.Clipper.NodeType.ntClosed,t),t},bn(nn.Clipper,nn.ClipperBase),nn.Clipper.NodeType={ntAny:0,ntOpen:1,ntClosed:2},nn.ClipperOffset=function(e,t){"undefined"==typeof e&&(e=2),"undefined"==typeof t&&(t=nn.ClipperOffset.def_arc_tolerance),this.m_destPolys=new nn.Paths,this.m_srcPoly=new nn.Path,this.m_destPoly=new nn.Path,this.m_normals=new Array,this.m_delta=0,this.m_sinA=0,this.m_sin=0,this.m_cos=0,this.m_miterLim=0,this.m_StepsPerRad=0,this.m_lowest=new nn.IntPoint,this.m_polyNodes=new nn.PolyNode,this.MiterLimit=e,this.ArcTolerance=t,this.m_lowest.X=-1},nn.ClipperOffset.two_pi=6.28318530717959,nn.ClipperOffset.def_arc_tolerance=.25,nn.ClipperOffset.prototype.Clear=function(){nn.Clear(this.m_polyNodes.Childs()),this.m_lowest.X=-1},nn.ClipperOffset.Round=nn.Clipper.Round,nn.ClipperOffset.prototype.AddPath=function(e,t,n){var r=e.length-1;if(!(0>r)){var i=new nn.PolyNode;if(i.m_jointype=t,i.m_endtype=n,n==nn.EndType.etClosedLine||n==nn.EndType.etClosedPolygon)for(;r>0&&nn.IntPoint.op_Equality(e[0],e[r]);)r--;i.m_polygon.push(e[0]);for(var s=0,o=0,u=1;r>=u;u++)nn.IntPoint.op_Inequality(i.m_polygon[s],e[u])&&(s++,i.m_polygon.push(e[u]),(e[u].Y>i.m_polygon[o].Y||e[u].Y==i.m_polygon[o].Y&&e[u].X<i.m_polygon[o].X)&&(o=s));if(!(n==nn.EndType.etClosedPolygon&&2>s||n!=nn.EndType.etClosedPolygon&&0>s)&&(this.m_polyNodes.AddChild(i),n==nn.EndType.etClosedPolygon))if(this.m_lowest.X<0)this.m_lowest=new nn.IntPoint(0,o);else{var a=this.m_polyNodes.Childs()[this.m_lowest.X].m_polygon[this.m_lowest.Y];(i.m_polygon[o].Y>a.Y||i.m_polygon[o].Y==a.Y&&i.m_polygon[o].X<a.X)&&(this.m_lowest=new nn.IntPoint(this.m_polyNodes.ChildCount()-1,o))}}},nn.ClipperOffset.prototype.AddPaths=function(e,t,n){for(var r=0,i=e.length;i>r;r++)this.AddPath(e[r],t,n)},nn.ClipperOffset.prototype.FixOrientations=function(){if(this.m_lowest.X>=0&&!nn.Clipper.Orientation(this.m_polyNodes.Childs()[this.m_lowest.X].m_polygon))for(var e=0;e<this.m_polyNodes.ChildCount();e++){var t=this.m_polyNodes.Childs()[e];(t.m_endtype==nn.EndType.etClosedPolygon||t.m_endtype==nn.EndType.etClosedLine&&nn.Clipper.Orientation(t.m_polygon))&&t.m_polygon.reverse()}else for(var e=0;e<this.m_polyNodes.ChildCount();e++){var t=this.m_polyNodes.Childs()[e];t.m_endtype!=nn.EndType.etClosedLine||nn.Clipper.Orientation(t.m_polygon)||t.m_polygon.reverse()}},nn.ClipperOffset.GetUnitNormal=function(e,t){var n=t.X-e.X,r=t.Y-e.Y;if(0==n&&0==r)return new nn.DoublePoint(0,0);var i=1/Math.sqrt(n*n+r*r);return n*=i,r*=i,new nn.DoublePoint(r,-n)},nn.ClipperOffset.prototype.DoOffset=function(e){if(this.m_destPolys=new Array,this.m_delta=e,nn.ClipperBase.near_zero(e))for(var t=0;t<this.m_polyNodes.ChildCount();t++){var n=this.m_polyNodes.Childs()[t];n.m_endtype==nn.EndType.etClosedPolygon&&this.m_destPolys.push(n.m_polygon)}else{this.m_miterLim=this.MiterLimit>2?2/(this.MiterLimit*this.MiterLimit):.5;var r;r=this.ArcTolerance<=0?nn.ClipperOffset.def_arc_tolerance:this.ArcTolerance>Math.abs(e)*nn.ClipperOffset.def_arc_tolerance?Math.abs(e)*nn.ClipperOffset.def_arc_tolerance:this.ArcTolerance;var i=3.14159265358979/Math.acos(1-r/Math.abs(e));this.m_sin=Math.sin(nn.ClipperOffset.two_pi/i),this.m_cos=Math.cos(nn.ClipperOffset.two_pi/i),this.m_StepsPerRad=i/nn.ClipperOffset.two_pi,0>e&&(this.m_sin=-this.m_sin);for(var t=0;t<this.m_polyNodes.ChildCount();t++){var n=this.m_polyNodes.Childs()[t];this.m_srcPoly=n.m_polygon;var s=this.m_srcPoly.length;if(!(0==s||0>=e&&(3>s||n.m_endtype!=nn.EndType.etClosedPolygon)))if(this.m_destPoly=new Array,1!=s){this.m_normals.length=0;for(var o=0;s-1>o;o++)this.m_normals.push(nn.ClipperOffset.GetUnitNormal(this.m_srcPoly[o],this.m_srcPoly[o+1]));if(n.m_endtype==nn.EndType.etClosedLine||n.m_endtype==nn.EndType.etClosedPolygon?this.m_normals.push(nn.ClipperOffset.GetUnitNormal(this.m_srcPoly[s-1],this.m_srcPoly[0])):this.m_normals.push(new nn.DoublePoint(this.m_normals[s-2])),n.m_endtype==nn.EndType.etClosedPolygon){for(var u=s-1,o=0;s>o;o++)u=this.OffsetPoint(o,u,n.m_jointype);this.m_destPolys.push(this.m_destPoly)}else if(n.m_endtype==nn.EndType.etClosedLine){for(var u=s-1,o=0;s>o;o++)u=this.OffsetPoint(o,u,n.m_jointype);this.m_destPolys.push(this.m_destPoly),this.m_destPoly=new Array;for(var a=this.m_normals[s-1],o=s-1;o>0;o--)this.m_normals[o]=new nn.DoublePoint(-this.m_normals[o-1].X,-this.m_normals[o-1].Y);this.m_normals[0]=new nn.DoublePoint(-a.X,-a.Y),u=0;for(var o=s-1;o>=0;o--)u=this.OffsetPoint(o,u,n.m_jointype);this.m_destPolys.push(this.m_destPoly)}else{for(var u=0,o=1;s-1>o;++o)u=this.OffsetPoint(o,u,n.m_jointype);var f;if(n.m_endtype==nn.EndType.etOpenButt){var o=s-1;f=new nn.IntPoint(nn.ClipperOffset.Round(this.m_srcPoly[o].X+this.m_normals[o].X*e),nn.ClipperOffset.Round(this.m_srcPoly[o].Y+this.m_normals[o].Y*e)),this.m_destPoly.push(f),f=new nn.IntPoint(nn.ClipperOffset.Round(this.m_srcPoly[o].X-this.m_normals[o].X*e),nn.ClipperOffset.Round(this.m_srcPoly[o].Y-this.m_normals[o].Y*e)),this.m_destPoly.push(f)}else{var o=s-1;u=s-2,this.m_sinA=0,this.m_normals[o]=new nn.DoublePoint(-this.m_normals[o].X,-this.m_normals[o].Y),n.m_endtype==nn.EndType.etOpenSquare?this.DoSquare(o,u):this.DoRound(o,u)}for(var o=s-1;o>0;o--)this.m_normals[o]=new nn.DoublePoint(-this.m_normals[o-1].X,-this.m_normals[o-1].Y);this.m_normals[0]=new nn.DoublePoint(-this.m_normals[1].X,-this.m_normals[1].Y),u=s-1;for(var o=u-1;o>0;--o)u=this.OffsetPoint(o,u,n.m_jointype);n.m_endtype==nn.EndType.etOpenButt?(f=new nn.IntPoint(nn.ClipperOffset.Round(this.m_srcPoly[0].X-this.m_normals[0].X*e),nn.ClipperOffset.Round(this.m_srcPoly[0].Y-this.m_normals[0].Y*e)),this.m_destPoly.push(f),f=new nn.IntPoint(nn.ClipperOffset.Round(this.m_srcPoly[0].X+this.m_normals[0].X*e),nn.ClipperOffset.Round(this.m_srcPoly[0].Y+this.m_normals[0].Y*e)),this.m_destPoly.push(f)):(u=1,this.m_sinA=0,n.m_endtype==nn.EndType.etOpenSquare?this.DoSquare(0,1):this.DoRound(0,1)),this.m_destPolys.push(this.m_destPoly)}}else{if(n.m_jointype==nn.JoinType.jtRound)for(var l=1,c=0,o=1;i>=o;o++){this.m_destPoly.push(new nn.IntPoint(nn.ClipperOffset.Round(this.m_srcPoly[0].X+l*e),nn.ClipperOffset.Round(this.m_srcPoly[0].Y+c*e)));var h=l;l=l*this.m_cos-this.m_sin*c,c=h*this.m_sin+c*this.m_cos}else for(var l=-1,c=-1,o=0;4>o;++o)this.m_destPoly.push(new nn.IntPoint(nn.ClipperOffset.Round(this.m_srcPoly[0].X+l*e),nn.ClipperOffset.Round(this.m_srcPoly[0].Y+c*e))),0>l?l=1:0>c?c=1:l=-1;this.m_destPolys.push(this.m_destPoly)}}}},nn.ClipperOffset.prototype.Execute=function(){var e=arguments,t=e[0]instanceof nn.PolyTree;if(t){var n=e[0],r=e[1];n.Clear(),this.FixOrientations(),this.DoOffset(r);var i=new nn.Clipper(0);if(i.AddPaths(this.m_destPolys,nn.PolyType.ptSubject,!0),r>0)i.Execute(nn.ClipType.ctUnion,n,nn.PolyFillType.pftPositive,nn.PolyFillType.pftPositive);else{var s=nn.Clipper.GetBounds(this.m_destPolys),o=new nn.Path;if(o.push(new nn.IntPoint(s.left-10,s.bottom+10)),o.push(new nn.IntPoint(s.right+10,s.bottom+10)),o.push(new nn.IntPoint(s.right+10,s.top-10)),o.push(new nn.IntPoint(s.left-10,s.top-10)),i.AddPath(o,nn.PolyType.ptSubject,!0),i.ReverseSolution=!0,i.Execute(nn.ClipType.ctUnion,n,nn.PolyFillType.pftNegative,nn.PolyFillType.pftNegative),1==n.ChildCount()&&n.Childs()[0].ChildCount()>0){var u=n.Childs()[0];n.Childs()[0]=u.Childs()[0];for(var a=1;a<u.ChildCount();a++)n.AddChild(u.Childs()[a])}else n.Clear()}}else{var n=e[0],r=e[1];nn.Clear(n),this.FixOrientations(),this.DoOffset(r);var i=new nn.Clipper(0);if(i.AddPaths(this.m_destPolys,nn.PolyType.ptSubject,!0),r>0)i.Execute(nn.ClipType.ctUnion,n,nn.PolyFillType.pftPositive,nn.PolyFillType.pftPositive);else{var s=nn.Clipper.GetBounds(this.m_destPolys),o=new nn.Path;o.push(new nn.IntPoint(s.left-10,s.bottom+10)),o.push(new nn.IntPoint(s.right+10,s.bottom+10)),o.push(new nn.IntPoint(s.right+10,s.top-10)),o.push(new nn.IntPoint(s.left-10,s.top-10)),i.AddPath(o,nn.PolyType.ptSubject,!0),i.ReverseSolution=!0,i.Execute(nn.ClipType.ctUnion,n,nn.PolyFillType.pftNegative,nn.PolyFillType.pftNegative),n.length>0&&n.splice(0,1)}}},nn.ClipperOffset.prototype.OffsetPoint=function(e,t,n){if(this.m_sinA=this.m_normals[t].X*this.m_normals[e].Y-this.m_normals[e].X*this.m_normals[t].Y,this.m_sinA<5e-5&&this.m_sinA>-0.00005)return t;if(this.m_sinA>1?this.m_sinA=1:this.m_sinA<-1&&(this.m_sinA=-1),this.m_sinA*this.m_delta<0)this.m_destPoly.push(new nn.IntPoint(nn.ClipperOffset.Round(this.m_srcPoly[e].X+this.m_normals[t].X*this.m_delta),nn.ClipperOffset.Round(this.m_srcPoly[e].Y+this.m_normals[t].Y*this.m_delta))),this.m_destPoly.push(new nn.IntPoint(this.m_srcPoly[e])),this.m_destPoly.push(new nn.IntPoint(nn.ClipperOffset.Round(this.m_srcPoly[e].X+this.m_normals[e].X*this.m_delta),nn.ClipperOffset.Round(this.m_srcPoly[e].Y+this.m_normals[e].Y*this.m_delta)));else switch(n){case nn.JoinType.jtMiter:var r=1+(this.m_normals[e].X*this.m_normals[t].X+this.m_normals[e].Y*this.m_normals[t].Y);r>=this.m_miterLim?this.DoMiter(e,t,r):this.DoSquare(e,t);break;case nn.JoinType.jtSquare:this.DoSquare(e,t);break;case nn.JoinType.jtRound:this.DoRound(e,t)}return t=e},nn.ClipperOffset.prototype.DoSquare=function(e,t){var n=Math.tan(Math.atan2(this.m_sinA,this.m_normals[t].X*this.m_normals[e].X+this.m_normals[t].Y*this.m_normals[e].Y)/4);this.m_destPoly.push(new nn.IntPoint(nn.ClipperOffset.Round(this.m_srcPoly[e].X+this.m_delta*(this.m_normals[t].X-this.m_normals[t].Y*n)),nn.ClipperOffset.Round(this.m_srcPoly[e].Y+this.m_delta*(this.m_normals[t].Y+this.m_normals[t].X*n)))),this.m_destPoly.push(new nn.IntPoint(nn.ClipperOffset.Round(this.m_srcPoly[e].X+this.m_delta*(this.m_normals[e].X+this.m_normals[e].Y*n)),nn.ClipperOffset.Round(this.m_srcPoly[e].Y+this.m_delta*(this.m_normals[e].Y-this.m_normals[e].X*n))))},nn.ClipperOffset.prototype.DoMiter=function(e,t,n){var r=this.m_delta/n;this.m_destPoly.push(new nn.IntPoint(nn.ClipperOffset.Round(this.m_srcPoly[e].X+(this.m_normals[t].X+this.m_normals[e].X)*r),nn.ClipperOffset.Round(this.m_srcPoly[e].Y+(this.m_normals[t].Y+this.m_normals[e].Y)*r)))},nn.ClipperOffset.prototype.DoRound=function(e,t){for(var n,r=Math.atan2(this.m_sinA,this.m_normals[t].X*this.m_normals[e].X+this.m_normals[t].Y*this.m_normals[e].Y),i=nn.Cast_Int32(nn.ClipperOffset.Round(this.m_StepsPerRad*Math.abs(r))),s=this.m_normals[t].X,o=this.m_normals[t].Y,u=0;i>u;++u)this.m_destPoly.push(new nn.IntPoint(nn.ClipperOffset.Round(this.m_srcPoly[e].X+s*this.m_delta),nn.ClipperOffset.Round(this.m_srcPoly[e].Y+o*this.m_delta))),n=s,s=s*this.m_cos-this.m_sin*o,o=n*this.m_sin+o*this.m_cos;this.m_destPoly.push(new nn.IntPoint(nn.ClipperOffset.Round(this.m_srcPoly[e].X+this.m_normals[e].X*this.m_delta),nn.ClipperOffset.Round(this.m_srcPoly[e].Y+this.m_normals[e].Y*this.m_delta)))},nn.Error=function(e){try{throw new Error(e)}catch(t){alert(t.message)}},nn.JS={},nn.JS.AreaOfPolygon=function(e,t){return t||(t=1),nn.Clipper.Area(e)/(t*t)},nn.JS.AreaOfPolygons=function(e,t){t||(t=1);for(var n=0,r=0;r<e.length;r++)n+=nn.Clipper.Area(e[r]);return n/(t*t)},nn.JS.BoundsOfPath=function(e,t){return nn.JS.BoundsOfPaths([e],t)},nn.JS.BoundsOfPaths=function(e,t){t||(t=1);var n=nn.Clipper.GetBounds(e);return n.left/=t,n.bottom/=t,n.right/=t,n.top/=t,n},nn.JS.Clean=function(e,t){if(e instanceof Array){var n=e[0]instanceof Array,e=nn.JS.Clone(e);if("number"!=typeof t||null===t)return nn.Error("Delta is not a number in Clean()."),e;if(0===e.length||1==e.length&&0===e[0].length||0>t)return e;n||(e=[e]);for(var r,i,s,o,u,a,f,l=e.length,c=[],h=0;l>h;h++)if(i=e[h],r=i.length,0!==r)if(3>r)s=i,c.push(s);else{for(s=i,o=t*t,u=i[0],a=1,f=1;r>f;f++)(i[f].X-u.X)*(i[f].X-u.X)+(i[f].Y-u.Y)*(i[f].Y-u.Y)<=o||(s[a]=i[f],u=i[f],a++);u=i[a-1],(i[0].X-u.X)*(i[0].X-u.X)+(i[0].Y-u.Y)*(i[0].Y-u.Y)<=o&&a--,r>a&&s.splice(a,r-a),s.length&&c.push(s)}return!n&&c.length?c=c[0]:n||0!==c.length?n&&0===c.length&&(c=[[]]):c=[],c}return[]},nn.JS.Clone=function(e){if(e instanceof Array){if(0===e.length)return[];if(1==e.length&&0===e[0].length)return[[]];var t=e[0]instanceof Array;t||(e=[e]);var n,r,i,s,o=e.length,u=new Array(o);for(r=0;o>r;r++){for(n=e[r].length,s=new Array(n),i=0;n>i;i++)s[i]={X:e[r][i].X,Y:e[r][i].Y};u[r]=s}return t||(u=u[0]),u}return[]},nn.JS.Lighten=function(e,t){if(e instanceof Array){if("number"!=typeof t||null===t)return nn.Error("Tolerance is not a number in Lighten()."),nn.JS.Clone(e);if(0===e.length||1==e.length&&0===e[0].length||0>t)return nn.JS.Clone(e);e[0]instanceof Array||(e=[e]);var n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b=e.length,w=t*t,E=[];for(n=0;b>n;n++)if(i=e[n],u=i.length,0!=u){for(s=0;1e6>s;s++){for(o=[],u=i.length,i[u-1].X!=i[0].X||i[u-1].Y!=i[0].Y?(p=1,i.push({X:i[0].X,Y:i[0].Y}),u=i.length):p=0,h=[],r=0;u-2>r;r++)a=i[r],l=i[r+1],f=i[r+2],g=a.X,y=a.Y,d=f.X-g,v=f.Y-y,(0!==d||0!==v)&&(m=((l.X-g)*d+(l.Y-y)*v)/(d*d+v*v),m>1?(g=f.X,y=f.Y):m>0&&(g+=d*m,y+=v*m)),d=l.X-g,v=l.Y-y,c=d*d+v*v,w>=c&&(h[r+1]=1,r++);for(o.push({X:i[0].X,Y:i[0].Y}),r=1;u-1>r;r++)h[r]||o.push({X:i[r].X,Y:i[r].Y});if(o.push({X:i[u-1].X,Y:i[u-1].Y}),p&&i.pop(),!h.length)break;i=o}u=o.length,o[u-1].X==o[0].X&&o[u-1].Y==o[0].Y&&o.pop(),o.length>2&&E.push(o)}return!e[0]instanceof Array&&(E=E[0]),"undefined"==typeof E&&(E=[[]]),E}return[]},nn.JS.PerimeterOfPath=function(e,t,n){if("undefined"==typeof e)return 0;var r,i,s=Math.sqrt,o=0,u=0,a=0,f=0,l=0,c=e.length;if(2>c)return 0;for(t&&(e[c]=e[0],c++);--c;)r=e[c],u=r.X,a=r.Y,i=e[c-1],f=i.X,l=i.Y,o+=s((u-f)*(u-f)+(a-l)*(a-l));return t&&e.pop(),o/n},nn.JS.PerimeterOfPaths=function(e,t,n){n||(n=1);for(var r=0,i=0;i<e.length;i++)r+=nn.JS.PerimeterOfPath(e[i],t,n);return r},nn.JS.ScaleDownPath=function(e,t){var n,r;for(t||(t=1),n=e.length;n--;)r=e[n],r.X=r.X/t,r.Y=r.Y/t},nn.JS.ScaleDownPaths=function(e,t){var n,r,i;for(Math.round,t||(t=1),n=e.length;n--;)for(r=e[n].length;r--;)i=e[n][r],i.X=i.X/t,i.Y=i.Y/t},nn.JS.ScaleUpPath=function(e,t){var n,r,i=Math.round;for(t||(t=1),n=e.length;n--;)r=e[n],r.X=i(r.X*t),r.Y=i(r.Y*t)},nn.JS.ScaleUpPaths=function(e,t){var n,r,i,s=Math.round;for(t||(t=1),n=e.length;n--;)for(r=e[n].length;r--;)i=e[n][r],i.X=s(i.X*t),i.Y=s(i.Y*t)},nn.ExPolygons=function(){return[]},nn.ExPolygon=function(){this.outer=null,this.holes=null},nn.JS.AddOuterPolyNodeToExPolygons=function(e,t){var n=new nn.ExPolygon;n.outer=e.Contour();var r=e.Childs(),i=r.length;n.holes=new Array(i);var s,o,u,a,f,l;for(u=0;i>u;u++)for(s=r[u],n.holes[u]=s.Contour(),a=0,f=s.Childs(),l=f.length;l>a;a++)o=f[a],nn.JS.AddOuterPolyNodeToExPolygons(o,t);t.push(n)},nn.JS.ExPolygonsToPaths=function(e){var t,n,r,i,s=new nn.Paths;for(t=0,r=e.length;r>t;t++)for(s.push(e[t].outer),n=0,i=e[t].holes.length;i>n;n++)s.push(e[t].holes[n]);return s},nn.JS.PolyTreeToExPolygons=function(e){var t,n,r,i,s=new nn.ExPolygons;for(n=0,r=e.Childs(),i=r.length;i>n;n++)t=r[n],nn.JS.AddOuterPolyNodeToExPolygons(t,s);return s},nn}),r("lib/text",["module"],function(e){var t,r,i,s,o,u=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],a=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,f=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,l=typeof location!="undefined"&&location.href,c=l&&location.protocol&&location.protocol.replace(/\:/,""),h=l&&location.hostname,p=l&&(location.port||undefined),d={},v=e.config&&e.config()||{};t={version:"2.0.12",strip:function(e){if(e){e=e.replace(a,"");var t=e.match(f);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:v.createXhr||function(){var e,t,n;if(typeof XMLHttpRequest!="undefined")return new XMLHttpRequest;if(typeof ActiveXObject!="undefined")for(t=0;t<3;t+=1){n=u[t];try{e=new ActiveXObject(n)}catch(r){}if(e){u=[n];break}}return e},parseName:function(e){var t,n,r,i=!1,s=e.indexOf("."),o=e.indexOf("./")===0||e.indexOf("../")===0;return s!==-1&&(!o||s>1)?(t=e.substring(0,s),n=e.substring(s+1,e.length)):t=e,r=n||t,s=r.indexOf("!"),s!==-1&&(i=r.substring(s+1)==="strip",r=r.substring(0,s),n?n=r:t=r),{moduleName:t,ext:n,strip:i}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,n,r,i){var s,o,u,a=t.xdRegExp.exec(e);return a?(s=a[2],o=a[3],o=o.split(":"),u=o[1],o=o[0],(!s||s===n)&&(!o||o.toLowerCase()===r.toLowerCase())&&(!u&&!o||u===i)):!0},finishLoad:function(e,n,r,i){r=n?t.strip(r):r,v.isBuild&&(d[e]=r),i(r)},load:function(e,n,r,i){if(i&&i.isBuild&&!i.inlineText){r();return}v.isBuild=i&&i.isBuild;var s=t.parseName(e),o=s.moduleName+(s.ext?"."+s.ext:""),u=n.toUrl(o),a=v.useXhr||t.useXhr;if(u.indexOf("empty:")===0){r();return}!l||a(u,c,h,p)?t.get(u,function(n){t.finishLoad(e,s.strip,n,r)},function(e){r.error&&r.error(e)}):n([o],function(e){t.finishLoad(s.moduleName+"."+s.ext,s.strip,e,r)})},write:function(e,n,r,i){if(d.hasOwnProperty(n)){var s=t.jsEscape(d[n]);r.asModule(e+"!"+n,"define(function () { return '"+s+"';});\n")}},writeFile:function(e,n,r,i,s){var o=t.parseName(n),u=o.ext?"."+o.ext:"",a=o.moduleName+u,f=r.toUrl(o.moduleName+u)+".js";t.load(a,r,function(n){var r=function(e){return i(f,e)};r.asModule=function(e,t){return i.asModule(e,f,t)},t.write(e,a,r,s)},s)}};if(v.env==="node"||!v.env&&typeof process!="undefined"&&process.versions&&!!process.versions.node&&!process.versions["node-webkit"])r=n.nodeRequire("fs"),t.get=function(e,t,n){try{var i=r.readFileSync(e,"utf8");i.indexOf("﻿")===0&&(i=i.substring(1)),t(i)}catch(s){n&&n(s)}};else if(v.env==="xhr"||!v.env&&t.createXhr())t.get=function(e,n,r,i){var s=t.createXhr(),o;s.open("GET",e,!0);if(i)for(o in i)i.hasOwnProperty(o)&&s.setRequestHeader(o.toLowerCase(),i[o]);v.onXhr&&v.onXhr(s,e),s.onreadystatechange=function(t){var i,o;s.readyState===4&&(i=s.status||0,i>399&&i<600?(o=new Error(e+" HTTP status: "+i),o.xhr=s,r&&r(o)):n(s.responseText),v.onXhrComplete&&v.onXhrComplete(s,e))},s.send(null)};else if(v.env==="rhino"||!v.env&&typeof Packages!="undefined"&&typeof java!="undefined")t.get=function(e,t){var n,r,i="utf-8",s=new java.io.File(e),o=java.lang.System.getProperty("line.separator"),u=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(s),i)),a="";try{n=new java.lang.StringBuffer,r=u.readLine(),r&&r.length()&&r.charAt(0)===65279&&(r=r.substring(1)),r!==null&&n.append(r);while((r=u.readLine())!==null)n.append(o),n.append(r);a=String(n.toString())}finally{u.close()}t(a)};else if(v.env==="xpconnect"||!v.env&&typeof Components!="undefined"&&Components.classes&&Components.interfaces)i=Components.classes,s=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),o="@mozilla.org/windows-registry-key;1"in i,t.get=function(e,t){var n,r,u,a={};o&&(e=e.replace(/\//g,"\\")),u=new FileUtils.File(e);try{n=i["@mozilla.org/network/file-input-stream;1"].createInstance(s.nsIFileInputStream),n.init(u,1,0,!1),r=i["@mozilla.org/intl/converter-input-stream;1"].createInstance(s.nsIConverterInputStream),r.init(n,"utf-8",n.available(),s.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),r.readString(n.available(),a),r.close(),n.close(),t(a.value)}catch(f){throw new Error((u&&u.path||"")+": "+f)}};return t}),r("worker",["./lib/text"],function(e){function t(t,r){typeof r=="undefined"&&(r="");if(typeof Promise=="undefined")return;return new Promise(function(i,s){if(!window.Worker){s(Error("Web workers not available."));return}e.get(t,function(e){try{var t=n(r+e);i(t)}catch(o){s(Error("Syntax error in worker."))}})})}function n(e){var t=new Blob([e],{type:"application/javascript"}),n=new Worker(URL.createObjectURL(t));return n}function r(e,t){var n="",r=!1;t.config.requirejsUrl&&(r=e.toUrl(t.config.requirejsUrl));var i=!1;return t.config.baseUrl&&(i=e.toUrl(t.config.baseUrl)),r&&(n=n+"importScripts('"+r+"');"),i&&(n=n+"require.config({"+"baseUrl: '"+i+"'"+"});"),n}return{version:"1.0.0",load:function(e,n,i,s){if(s.isBuild){i();return}var o=n.toUrl(e),u=r(n,s);i(t(o,u));return},pluginBuilder:"workerBuilder"}}),r("worker!aStarWorker.js",[],function(){var e=function(t){var n=new Blob([t],{type:"application/javascript"}),r=new Worker(URL.createObjectURL(n));return r},t=function(n){return new Promise(function(t,r){if(!window.Worker){r(Error("Web workers not available."));return}try{var i=e(n);t(i)}catch(s){r(Error("Syntax error in worker."))}})};return t('/**\n * @license almond 0.3.0 Copyright (c) 2011-2014, The Dojo Foundation All Rights Reserved.\n * Available via the MIT or new BSD license.\n * see: http://github.com/jrburke/almond for details\n */\r\n\r\n/*! poly2tri v1.3.5 | (c) 2009-2014 Poly2Tri Contributors */\r\n\r\n(function(){var t,n,r;(function(e){function v(e,t){return h.call(e,t)}function m(e,t){var n,r,i,s,o,u,a,f,c,h,p,v=t&&t.split("/"),m=l.map,g=m&&m["*"]||{};if(e&&e.charAt(0)===".")if(t){v=v.slice(0,v.length-1),e=e.split("/"),o=e.length-1,l.nodeIdCompat&&d.test(e[o])&&(e[o]=e[o].replace(d,"")),e=v.concat(e);for(c=0;c<e.length;c+=1){p=e[c];if(p===".")e.splice(c,1),c-=1;else if(p===".."){if(c===1&&(e[2]===".."||e[0]===".."))break;c>0&&(e.splice(c-1,2),c-=2)}}e=e.join("/")}else e.indexOf("./")===0&&(e=e.substring(2));if((v||g)&&m){n=e.split("/");for(c=n.length;c>0;c-=1){r=n.slice(0,c).join("/");if(v)for(h=v.length;h>0;h-=1){i=m[v.slice(0,h).join("/")];if(i){i=i[r];if(i){s=i,u=c;break}}}if(s)break;!a&&g&&g[r]&&(a=g[r],f=c)}!s&&a&&(s=a,u=f),s&&(n.splice(0,u,s),e=n.join("/"))}return e}function g(t,n){return function(){var r=p.call(arguments,0);return typeof r[0]!="string"&&r.length===1&&r.push(null),s.apply(e,r.concat([t,n]))}}function y(e){return function(t){return m(t,e)}}function b(e){return function(t){a[e]=t}}function w(t){if(v(f,t)){var n=f[t];delete f[t],c[t]=!0,i.apply(e,n)}if(!v(a,t)&&!v(c,t))throw new Error("No "+t);return a[t]}function E(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function S(e){return function(){return l&&l.config&&l.config[e]||{}}}var i,s,o,u,a={},f={},l={},c={},h=Object.prototype.hasOwnProperty,p=[].slice,d=/\\.js$/;o=function(e,t){var n,r=E(e),i=r[0];return e=r[1],i&&(i=m(i,t),n=w(i)),i?n&&n.normalize?e=n.normalize(e,y(t)):e=m(e,t):(e=m(e,t),r=E(e),i=r[0],e=r[1],i&&(n=w(i))),{f:i?i+"!"+e:e,n:e,pr:i,p:n}},u={require:function(e){return g(e)},exports:function(e){var t=a[e];return typeof t!="undefined"?t:a[e]={}},module:function(e){return{id:e,uri:"",exports:a[e],config:S(e)}}},i=function(t,n,r,i){var s,l,h,p,d,m=[],y=typeof r,E;i=i||t;if(y==="undefined"||y==="function"){n=!n.length&&r.length?["require","exports","module"]:n;for(d=0;d<n.length;d+=1){p=o(n[d],i),l=p.f;if(l==="require")m[d]=u.require(t);else if(l==="exports")m[d]=u.exports(t),E=!0;else if(l==="module")s=m[d]=u.module(t);else if(v(a,l)||v(f,l)||v(c,l))m[d]=w(l);else{if(!p.p)throw new Error(t+" missing "+l);p.p.load(p.n,g(i,!0),b(l),{}),m[d]=a[l]}}h=r?r.apply(a[t],m):undefined;if(t)if(s&&s.exports!==e&&s.exports!==a[t])a[t]=s.exports;else if(h!==e||!E)a[t]=h}else t&&(a[t]=r)},t=n=s=function(t,n,r,a,f){if(typeof t=="string")return u[t]?u[t](n):w(o(t,n).f);if(!t.splice){l=t,l.deps&&s(l.deps,l.callback);if(!n)return;n.splice?(t=n,n=r,r=null):t=e}return n=n||function(){},typeof r=="function"&&(r=a,a=f),a?i(e,t,n,r):setTimeout(function(){i(e,t,n,r)},4),s},s.config=function(e){return s(e)},t._defined=a,r=function(e,t,n){t.splice||(n=t,t=[]),!v(a,e)&&!v(f,e)&&(f[e]=[e,t,n])},r.amd={jQuery:!0}})(),r("../tools/build/almond",function(){}),!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof r&&r.amd)r("lib/priority-queue",[],e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.PriorityQueue=e()}}(function(){return function e(t,r,i){function s(u,f){if(!r[u]){if(!t[u]){var l="function"==typeof n&&n;if(!f&&l)return l(u,!0);if(o)return o(u,!0);var c=new Error("Cannot find module \'"+u+"\'");throw c.code="MODULE_NOT_FOUND",c}var h=r[u]={exports:{}};t[u][0].call(h.exports,function(e){var n=t[u][1][e];return s(n?n:e)},h,h.exports,e,t,r,i)}return r[u].exports}for(var o="function"==typeof n&&n,u=0;u<i.length;u++)s(i[u]);return s}({1:[function(e,t){var n,r,i,s,o,u={}.hasOwnProperty,a=function(e,t){function n(){this.constructor=e}for(var r in t)u.call(t,r)&&(e[r]=t[r]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};n=e("./PriorityQueue/AbstractPriorityQueue"),r=e("./PriorityQueue/ArrayStrategy"),s=e("./PriorityQueue/BinaryHeapStrategy"),i=e("./PriorityQueue/BHeapStrategy"),o=function(e){function t(e){e||(e={}),e.strategy||(e.strategy=s),e.comparator||(e.comparator=function(e,t){return(e||0)-(t||0)}),t.__super__.constructor.call(this,e)}return a(t,e),t}(n),o.ArrayStrategy=r,o.BinaryHeapStrategy=s,o.BHeapStrategy=i,t.exports=o},{"./PriorityQueue/AbstractPriorityQueue":2,"./PriorityQueue/ArrayStrategy":3,"./PriorityQueue/BHeapStrategy":4,"./PriorityQueue/BinaryHeapStrategy":5}],2:[function(e,t){var n;t.exports=n=function(){function e(e){if(null==(null!=e?e.strategy:void 0))throw"Must pass options.strategy, a strategy";if(null==(null!=e?e.comparator:void 0))throw"Must pass options.comparator, a comparator";this.priv=new e.strategy(e),this.length=0}return e.prototype.queue=function(e){return this.length++,void this.priv.queue(e)},e.prototype.dequeue=function(){if(!this.length)throw"Empty queue";return this.length--,this.priv.dequeue()},e.prototype.peek=function(){if(!this.length)throw"Empty queue";return this.priv.peek()},e}()},{}],3:[function(e,t){var n,r;r=function(e,t,n){var r,i,s;for(i=0,r=e.length;r>i;)s=i+r>>>1,n(e[s],t)>=0?i=s+1:r=s;return i},t.exports=n=function(){function e(e){var t;this.options=e,this.comparator=this.options.comparator,this.data=(null!=(t=this.options.initialValues)?t.slice(0):void 0)||[],this.data.sort(this.comparator).reverse()}return e.prototype.queue=function(e){var t;return t=r(this.data,e,this.comparator),void this.data.splice(t,0,e)},e.prototype.dequeue=function(){return this.data.pop()},e.prototype.peek=function(){return this.data[this.data.length-1]},e}()},{}],4:[function(e,t){var n;t.exports=n=function(){function e(e){var t,n,r,i,s,o,u,a,f;for(this.comparator=(null!=e?e.comparator:void 0)||function(e,t){return e-t},this.pageSize=(null!=e?e.pageSize:void 0)||512,this.length=0,r=0;1<<r<this.pageSize;)r+=1;if(1<<r!==this.pageSize)throw"pageSize must be a power of two";for(this._shift=r,this._emptyMemoryPageTemplate=t=[],n=s=0,a=this.pageSize;a>=0?a>s:s>a;n=a>=0?++s:--s)t.push(null);if(this._memory=[],this._mask=this.pageSize-1,e.initialValues)for(f=e.initialValues,o=0,u=f.length;u>o;o++)i=f[o],this.queue(i)}return e.prototype.queue=function(e){return this.length+=1,this._write(this.length,e),void this._bubbleUp(this.length,e)},e.prototype.dequeue=function(){var e,t;return e=this._read(1),t=this._read(this.length),this.length-=1,this.length>0&&(this._write(1,t),this._bubbleDown(1,t)),e},e.prototype.peek=function(){return this._read(1)},e.prototype._write=function(e,t){var n;for(n=e>>this._shift;n>=this._memory.length;)this._memory.push(this._emptyMemoryPageTemplate.slice(0));return this._memory[n][e&this._mask]=t},e.prototype._read=function(e){return this._memory[e>>this._shift][e&this._mask]},e.prototype._bubbleUp=function(e,t){var n,r,i,s;for(n=this.comparator;e>1&&(r=e&this._mask,e<this.pageSize||r>3?i=e&~this._mask|r>>1:2>r?(i=e-this.pageSize>>this._shift,i+=i&~(this._mask>>1),i|=this.pageSize>>1):i=e-2,s=this._read(i),!(n(s,t)<0));)this._write(i,t),this._write(e,s),e=i;return void 0},e.prototype._bubbleDown=function(e,t){var n,r,i,s,o;for(o=this.comparator;e<this.length;)if(e>this._mask&&!(e&this._mask-1)?n=r=e+2:e&this.pageSize>>1?(n=(e&~this._mask)>>1,n|=e&this._mask>>1,n=n+1<<this._shift,r=n+1):(n=e+(e&this._mask),r=n+1),n!==r&&r<=this.length)if(i=this._read(n),s=this._read(r),o(i,t)<0&&o(i,s)<=0)this._write(n,t),this._write(e,i),e=n;else{if(!(o(s,t)<0))break;this._write(r,t),this._write(e,s),e=r}else{if(!(n<=this.length))break;if(i=this._read(n),!(o(i,t)<0))break;this._write(n,t),this._write(e,i),e=n}return void 0},e}()},{}],5:[function(e,t){var n;t.exports=n=function(){function e(e){var t;this.comparator=(null!=e?e.comparator:void 0)||function(e,t){return e-t},this.length=0,this.data=(null!=(t=e.initialValues)?t.slice(0):void 0)||[],this._heapify()}return e.prototype._heapify=function(){var e,t,n;if(this.data.length>0)for(e=t=1,n=this.data.length;n>=1?n>t:t>n;e=n>=1?++t:--t)this._bubbleUp(e);return void 0},e.prototype.queue=function(e){return this.data.push(e),void this._bubbleUp(this.data.length-1)},e.prototype.dequeue=function(){var e,t;return t=this.data[0],e=this.data.pop(),this.data.length>0&&(this.data[0]=e,this._bubbleDown(0)),t},e.prototype.peek=function(){return this.data[0]},e.prototype._bubbleUp=function(e){for(var t,n;e>0&&(t=e-1>>>1,this.comparator(this.data[e],this.data[t])<0);)n=this.data[t],this.data[t]=this.data[e],this.data[e]=n,e=t;return void 0},e.prototype._bubbleDown=function(e){var t,n,r,i,s;for(t=this.data.length-1;;){if(n=(e<<1)+1,i=n+1,r=e,t>=n&&this.comparator(this.data[n],this.data[r])<0&&(r=n),t>=i&&this.comparator(this.data[i],this.data[r])<0&&(r=i),r===e)break;s=this.data[r],this.data[r]=this.data[e],this.data[e]=s,e=r}return void 0},e}()},{}]},{},[1])(1)}),!function(e){if("object"==typeof exports)module.exports=e();else if("function"==typeof r&&r.amd)r("lib/poly2tri",e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.poly2tri=e()}}(function(){return function e(t,r,i){function s(u,a){if(!r[u]){if(!t[u]){var f="function"==typeof n&&n;if(!a&&f)return f(u,!0);if(o)return o(u,!0);throw new Error("Cannot find module \'"+u+"\'")}var l=r[u]={exports:{}};t[u][0].call(l.exports,function(e){var n=t[u][1][e];return s(n?n:e)},l,l.exports,e,t,r,i)}return r[u].exports}for(var o="function"==typeof n&&n,u=0;u<i.length;u++)s(i[u]);return s}({1:[function(e,t){t.exports={version:"1.3.5"}},{}],2:[function(e,t){var n=function(e,t){this.point=e,this.triangle=t||null,this.next=null,this.prev=null,this.value=e.x},r=function(e,t){this.head_=e,this.tail_=t,this.search_node_=e};r.prototype.head=function(){return this.head_},r.prototype.setHead=function(e){this.head_=e},r.prototype.tail=function(){return this.tail_},r.prototype.setTail=function(e){this.tail_=e},r.prototype.search=function(){return this.search_node_},r.prototype.setSearch=function(e){this.search_node_=e},r.prototype.findSearchNode=function(){return this.search_node_},r.prototype.locateNode=function(e){var t=this.search_node_;if(e<t.value){for(;t=t.prev;)if(e>=t.value)return this.search_node_=t,t}else for(;t=t.next;)if(e<t.value)return this.search_node_=t.prev,t.prev;return null},r.prototype.locatePoint=function(e){var t=e.x,n=this.findSearchNode(t),r=n.point.x;if(t===r){if(e!==n.point)if(e===n.prev.point)n=n.prev;else{if(e!==n.next.point)throw new Error("poly2tri Invalid AdvancingFront.locatePoint() call");n=n.next}}else if(r>t)for(;(n=n.prev)&&e!==n.point;);else for(;(n=n.next)&&e!==n.point;);return n&&(this.search_node_=n),n},t.exports=r,t.exports.Node=n},{}],3:[function(e,t){function n(e,t){if(!e)throw new Error(t||"Assert Failed")}t.exports=n},{}],4:[function(e,t){var n=e("./xy"),r=function(e,t){this.x=+e||0,this.y=+t||0,this._p2t_edge_list=null};r.prototype.toString=function(){return n.toStringBase(this)},r.prototype.toJSON=function(){return{x:this.x,y:this.y}},r.prototype.clone=function(){return new r(this.x,this.y)},r.prototype.set_zero=function(){return this.x=0,this.y=0,this},r.prototype.set=function(e,t){return this.x=+e||0,this.y=+t||0,this},r.prototype.negate=function(){return this.x=-this.x,this.y=-this.y,this},r.prototype.add=function(e){return this.x+=e.x,this.y+=e.y,this},r.prototype.sub=function(e){return this.x-=e.x,this.y-=e.y,this},r.prototype.mul=function(e){return this.x*=e,this.y*=e,this},r.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},r.prototype.normalize=function(){var e=this.length();return this.x/=e,this.y/=e,e},r.prototype.equals=function(e){return this.x===e.x&&this.y===e.y},r.negate=function(e){return new r(-e.x,-e.y)},r.add=function(e,t){return new r(e.x+t.x,e.y+t.y)},r.sub=function(e,t){return new r(e.x-t.x,e.y-t.y)},r.mul=function(e,t){return new r(e*t.x,e*t.y)},r.cross=function(e,t){return"number"==typeof e?"number"==typeof t?e*t:new r(-e*t.y,e*t.x):"number"==typeof t?new r(t*e.y,-t*e.x):e.x*t.y-e.y*t.x},r.toString=n.toString,r.compare=n.compare,r.cmp=n.compare,r.equals=n.equals,r.dot=function(e,t){return e.x*t.x+e.y*t.y},t.exports=r},{"./xy":11}],5:[function(e,t){var n=e("./xy"),r=function(e,t){this.name="PointError",this.points=t=t||[],this.message=e||"Invalid Points!";for(var r=0;r<t.length;r++)this.message+=" "+n.toString(t[r])};r.prototype=new Error,r.prototype.constructor=r,t.exports=r},{"./xy":11}],6:[function(e,t,n){(function(t){var r=t.poly2tri;n.noConflict=function(){return t.poly2tri=r,n},n.VERSION=e("../dist/version.json").version,n.PointError=e("./pointerror"),n.Point=e("./point"),n.Triangle=e("./triangle"),n.SweepContext=e("./sweepcontext");var i=e("./sweep");n.triangulate=i.triangulate,n.sweep={Triangulate:i.triangulate}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../dist/version.json":1,"./point":4,"./pointerror":5,"./sweep":7,"./sweepcontext":8,"./triangle":9}],7:[function(e,t,n){function r(e){e.initTriangulation(),e.createAdvancingFront(),i(e),s(e)}function i(e){var t,n=e.pointCount();for(t=1;n>t;++t)for(var r=e.getPoint(t),i=o(e,r),s=r._p2t_edge_list,a=0;s&&a<s.length;++a)u(e,s[a],i)}function s(e){for(var t=e.front().head().next.triangle,n=e.front().head().next.point;!t.getConstrainedEdgeCW(n);)t=t.neighborCCW(n);e.meshClean(t)}function o(e,t){var n=e.locateNode(t),r=l(e,t,n);return t.x<=n.point.x+F&&c(e,n),h(e,r),r}function u(e,t,n){e.edge_event.constrained_edge=t,e.edge_event.right=t.p.x>t.q.x,f(n.triangle,t.p,t.q)||(w(e,t,n),a(e,t.p,t.q,n.triangle,t.q))}function a(e,t,n,r,i){if(!f(r,t,n)){var s=r.pointCCW(i),o=q(n,s,t);if(o===I.COLLINEAR)throw new P("poly2tri EdgeEvent: Collinear not supported!",[n,s,t]);var u=r.pointCW(i),l=q(n,u,t);if(l===I.COLLINEAR)throw new P("poly2tri EdgeEvent: Collinear not supported!",[n,u,t]);o===l?(r=o===I.CW?r.neighborCCW(i):r.neighborCW(i),a(e,t,n,r,i)):A(e,t,n,r,i)}}function f(e,t,n){var r=e.edgeIndex(t,n);if(-1!==r){e.markConstrainedEdgeByIndex(r);var i=e.getNeighbor(r);return i&&i.markConstrainedEdgeByPoints(t,n),!0}return!1}function l(e,t,n){var r=new H(t,n.point,n.next.point);r.markNeighbor(n.triangle),e.addToMap(r);var i=new B(t);return i.next=n.next,i.prev=n,n.next.prev=i,n.next=i,d(e,r)||e.mapTriangleToNodes(r),i}function c(e,t){var n=new H(t.prev.point,t.point,t.next.point);n.markNeighbor(t.prev.triangle),n.markNeighbor(t.triangle),e.addToMap(n),t.prev.next=t.next,t.next.prev=t.prev,d(e,n)||e.mapTriangleToNodes(n)}function h(e,t){for(var n=t.next;n.next&&!U(n.point,n.next.point,n.prev.point);)c(e,n),n=n.next;for(n=t.prev;n.prev&&!U(n.point,n.next.point,n.prev.point);)c(e,n),n=n.prev;t.next&&t.next.next&&p(t)&&g(e,t)}function p(e){var t=e.point.x-e.next.next.point.x,n=e.point.y-e.next.next.point.y;return D(n>=0,"unordered y"),t>=0||Math.abs(t)<n}function d(e,t){for(var n=0;3>n;++n)if(!t.delaunay_edge[n]){var r=t.getNeighbor(n);if(r){var i=t.getPoint(n),s=r.oppositePoint(t,i),o=r.index(s);if(r.constrained_edge[o]||r.delaunay_edge[o]){t.constrained_edge[n]=r.constrained_edge[o];continue}var u=v(i,t.pointCCW(i),t.pointCW(i),s);if(u){t.delaunay_edge[n]=!0,r.delaunay_edge[o]=!0,m(t,i,r,s);var a=!d(e,t);return a&&e.mapTriangleToNodes(t),a=!d(e,r),a&&e.mapTriangleToNodes(r),t.delaunay_edge[n]=!1,r.delaunay_edge[o]=!1,!0}}}return!1}function v(e,t,n,r){var i=e.x-r.x,s=e.y-r.y,o=t.x-r.x,u=t.y-r.y,a=i*u,f=o*s,l=a-f;if(0>=l)return!1;var c=n.x-r.x,h=n.y-r.y,p=c*s,d=i*h,v=p-d;if(0>=v)return!1;var m=o*h,g=c*u,y=i*i+s*s,b=o*o+u*u,w=c*c+h*h,E=y*(m-g)+b*v+w*l;return E>0}function m(e,t,n,r){var i,s,o,u;i=e.neighborCCW(t),s=e.neighborCW(t),o=n.neighborCCW(r),u=n.neighborCW(r);var a,f,l,c;a=e.getConstrainedEdgeCCW(t),f=e.getConstrainedEdgeCW(t),l=n.getConstrainedEdgeCCW(r),c=n.getConstrainedEdgeCW(r);var h,p,d,v;h=e.getDelaunayEdgeCCW(t),p=e.getDelaunayEdgeCW(t),d=n.getDelaunayEdgeCCW(r),v=n.getDelaunayEdgeCW(r),e.legalize(t,r),n.legalize(r,t),n.setDelaunayEdgeCCW(t,h),e.setDelaunayEdgeCW(t,p),e.setDelaunayEdgeCCW(r,d),n.setDelaunayEdgeCW(r,v),n.setConstrainedEdgeCCW(t,a),e.setConstrainedEdgeCW(t,f),e.setConstrainedEdgeCCW(r,l),n.setConstrainedEdgeCW(r,c),e.clearNeighbors(),n.clearNeighbors(),i&&n.markNeighbor(i),s&&e.markNeighbor(s),o&&e.markNeighbor(o),u&&n.markNeighbor(u),e.markNeighbor(n)}function g(e,t){for(e.basin.left_node=q(t.point,t.next.point,t.next.next.point)===I.CCW?t.next.next:t.next,e.basin.bottom_node=e.basin.left_node;e.basin.bottom_node.next&&e.basin.bottom_node.point.y>=e.basin.bottom_node.next.point.y;)e.basin.bottom_node=e.basin.bottom_node.next;if(e.basin.bottom_node!==e.basin.left_node){for(e.basin.right_node=e.basin.bottom_node;e.basin.right_node.next&&e.basin.right_node.point.y<e.basin.right_node.next.point.y;)e.basin.right_node=e.basin.right_node.next;e.basin.right_node!==e.basin.bottom_node&&(e.basin.width=e.basin.right_node.point.x-e.basin.left_node.point.x,e.basin.left_highest=e.basin.left_node.point.y>e.basin.right_node.point.y,y(e,e.basin.bottom_node))}}function y(e,t){if(!b(e,t)){c(e,t);var n;if(t.prev!==e.basin.left_node||t.next!==e.basin.right_node){if(t.prev===e.basin.left_node){if(n=q(t.point,t.next.point,t.next.next.point),n===I.CW)return;t=t.next}else if(t.next===e.basin.right_node){if(n=q(t.point,t.prev.point,t.prev.prev.point),n===I.CCW)return;t=t.prev}else t=t.prev.point.y<t.next.point.y?t.prev:t.next;y(e,t)}}}function b(e,t){var n;return n=e.basin.left_highest?e.basin.left_node.point.y-t.point.y:e.basin.right_node.point.y-t.point.y,e.basin.width>n?!0:!1}function w(e,t,n){e.edge_event.right?E(e,t,n):N(e,t,n)}function E(e,t,n){for(;n.next.point.x<t.p.x;)q(t.q,n.next.point,t.p)===I.CCW?S(e,t,n):n=n.next}function S(e,t,n){n.point.x<t.p.x&&(q(n.point,n.next.point,n.next.next.point)===I.CCW?x(e,t,n):(T(e,t,n),S(e,t,n)))}function x(e,t,n){c(e,n.next),n.next.point!==t.p&&q(t.q,n.next.point,t.p)===I.CCW&&q(n.point,n.next.point,n.next.next.point)===I.CCW&&x(e,t,n)}function T(e,t,n){q(n.next.point,n.next.next.point,n.next.next.next.point)===I.CCW?x(e,t,n.next):q(t.q,n.next.next.point,t.p)===I.CCW&&T(e,t,n.next)}function N(e,t,n){for(;n.prev.point.x>t.p.x;)q(t.q,n.prev.point,t.p)===I.CW?C(e,t,n):n=n.prev}function C(e,t,n){n.point.x>t.p.x&&(q(n.point,n.prev.point,n.prev.prev.point)===I.CW?L(e,t,n):(k(e,t,n),C(e,t,n)))}function k(e,t,n){q(n.prev.point,n.prev.prev.point,n.prev.prev.prev.point)===I.CW?L(e,t,n.prev):q(t.q,n.prev.prev.point,t.p)===I.CW&&k(e,t,n.prev)}function L(e,t,n){c(e,n.prev),n.prev.point!==t.p&&q(t.q,n.prev.point,t.p)===I.CW&&q(n.point,n.prev.point,n.prev.prev.point)===I.CW&&L(e,t,n)}function A(e,t,n,r,i){var s=r.neighborAcross(i);D(s,"FLIP failed due to missing triangle!");var o=s.oppositePoint(r,i);if(r.getConstrainedEdgeAcross(i)){var u=r.index(i);throw new P("poly2tri Intersecting Constraints",[i,o,r.getPoint((u+1)%3),r.getPoint((u+2)%3)])}if(R(i,r.pointCCW(i),r.pointCW(i),o))if(m(r,i,s,o),e.mapTriangleToNodes(r),e.mapTriangleToNodes(s),i===n&&o===t)n===e.edge_event.constrained_edge.q&&t===e.edge_event.constrained_edge.p&&(r.markConstrainedEdgeByPoints(t,n),s.markConstrainedEdgeByPoints(t,n),d(e,r),d(e,s));else{var f=q(n,o,t);r=O(e,f,r,s,i,o),A(e,t,n,r,i)}else{var l=M(t,n,s,o);_(e,t,n,r,s,l),a(e,t,n,r,i)}}function O(e,t,n,r,i,s){var o;return t===I.CCW?(o=r.edgeIndex(i,s),r.delaunay_edge[o]=!0,d(e,r),r.clearDelaunayEdges(),n):(o=n.edgeIndex(i,s),n.delaunay_edge[o]=!0,d(e,n),n.clearDelaunayEdges(),r)}function M(e,t,n,r){var i=q(t,r,e);if(i===I.CW)return n.pointCCW(r);if(i===I.CCW)return n.pointCW(r);throw new P("poly2tri [Unsupported] nextFlipPoint: opposing point on constrained edge!",[t,r,e])}function _(e,t,n,r,i,s){var o=i.neighborAcross(s);D(o,"FLIP failed due to missing triangle");var u=o.oppositePoint(i,s);if(R(n,r.pointCCW(n),r.pointCW(n),u))A(e,n,u,o,u);else{var a=M(t,n,o,u);_(e,t,n,r,o,a)}}var D=e("./assert"),P=e("./pointerror"),H=e("./triangle"),B=e("./advancingfront").Node,j=e("./utils"),F=j.EPSILON,I=j.Orientation,q=j.orient2d,R=j.inScanArea,U=j.isAngleObtuse;n.triangulate=r},{"./advancingfront":2,"./assert":3,"./pointerror":5,"./triangle":9,"./utils":10}],8:[function(e,t){var n=e("./pointerror"),r=e("./point"),i=e("./triangle"),s=e("./sweep"),o=e("./advancingfront"),u=o.Node,a=.3,f=function(e,t){if(this.p=e,this.q=t,e.y>t.y)this.q=e,this.p=t;else if(e.y===t.y)if(e.x>t.x)this.q=e,this.p=t;else if(e.x===t.x)throw new n("poly2tri Invalid Edge constructor: repeated points!",[e]);this.q._p2t_edge_list||(this.q._p2t_edge_list=[]),this.q._p2t_edge_list.push(this)},l=function(){this.left_node=null,this.bottom_node=null,this.right_node=null,this.width=0,this.left_highest=!1};l.prototype.clear=function(){this.left_node=null,this.bottom_node=null,this.right_node=null,this.width=0,this.left_highest=!1};var c=function(){this.constrained_edge=null,this.right=!1},h=function(e,t){t=t||{},this.triangles_=[],this.map_=[],this.points_=t.cloneArrays?e.slice(0):e,this.edge_list=[],this.pmin_=this.pmax_=null,this.front_=null,this.head_=null,this.tail_=null,this.af_head_=null,this.af_middle_=null,this.af_tail_=null,this.basin=new l,this.edge_event=new c,this.initEdges(this.points_)};h.prototype.addHole=function(e){this.initEdges(e);var t,n=e.length;for(t=0;n>t;t++)this.points_.push(e[t]);return this},h.prototype.AddHole=h.prototype.addHole,h.prototype.addHoles=function(e){var t,n=e.length;for(t=0;n>t;t++)this.initEdges(e[t]);return this.points_=this.points_.concat.apply(this.points_,e),this},h.prototype.addPoint=function(e){return this.points_.push(e),this},h.prototype.AddPoint=h.prototype.addPoint,h.prototype.addPoints=function(e){return this.points_=this.points_.concat(e),this},h.prototype.triangulate=function(){return s.triangulate(this),this},h.prototype.getBoundingBox=function(){return{min:this.pmin_,max:this.pmax_}},h.prototype.getTriangles=function(){return this.triangles_},h.prototype.GetTriangles=h.prototype.getTriangles,h.prototype.front=function(){return this.front_},h.prototype.pointCount=function(){return this.points_.length},h.prototype.head=function(){return this.head_},h.prototype.setHead=function(e){this.head_=e},h.prototype.tail=function(){return this.tail_},h.prototype.setTail=function(e){this.tail_=e},h.prototype.getMap=function(){return this.map_},h.prototype.initTriangulation=function(){var e,t=this.points_[0].x,n=this.points_[0].x,i=this.points_[0].y,s=this.points_[0].y,o=this.points_.length;for(e=1;o>e;e++){var u=this.points_[e];u.x>t&&(t=u.x),u.x<n&&(n=u.x),u.y>i&&(i=u.y),u.y<s&&(s=u.y)}this.pmin_=new r(n,s),this.pmax_=new r(t,i);var f=a*(t-n),l=a*(i-s);this.head_=new r(t+f,s-l),this.tail_=new r(n-f,s-l),this.points_.sort(r.compare)},h.prototype.initEdges=function(e){var t,n=e.length;for(t=0;n>t;++t)this.edge_list.push(new f(e[t],e[(t+1)%n]))},h.prototype.getPoint=function(e){return this.points_[e]},h.prototype.addToMap=function(e){this.map_.push(e)},h.prototype.locateNode=function(e){return this.front_.locateNode(e.x)},h.prototype.createAdvancingFront=function(){var e,t,n,r=new i(this.points_[0],this.tail_,this.head_);this.map_.push(r),e=new u(r.getPoint(1),r),t=new u(r.getPoint(0),r),n=new u(r.getPoint(2)),this.front_=new o(e,n),e.next=t,t.next=n,t.prev=e,n.prev=t},h.prototype.removeNode=function(){},h.prototype.mapTriangleToNodes=function(e){for(var t=0;3>t;++t)if(!e.getNeighbor(t)){var n=this.front_.locatePoint(e.pointCW(e.getPoint(t)));n&&(n.triangle=e)}},h.prototype.removeFromMap=function(e){var t,n=this.map_,r=n.length;for(t=0;r>t;t++)if(n[t]===e){n.splice(t,1);break}},h.prototype.meshClean=function(e){for(var t,n,r=[e];t=r.pop();)if(!t.isInterior())for(t.setInterior(!0),this.triangles_.push(t),n=0;3>n;n++)t.constrained_edge[n]||r.push(t.getNeighbor(n))},t.exports=h},{"./advancingfront":2,"./point":4,"./pointerror":5,"./sweep":7,"./triangle":9}],9:[function(e,t){var n=e("./xy"),r=function(e,t,n){this.points_=[e,t,n],this.neighbors_=[null,null,null],this.interior_=!1,this.constrained_edge=[!1,!1,!1],this.delaunay_edge=[!1,!1,!1]},i=n.toString;r.prototype.toString=function(){return"["+i(this.points_[0])+i(this.points_[1])+i(this.points_[2])+"]"},r.prototype.getPoint=function(e){return this.points_[e]},r.prototype.GetPoint=r.prototype.getPoint,r.prototype.getPoints=function(){return this.points_},r.prototype.getNeighbor=function(e){return this.neighbors_[e]},r.prototype.containsPoint=function(e){var t=this.points_;return e===t[0]||e===t[1]||e===t[2]},r.prototype.containsEdge=function(e){return this.containsPoint(e.p)&&this.containsPoint(e.q)},r.prototype.containsPoints=function(e,t){return this.containsPoint(e)&&this.containsPoint(t)},r.prototype.isInterior=function(){return this.interior_},r.prototype.setInterior=function(e){return this.interior_=e,this},r.prototype.markNeighborPointers=function(e,t,n){var r=this.points_;if(e===r[2]&&t===r[1]||e===r[1]&&t===r[2])this.neighbors_[0]=n;else if(e===r[0]&&t===r[2]||e===r[2]&&t===r[0])this.neighbors_[1]=n;else{if(!(e===r[0]&&t===r[1]||e===r[1]&&t===r[0]))throw new Error("poly2tri Invalid Triangle.markNeighborPointers() call");this.neighbors_[2]=n}},r.prototype.markNeighbor=function(e){var t=this.points_;e.containsPoints(t[1],t[2])?(this.neighbors_[0]=e,e.markNeighborPointers(t[1],t[2],this)):e.containsPoints(t[0],t[2])?(this.neighbors_[1]=e,e.markNeighborPointers(t[0],t[2],this)):e.containsPoints(t[0],t[1])&&(this.neighbors_[2]=e,e.markNeighborPointers(t[0],t[1],this))},r.prototype.clearNeighbors=function(){this.neighbors_[0]=null,this.neighbors_[1]=null,this.neighbors_[2]=null},r.prototype.clearDelaunayEdges=function(){this.delaunay_edge[0]=!1,this.delaunay_edge[1]=!1,this.delaunay_edge[2]=!1},r.prototype.pointCW=function(e){var t=this.points_;return e===t[0]?t[2]:e===t[1]?t[0]:e===t[2]?t[1]:null},r.prototype.pointCCW=function(e){var t=this.points_;return e===t[0]?t[1]:e===t[1]?t[2]:e===t[2]?t[0]:null},r.prototype.neighborCW=function(e){return e===this.points_[0]?this.neighbors_[1]:e===this.points_[1]?this.neighbors_[2]:this.neighbors_[0]},r.prototype.neighborCCW=function(e){return e===this.points_[0]?this.neighbors_[2]:e===this.points_[1]?this.neighbors_[0]:this.neighbors_[1]},r.prototype.getConstrainedEdgeCW=function(e){return e===this.points_[0]?this.constrained_edge[1]:e===this.points_[1]?this.constrained_edge[2]:this.constrained_edge[0]},r.prototype.getConstrainedEdgeCCW=function(e){return e===this.points_[0]?this.constrained_edge[2]:e===this.points_[1]?this.constrained_edge[0]:this.constrained_edge[1]},r.prototype.getConstrainedEdgeAcross=function(e){return e===this.points_[0]?this.constrained_edge[0]:e===this.points_[1]?this.constrained_edge[1]:this.constrained_edge[2]},r.prototype.setConstrainedEdgeCW=function(e,t){e===this.points_[0]?this.constrained_edge[1]=t:e===this.points_[1]?this.constrained_edge[2]=t:this.constrained_edge[0]=t},r.prototype.setConstrainedEdgeCCW=function(e,t){e===this.points_[0]?this.constrained_edge[2]=t:e===this.points_[1]?this.constrained_edge[0]=t:this.constrained_edge[1]=t},r.prototype.getDelaunayEdgeCW=function(e){return e===this.points_[0]?this.delaunay_edge[1]:e===this.points_[1]?this.delaunay_edge[2]:this.delaunay_edge[0]},r.prototype.getDelaunayEdgeCCW=function(e){return e===this.points_[0]?this.delaunay_edge[2]:e===this.points_[1]?this.delaunay_edge[0]:this.delaunay_edge[1]},r.prototype.setDelaunayEdgeCW=function(e,t){e===this.points_[0]?this.delaunay_edge[1]=t:e===this.points_[1]?this.delaunay_edge[2]=t:this.delaunay_edge[0]=t},r.prototype.setDelaunayEdgeCCW=function(e,t){e===this.points_[0]?this.delaunay_edge[2]=t:e===this.points_[1]?this.delaunay_edge[0]=t:this.delaunay_edge[1]=t},r.prototype.neighborAcross=function(e){return e===this.points_[0]?this.neighbors_[0]:e===this.points_[1]?this.neighbors_[1]:this.neighbors_[2]},r.prototype.oppositePoint=function(e,t){var n=e.pointCW(t);return this.pointCW(n)},r.prototype.legalize=function(e,t){var n=this.points_;if(e===n[0])n[1]=n[0],n[0]=n[2],n[2]=t;else if(e===n[1])n[2]=n[1],n[1]=n[0],n[0]=t;else{if(e!==n[2])throw new Error("poly2tri Invalid Triangle.legalize() call");n[0]=n[2],n[2]=n[1],n[1]=t}},r.prototype.index=function(e){var t=this.points_;if(e===t[0])return 0;if(e===t[1])return 1;if(e===t[2])return 2;throw new Error("poly2tri Invalid Triangle.index() call")},r.prototype.edgeIndex=function(e,t){var n=this.points_;if(e===n[0]){if(t===n[1])return 2;if(t===n[2])return 1}else if(e===n[1]){if(t===n[2])return 0;if(t===n[0])return 2}else if(e===n[2]){if(t===n[0])return 1;if(t===n[1])return 0}return-1},r.prototype.markConstrainedEdgeByIndex=function(e){this.constrained_edge[e]=!0},r.prototype.markConstrainedEdgeByEdge=function(e){this.markConstrainedEdgeByPoints(e.p,e.q)},r.prototype.markConstrainedEdgeByPoints=function(e,t){var n=this.points_;t===n[0]&&e===n[1]||t===n[1]&&e===n[0]?this.constrained_edge[2]=!0:t===n[0]&&e===n[2]||t===n[2]&&e===n[0]?this.constrained_edge[1]=!0:(t===n[1]&&e===n[2]||t===n[2]&&e===n[1])&&(this.constrained_edge[0]=!0)},t.exports=r},{"./xy":11}],10:[function(e,t,n){function r(e,t,n){var r=(e.x-n.x)*(t.y-n.y),i=(e.y-n.y)*(t.x-n.x),s=r-i;return s>-o&&o>s?u.COLLINEAR:s>0?u.CCW:u.CW}function i(e,t,n,r){var i=(e.x-t.x)*(r.y-t.y)-(r.x-t.x)*(e.y-t.y);if(i>=-o)return!1;var s=(e.x-n.x)*(r.y-n.y)-(r.x-n.x)*(e.y-n.y);return o>=s?!1:!0}function s(e,t,n){var r=t.x-e.x,i=t.y-e.y,s=n.x-e.x,o=n.y-e.y;return 0>r*s+i*o}var o=1e-12;n.EPSILON=o;var u={CW:1,CCW:-1,COLLINEAR:0};n.Orientation=u,n.orient2d=r,n.inScanArea=i,n.isAngleObtuse=s},{}],11:[function(e,t){function n(e){return"("+e.x+";"+e.y+")"}function r(e){var t=e.toString();return"[object Object]"===t?n(e):t}function i(e,t){return e.y===t.y?e.x-t.x:e.y-t.y}function s(e,t){return e.x===t.x&&e.y===t.y}t.exports={toString:r,toStringBase:n,compare:i,equals:s}},{}]},{},[6])(6)}),r("polypartition",["./lib/poly2tri"],function(t){var n={};Point=function(e,t){this.x=e,this.y=t},n.Point=Point,Point.fromPointLike=function(e){return new Point(e.x,e.y)},Point.toString=function(e){return"x"+e.x+"y"+e.y},Point.prototype.add=function(e){return typeof e=="number"?new Point(this.x+e,this.y+e):new Point(this.x+e.x,this.y+e.y)},Point.prototype.sub=function(e){return typeof e=="number"?new Point(this.x-e,this.y-e):new Point(this.x-e.x,this.y-e.y)},Point.prototype.mul=function(e){return new Point(this.x*e,this.y*e)},Point.prototype.div=function(e){return new Point(this.x/e,this.y/e)},Point.prototype.eq=function(e){return this.x==e.x&&this.y==e.y},Point.prototype.neq=function(e){return this.x!=e.x||this.y!=e.y},Point.prototype.dot=function(e){return this.x*e.x+this.y*e.y},Point.prototype.cross=function(e){return this.x*e.y-this.y*e.x},Point.prototype.dist=function(e){var t=this.sub(e);return Math.sqrt(t.dot(t))},Point.prototype.dist2=function(e){var t=this.sub(e);return t.dot(t)},Point.prototype.zero=function(){return this.x==0&&this.y==0},Point.prototype.len=function(){return this.dist(new Point(0,0))},Point.prototype.normalize=function(){var e=this.dist(new Point(0,0));return e>0?this.div(e):new Point(0,0)},Point.prototype.toString=function(){return"x"+this.x+"y"+this.y},Point.prototype.clone=function(){return new Point(this.x,this.y)},Edge=function(e,t){this.p1=e,this.p2=t,this.center=e.add(t.sub(e).div(2)),this.points=[this.p1,this.center,this.p2]},n.Edge=Edge,Edge.prototype._CCW=function(t,n,r){return a=t.x,b=t.y,c=n.x,d=n.y,e=r.x,f=r.y,(f-b)*(c-a)>(d-b)*(e-a)},Edge.prototype.intersects=function(e){var t=e.p1,n=e.p2;return t.eq(this.p1)||t.eq(this.p2)||n.eq(this.p1)||n.eq(this.p2)?!1:this._CCW(this.p1,t,n)!=this._CCW(this.p2,t,n)&&this._CCW(this.p1,this.p2,t)!=this._CCW(this.p1,this.p2,n)},Poly=function(e){typeof e=="undefined"&&(e=!1),this.hole=!1,this.points=null,this.numpoints=0,e&&(this.numpoints=e.length,this.points=e.slice())},n.Poly=Poly,Poly.prototype.init=function(e){this.points=new Array(e),this.numpoints=e},Poly.prototype.update=function(){this.numpoints=this.points.length},Poly.prototype.triangle=function(e,t,n){this.init(3),this.points[0]=e,this.points[1]=t,this.points[2]=n},Poly.prototype.getPoint=function(e){return this.points&&this.numpoints>e?this.points[e]:null},Poly.prototype.setPoint=function(e,t){this.points&&this.points.length>e&&(this.points[e]=t)},Poly.prototype.getNextI=function(e){return(e+1)%this.numpoints},Poly.prototype.getPrevI=function(e){return e==0?this.numpoints-1:e-1},Poly.prototype.getArea=function(){var e=0;for(var t=0;t<this.numpoints;t++){var n=this.getNextI(t);e+=this.points[t].x*this.points[n].y-this.points[t].y*this.points[n].x}return e},Poly.prototype.getOrientation=function(){var e=this.getArea();return e>0?"CCW":e<0?"CW":0},Poly.prototype.setOrientation=function(e){var t=this.getOrientation();t&&t!==e&&this.invert()},Poly.prototype.invert=function(){var e=new Array(this.numpoints);for(var t=0;t<this.numpoints;t++)e[t]=this.points[this.numpoints-t-1];this.points=e},Poly.prototype.getCenter=function(){var e=this.points.map(function(e){return e.x}),t=this.points.map(function(e){return e.y}),n=Math.min.apply(null,e),r=Math.max.apply(null,e),i=Math.min.apply(null,t),s=Math.max.apply(null,t);return new Point((n+r)/2,(i+s)/2)},Poly.prototype.centroid=function(){var e=0,t=0,n,r,i,s,o;for(n=0,r=this.points.length-1;n<this.points.length;r=n,n+=1)s=this.points[n],o=this.points[r],i=s.x*o.y-o.x*s.y,e+=(s.x+o.x)*i,t+=(s.y+o.y)*i;return i=this.getArea()*3,e=Math.abs(e),t=Math.abs(t),new Point(e/i,t/i)},Poly.prototype.toPointString=function(e,t){e=e||" ",t=t||"\\n";var n="";return this.points.forEach(function(r){n=n+r.x+e+r.y+t}),n},Poly.prototype.toString=function(){var e=this.centroid();return""+e.x+" "+e.y},Poly.prototype.containsPoint=function(e){var t=!1;for(var n=0,r=this.numpoints-1;n<this.numpoints;r=n++){var i=this.points[r],s=this.points[n];s.y>e.y!=i.y>e.y&&e.x<(i.x-s.x)*(e.y-s.y)/(i.y-s.y)+s.x&&(t=!t)}return t},Poly.prototype.clone=function(){return new Poly(this.points.slice().map(function(e){return e.clone()}))},Poly.prototype.translate=function(e){return new Poly(this.points.map(function(t){return t.add(e)}))},Poly.prototype.edges=function(){return this.hasOwnProperty("cached_edges")||(this.cached_edges=this.points.map(function(e,t){return new Edge(e,this.points[this.getNextI(t)])},this)),this.cached_edges},Poly.prototype.intersects=function(e){var t=e.points.some(function(e){return this.containsPoint(e)},this);t=t||this.points.some(function(t){return e.containsPoint(t)});if(t)return!0;var n=this.edges(),r=e.edges(),i=n.some(function(e){return r.some(function(t){return e.intersects(t)})});return i};var r={};return n.PolyUtils=r,r.isConvex=function(e,t,n){var r=(n.y-e.y)*(t.x-e.x)-(n.x-e.x)*(t.y-e.y);return r>0},r.findPolyForPoint=function(e,t){var n,r;for(n in t){r=t[n];if(r.containsPoint(e))return r}return null},r.lineCircleIntersection=function(e,t,n,r){var i={collides:!1,inside:!1,point:null,normal:null},s=n.sub(e);if(s.len()<=r)i.collides=!0,i.inside=s.len()!==r;else if(t.dot(s)>=0){var o=e.add(t.mul(t.dot(s))),u=n.sub(o).len();if(u<=r){i.collides=!0;var a=Math.sqrt(u*u+r*r);i.point=o.sub(t.mul(a)),i.normal=i.point.sub(n).normalize()}}return i},r.convexPartition=function(e,n,i){typeof n=="undefined"&&(n=!1),typeof i=="undefined"&&(i=5);var s,o,u,a,f,l,c=new Array;if(!n||n.length==0){var h=!1;for(var p=0;p<e.numpoints;p++){var d=e.getPrevI(p),v=e.getNextI(p);if(!r.isConvex(e.getPoint(d),e.getPoint(p),e.getPoint(v))){h=!0;break}}if(!h)return c.push(e),c}r._separatePolys(n.concat(e));var m=r._convertPolyToP2TPoly(e);n&&(n=n.map(r._convertPolyToP2TPoly));var g=new t.SweepContext(m);n&&g.addHoles(n);var y=g.triangulate().getTriangles();y=y.map(r._convertP2TPolyToPoly).filter(function(e){return e.getArea()>=i});for(var b=0;b<y.length;b++){var w=y[b],E=null;for(s=0;s<w.numpoints;s++){var S=w.getPoint(s);o=w.getNextI(s);var x=w.getPoint(o),T=!1;for(var N=b;N<y.length;N++){if(b==N)continue;var C=y[N];for(a=0;a<C.numpoints;a++){if(x.neq(C.getPoint(a)))continue;f=C.getNextI(a);if(S.neq(C.getPoint(f)))continue;T=!0,object_2_index=N;break}if(T)break}if(!T)continue;var k,L,A;L=w.getPoint(s),u=w.getPrevI(s),k=w.getPoint(u),l=C.getNextI(f),A=C.getPoint(l);if(!r.isConvex(k,L,A))continue;L=w.getPoint(o),u=w.getNextI(o),A=w.getPoint(u),l=C.getPrevI(a),k=C.getPoint(l);if(!r.isConvex(k,L,A))continue;var O=new Poly;O.init(w.numpoints+C.numpoints-2);var M=0;for(var _=o;_!=s;_=w.getNextI(_))O.setPoint(M,w.getPoint(_)),M++;for(var _=f;_!=a;_=C.getNextI(_))O.setPoint(M,C.getPoint(_)),M++;b>object_2_index?(y[b]=O,w=y[b],y.splice(object_2_index,1)):(y.splice(object_2_index,1),y[b]=O,w=y[b]),s=-1}}return y},r._separatePolys=function(e,t){t=t||1;var n={},r={};for(var i=0;i<e.length;i++){var s=e[i];for(var o=0;o<s.numpoints;o++){var u=s.points[o].toString();n.hasOwnProperty(u)?r[u]=!0:n[u]=!0}}var a=[],f;for(var i=0;i<e.length;i++){var s=e[i];for(var o=0;o<s.numpoints;o++){var u=s.points[o];r.hasOwnProperty(u.toString())&&(f=[u,o,s],a.push(f))}}a.sort(function(e,t){return t[1]-e[1]});var l,c,u,h,p,d;a.forEach(function(e,n,r){u=e[0],h=e[1],s=e[2],l=s.points[s.getPrevI(h)],c=s.points[s.getNextI(h)],p=u.add(l.sub(u).normalize().mul(t)),d=u.add(c.sub(u).normalize().mul(t)),s.points.splice(h,1,p,d),s.update()})},r._convertPolyToP2TPoly=function(e){return e.points.map(function(e){return new t.Point(e.x,e.y)})},r._convertP2TPolyToPoly=function(e){var t=e.getPoints().map(function(e){return new Point(e.x,e.y)});return new Poly(t)},n}),r("pathfinder",["./lib/priority-queue","./polypartition"],function(e,t){var n=t.PolyUtils,r=function(e,t){typeof t=="undefined"&&(t=!0),this.polys=e,t&&this.init()};return r.prototype.init=function(){this.grid=this.generateAdjacencyGrid(this.polys)},r.prototype.aStar=function(t,r){function i(e,t){return e.dist+u(e.point)-(t.dist+u(t.point))}function s(e,t){return e.dist(t)}function o(e,t){return e.r-t.r+(e.c-t.c)}function u(e){return s(e,r)}var a=n.findPolyForPoint(t,this.polys);if(!a){var f=[new Point(5,0),new Point(-5,0),new Point(0,-5),new Point(0,5)];for(var l=0;l<f.length;l++){var c=t.add(f[l]);a=n.findPolyForPoint(c,this.polys);if(a){t=c;break}}if(!a)return null}var h=n.findPolyForPoint(r,this.polys);if(a==h)return[t,r];var p=new WeakSet,d=new WeakSet,v=new e({comparator:i}),m=null;v.queue({dist:0,poly:a,point:t,parent:null});while(v.length>0){var g=v.dequeue();if(g.poly==h){m=g;break}p.add(g.poly),d.add(g.point);var y=this.grid.get(g.poly);for(var l=0;l<y.length;l++){var b=y[l],w=p.has(b.poly);for(var E=0;E<b.edge.points.length;E++){var S=b.edge.points[E];(!w||!d.has(S))&&v.queue({dist:g.dist+s(S,g.point),poly:b.poly,point:S,parent:g})}}}if(m){var x=[],T=m;while(T.parent)x.unshift(T.point),T=T.parent;return x.unshift(T.point),x.push(r),x}return null},r.prototype.generateAdjacencyGrid=function(e){var t=new WeakMap;return e.forEach(function(e,n,r){if(t.has(e)){if(t.get(e).length==e.numpoints)return}else t.set(e,new Array);e.points.forEach(function(i,s,o){var u=o[e.getNextI(s)];for(var a=n+1;a<r.length;a++){var f=r[a];f.points.some(function(n,r,s){var o=s[f.getNextI(r)],a=i.eq(o)&&u.eq(n);if(a){var l=new Edge(i,u);t.get(e).push({poly:f,edge:l}),t.has(f)||t.set(f,new Array),t.get(f).push({poly:e,edge:l})}return a});if(t.get(e).length==e.numpoints)break}})}),t},r}),n(["./pathfinder","./polypartition"],function(e,t){var n=t.Point,r=t.Poly,i=t.PolyUtils,s={};s.toPoint=function(e){return new n(e.x,e.y)},s.toPoly=function(e){var t=new r;return t.points=e.points.map(s.toPoint),t.hole=e.hole,t.update(),t};var o={};o.log=function(e){var t=["log"];Array.prototype.push.apply(t,arguments),postMessage(t)};var u={};u.splice=function(e,t){t=t.sort(u._numberCompare).reverse();var n=[];return t.forEach(function(t){n.push(e.splice(t,1)[0])}),n},u._numberCompare=function(e,t){return e<t?-1:e>t?1:0},onmessage=function(t){var n=t.data,r=n[0];o.log("worker:debug","Message received by worker:",n);if(r=="polys")self.polys=n[1].map(s.toPoly),self.pathfinder=new e(self.polys);else if(r=="polyUpdate"){var i=n[1].map(s.toPoly),a=n[2];u.splice(self.polys,a),Array.prototype.push.apply(self.polys,i),self.pathfinder=new e(self.polys)}else if(r=="aStar"){var f=s.toPoint(n[1]),l=s.toPoint(n[2]),c=self.pathfinder.aStar(f,l);postMessage(["result",c])}else r=="isInitialized"&&postMessage(["initialized"])},o.log("worker","Worker loaded."),postMessage(["initialized"])}),r("aStarWorker",function(){})})();')}),r("navmesh",["./polypartition","./parse-map","./pathfinder","./lib/clipper","./worker!./aStarWorker.js"],function(e,t,n,r,i){var s=e.Point,o=e.Poly,u=e.Edge,a=e.PolyUtils,f=function(e,n){typeof n=="undefined"&&(n={},n.log=function(){}),this.logger=n,this.initialized=!1,this.updateFuncs=[],this._setupWorker();var r=t.parse(e);if(!r)throw"Map parsing failed!";this.map=JSON.parse(JSON.stringify(e)),this._init(r)};return f.geom=e,f.prototype._init=function(e){this.parsedMap=e;var t={walls:e.walls,obstacles:e.static_obstacles},r=e.dynamic_obstacles,i=this._offsetPolys(t);this.polys=i.map(f._geometry.partitionArea),this.polys=Array.prototype.concat.apply([],this.polys),this.worker||(this.pathfinder=new n(this.polys)),this._setupDynamicObstacles(r),this.obstacle_edges=[],i.forEach(function(e){var t=[e.polygon].concat(e.holes);t.forEach(function(e){for(var t=0,n=e.numpoints-1;t<e.numpoints;n=t++)this.obstacle_edges.push(new u(e.points[n],e.points[t]))},this)},this),this.initialized=!0},f.prototype._setupDynamicObstacles=function(e){this.impassable={},this.obstacleDefinitions={},this.idToObstacles={},this._addObstaclePoly("bomb",this._getApproximateCircle(15)),this._addObstaclePoly("boost",this._getApproximateCircle(15)),this._addObstaclePoly("portal",this._getApproximateCircle(15)),this._addObstaclePoly("spike",this._getApproximateCircle(14)),this._addObstaclePoly("gate",this._getSquare(20)),this._addObstaclePoly("tile",this._getSquare(20)),this._addObstaclePoly("wall",this._getSquare(20)),this._addObstaclePoly("sewall",this._getDiagonal(20,"se")),this._addObstaclePoly("newall",this._getDiagonal(20,"ne")),this._addObstaclePoly("swwall",this._getDiagonal(20,"sw")),this._addObstaclePoly("nwwall",this._getDiagonal(20,"nw")),this._setObstacleType([10,10.1],"bomb"),this._setObstacleType([5,5.1,14,14.1,15,15.1],"boost"),this._setObstacleType([9,9.1,9.2,9.3],"gate"),this._setObstacleType([1],"wall"),this._setObstacleType([1.1],"swwall"),this._setObstacleType([1.2],"nwwall"),this._setObstacleType([1.3],"newall"),this._setObstacleType([1.4],"sewall"),this._setObstacleType([7],"spike"),this.obstacle_state={},this.dynamic_obstacle_locations=[];var t=[];e.forEach(function(e){this.obstacle_state[s.toString(e)]=!0,this.dynamic_obstacle_locations.push(s.fromPointLike(e)),t.push(e)},this),this.setImpassable([10,5,14,15,9.1]),this.setImpassable([1,1.1,1.2,1.3,1.4,7]),this.mapUpdate(t)},f.prototype._getApproximateCircle=function(e,t){var n,r;t?(n=t.x,r=t.y):(n=0,r=0);var i=e*Math.tan(Math.PI/8);i=Math.round10(i,-1);var u=new o([new s(n-e,r-i),new s(n-e,r+i),new s(n-i,r+e),new s(n+i,r+e),new s(n+e,r+i),new s(n+e,r-i),new s(n+i,r-e),new s(n-i,r-e)]);return u},f.prototype._getSquare=function(e){var t=new o([new s(-e,e),new s(e,e),new s(e,-e),new s(-e,-e)]);return t},f.prototype._getDiagonal=function(e,t){var n={ne:[[e,-e],[e,e],[-e,-e]],se:[[e,e],[-e,e],[e,-e]],sw:[[-e,e],[-e,-e],[e,e]],nw:[[-e,-e],[e,-e],[-e,e]]},r=n[t].map(function(e){return new s(e[0],e[1])});return new o(r)},f.prototype._addObstaclePoly=function(e,t){this.obstacleDefinitions[e]=t},f.prototype._getObstaclePoly=function(e){var t=this.obstacleDefinitions[this.idToObstacles[e]];if(t)return t.clone();this.logger.log("navmesh:debug","No poly found for id:",e)},f.prototype.onInit=function(e){this.initialized?e():setTimeout(function(){this.onInit(e)}.bind(this),10)},f.prototype.onUpdate=function(e){this.updateFuncs.push(e)},f.prototype._update=function(e,t,n){this.polys=e,this.updateFuncs.forEach(function(e){setTimeout(function(){e(this.polys,t,n)}.bind(this),0)},this)},f.prototype.calculatePath=function(e,t,n){this.logger.log("navmesh:debug","Calculating path."),this.worker&&this.workerInitialized?(this.logger.log("navmesh:debug","Using worker to calculate path."),this.worker.postMessage(["aStar",e,t]),this.lastCallback=n):(path=this.pathfinder.aStar(e,t),typeof path!="undefined"&&path&&(path=path.slice(1)),n(path))},f.prototype.checkVisible=function(e,t){var n=new u(e,t),r=this.obstacle_edges.some(function(e){return e.intersects(n)});return!r},f.prototype._setObstacleType=function(e,t){e.forEach(function(e){this.idToObstacles[e]=t},this)},f.prototype.setImpassable=function(e){e=e.filter(function(e){return this._isPassable(e)},this),this.logger.log("navmesh:debug","Ids passed:",e);var t=[];this.dynamic_obstacle_locations.forEach(function(n){var r=e.indexOf(this.map[n.x][n.y]);r!==-1&&t.push({x:n.x,y:n.y,v:e[r]})},this),e.forEach(function(e){this.impassable[e]=!0},this),this.logger.log("Impassable after update:",this.impassable),t.length>0&&this.mapUpdate(t)},f.prototype.removeImpassable=function(e){e=e.filter(function(e){return!this._isPassable(e)},this);var t=[];this.dynamic_obstacle_locations.forEach(function(n){var r=e.indexOf(this.map[n.x][n.y]);r!==-1&&t.push({x:n.x,y:n.y,v:e[r]})},this),e.forEach(function(e){this.impassable[e]=!1},this),t.length>0&&this.mapUpdate(t)},f.prototype.mapUpdate=function(e){var t=!1,n=[];e.forEach(function(e){this.map[e.x][e.y]=e.v;if(t)return;var r=e.v,i=s.toString(e),o=this._isPassable(r),u=this.obstacle_state[i];if(typeof u=="undefined"){t=!0,this.logger.log("navmesh:error","Dynamic obstacle found but not already initialized.");return}if(o==u)return;this.obstacle_state[i]=o,e.passable=o,n.push(e)},this);if(t)return;if(n.length>0){var r=n[0].passable;n.forEach(function(e){e.passable!==r&&(t=!0)},this);if(t){this.logger.log("navmesh:error","Not all updates of same type.");return}r?this._passableUpdate(n):this._impassableUpdate(n)}},f.prototype._isPassable=function(e){return!this.impassable.hasOwnProperty(e)||!this.impassable[e]},f.prototype._getTilePoly=function(e){var t=e.v,n=this._getWorldCoord(e),r=this._getObstaclePoly(t).translate(n);return r},f.prototype._getWorldCoord=function(e){var t=40;return new s(e.x*t+t/2,e.y*t+t/2)},f.prototype._passableUpdate=function(e){var t=100,n=e.map(function(e){return this._getTilePoly({x:e.x,y:e.y,v:1})},this),i=this._offsetDynamicObs(n,20),s=f._geometry.cpr,o=this._getBorderedTiles(e),u=o.map(this._getTilePoly,this),a=this._offsetDynamicObs(u);s.Clear();var l=new r.Paths;s.AddPaths(i,r.PolyType.ptSubject,!0),s.AddPaths(a,r.PolyType.ptClip,!0),s.Execute(r.ClipType.ctDifference,l,r.PolyFillType.pftNonZero,r.PolyFillType.pftNonZero);var c=f._geometry.getAreas(l,t),h=f._geometry.partitionAreas(c),p=this._getIntersectedPolys(h),d=p.polys;d=d.map(f._geometry.convertPolyToClipper),r.JS.ScaleUpPaths(d,t),s.Clear(),s.AddPaths(d,r.PolyType.ptSubject,!0),s.AddPaths(l,r.PolyType.ptSubject,!0);var v=new r.Paths;s.Execute(r.ClipType.ctUnion,v,r.PolyFillType.pftNonZero,null);var m=f._geometry.getAreas(v,t),g=f._geometry.partitionAreas(m);Array.prototype.push.apply(this.polys,g),this._update(this.polys,g,p.indices)},f.prototype._impassableUpdate=function(e){var t=100,n=e.map(function(e){return this._getTilePoly(e)},this),i=this._offsetDynamicObs(n),s=f._geometry.getAreas(i,t),o=f._geometry.partitionAreas(s),u=this._getIntersectedPolys(o),a=u.polys;a=a.map(f._geometry.convertPolyToClipper),r.JS.ScaleUpPaths(a,t);var l=f._geometry.cpr;l.Clear(),l.AddPaths(a,r.PolyType.ptSubject,!0);var c=new r.Paths;l.Execute(r.ClipType.ctUnion,c,r.PolyFillType.pftNonZero,null);var h=new r.Paths;l.Clear(),l.AddPaths(c,r.PolyType.ptSubject,!0),l.AddPaths(i,r.PolyType.ptClip,!0),l.Execute(r.ClipType.ctDifference,h,r.PolyFillType.pftNonZero,r.PolyFillType.pftNonZero);var p=f._geometry.getAreas(h,t),d=f._geometry.partitionAreas(p);Array.prototype.push.apply(this.polys,d),this._update(this.polys,d,u.indices)},f.prototype._offsetDynamicObs=function(e,t){typeof t=="undefined"&&(t=16);var n=100;e=e.map(f._geometry.convertPolyToClipper),r.JS.ScaleUpPaths(e,n);var i=f._geometry.cpr,s=f._geometry.co;i.Clear(),i.AddPaths(e,r.PolyType.ptSubject,!0);var o=new r.Paths;i.Execute(r.ClipType.ctUnion,o,r.PolyFillType.pftNonZero,null);var u=new r.Paths;return o.forEach(function(e){var i=new r.Paths;s.Clear(),s.AddPath(e,r.JoinType.jtMiter,r.EndType.etClosedPolygon),s.Execute(i,t*n),u.push(i[0])}),i.Clear(),i.AddPaths(u,r.PolyType.ptSubject,!0),o=new r.Paths,i.Execute(r.ClipType.ctUnion,o,r.PolyFillType.pftNonZero,null),o},f.prototype._getIntersectedPolys=function(e){var t=f._geometry.getIntersections(e,this.polys);return{indices:t,polys:f._util.splice(this.polys,t)}},f.prototype._getBorderedTiles=function(e){var t={};e.forEach(function(e){t[s.toString(e)]=!0});var n=this.map,r=n.length,i=n[0].length,o=function(e){var t=e.x,n=e.y,s=t+1<r,o=t>=0,u=n+1<i,a=n>=0,f=[];return s&&(f.push({x:t+1,y:n}),u&&f.push({x:t+1,y:n+1}),a&&f.push({x:t+1,y:n-1})),o&&(f.push({x:t-1,y:n}),u&&f.push({x:t-1,y:n+1}),a&&f.push({x:t-1,y:n-1})),u&&f.push({x:t,y:n+1}),a&&f.push({x:t,y:n-1}),f},u=[];return e.forEach(function(e){var n=o(e);n.forEach(function(e){var n=s.toString(e);if(!t[n]){t[n]=!0;var r=this.map[e.x][e.y];this._isPassable(r)||(e.v=r,u.push(e))}},this)},this),u},f.prototype._offsetPolys=function(e,t){typeof t=="undefined"&&(t=16);var n=[],i=e.walls.filter(function(e,t){return e.getOrientation()=="CCW"?(n.push(e),!1):!0}),s=100;n=n.map(f._geometry.convertPolyToClipper),r.JS.ScaleUpPaths(n,s);var o=[];n.forEach(function(e){var n=f._geometry.offsetInterior(e,t);Array.prototype.push.apply(o,n)}),o.forEach(function(e){e.reverse()}),i=i.map(f._geometry.convertPolyToClipper),r.JS.ScaleUpPaths(i,s);var u=f._geometry.cpr,a=f._geometry.co,l=r.PolyFillType.pftEvenOdd,c=r.PolyFillType.pftNonZero,h=[];i.forEach(function(e){var n=new r.Paths;a.Clear(),a.AddPath(e,r.JoinType.jtSquare,r.EndType.etClosedPolygon),a.Execute(n,t*s),h.push(n[0])});var p=new r.Paths,d=e.obstacles.map(f._geometry.convertPolyToClipper);r.JS.ScaleUpPaths(d,s),a.Clear(),a.AddPaths(d,r.JoinType.jtMiter,r.EndType.etClosedPolygon),a.Execute(p,t*s);var v=[];return o.forEach(function(e){var t=r.JS.AreaOfPolygon(e,s),n=h.filter(function(e){return r.JS.AreaOfPolygon(e,s)<t}),i=new r.Paths;u.Clear(),u.AddPath(e,r.PolyType.ptSubject,!0),u.AddPaths(n,r.PolyType.ptClip,!0),u.AddPaths(p,r.PolyType.ptClip,!0),u.Execute(r.ClipType.ctDifference,i,r.PolyFillType.pftNonZero,r.PolyFillType.pftNonZero),Array.prototype.push.apply(v,i)}),f._geometry.getAreas(v,s)},f.prototype._setupWorker=function(){this.worker=!1,this.workerInitialized=!1,i.then(function(e){this.logger.log("navmesh:debug","Worker promise returned."),this.worker=e,this.worker.onmessage=this._getWorkerInterface(),this.worker.postMessage(["isInitialized"])}.bind(this),function(e){this.logger.log("navmesh:warn","No worker, falling back to in-thread computation."),this.logger.log("navmesh:warn","Worker error:",e),this.worker=!1}.bind(this)),this.onUpdate(function(e,t,n){this.worker&&this.workerInitialized?this.worker.postMessage(["polyUpdate",t,n]):this.logger.log("navmesh:debug","Worker not loaded yet.")}.bind(this))},f.prototype._workerLogger=function(e){this.logger.log.apply(null,e)},f.prototype._getWorkerInterface=function(){return function(e){var t=e.data,n=t[0];n!=="log"&&this.logger.log("navmesh:debug","Message received from worker:",t);if(n=="log")this._workerLogger(t.slice(1));else if(n=="result"){var r=t[1];r&&(r=r.map(function(e){return new s(e.x,e.y)}),r=r.slice(1)),this.lastCallback(r)}else n=="initialized"&&(this.workerInitialized=!0,this.onInit(function(){this.worker.postMessage(["polys",this.polys])}.bind(this)))}.bind(this)},f._geometry={},f._geometry.cpr=new r.Clipper,f._geometry.co=new r.ClipperOffset,f._geometry.co.MiterLimit=2,f._geometry.scale=100,f._geometry.getIntersections=function(e,t){var n=[];return t.forEach(function(t,r){var i=e.some(function(e){return t.intersects(e)});i&&n.push(r)}),n},f._geometry.getAreas=function(e,t){typeof t=="undefined"&&(t=f._geometry.scale);var n=f._geometry.cpr;n.Clear(),n.AddPaths(e,r.PolyType.ptSubject,!0);var i=new r.PolyTree;n.Execute(r.ClipType.ctUnion,i,r.PolyFillType.pftEvenOdd,null);var s=[],o=i.Childs();for(var u=0;u<o.length;u++){var a=o[u],l=a.Contour();r.JS.ScaleDownPath(l,t);var c={polygon:l,holes:[]};a.Childs().forEach(function(e){var n=e.Contour();r.JS.ScaleDownPath(e.Contour(),t),c.holes.push(n),e.Childs().forEach(function(e){o.push(e)})}),s.push(c)}return s.forEach(function(e){e.polygon=f._geometry.convertClipperToPoly(e.polygon),e.holes=e.holes.map(f._geometry.convertClipperToPoly)}),s},f._geometry.offsetInterior=function(e,t,n){typeof n=="undefined"&&(n=f._geometry.scale);var i=f._geometry.cpr,s=f._geometry.co,o=f._geometry.getBoundingShapeForPaths([e]);i.Clear(),i.AddPath(o,r.PolyType.ptSubject,!0),i.AddPath(e,r.PolyType.ptClip,!0);var u=new r.Paths;i.Execute(r.ClipType.ctDifference,u,r.PolyFillType.pftNonZero,r.PolyFillType.pftNonZero);var a=new r.Paths;return s.Clear(),s.AddPaths(u,r.JoinType.jtSquare,r.EndType.etClosedPolygon),s.Execute(a,t*n),a.length>=2?a.shift():a=new r.Paths,a},f._geometry.offsetExterior=function(e,t,n){},f._geometry.convexPartition=function(e,t){return e.setOrientation("CCW"),t.forEach(function(e){e.setOrientation("CW"),e.hole=!0}),a.convexPartition(e,t)},f._geometry.partitionArea=function(e){return f._geometry.convexPartition(e.polygon,e.holes)},f._geometry.partitionAreas=function(e){var t=e.map(f._geometry.partitionArea);return Array.prototype.concat.apply([],t)},f._geometry.convertPolyToClipper=function(e){return e.points.map(function(e){return{X:e.x,Y:e.y}})},f._geometry.convertClipperToPoly=function(e){var t=e.map(function(e){return new s(e.X,e.Y)});return new o(t)},f._geometry.getBoundingShapeForPaths=function(e,t){typeof t=="undefined"&&(t=5);var n=r.Clipper.GetBounds(e);n.left-=t,n.top-=t,n.right+=t,n.bottom+=t;var i=[];return i.push({X:n.right,Y:n.bottom}),i.push({X:n.left,Y:n.bottom}),i.push({X:n.left,Y:n.top}),i.push({X:n.right,Y:n.top}),i},f._util={},f._util.splice=function(e,t){t=t.sort(f._util._numberCompare).reverse();var n=[];return t.forEach(function(t){n.push(e.splice(t,1)[0])}),n},f._util._numberCompare=function(e,t){return e<t?-1:e>t?1:0},function(){function e(e,t,n){return typeof n=="undefined"||+n===0?Math[e](t):(t=+t,n=+n,isNaN(t)||typeof n!="number"||n%1!==0?NaN:(t=t.toString().split("e"),t=Math[e](+(t[0]+"e"+(t[1]?+t[1]-n:-n))),t=t.toString().split("e"),+(t[0]+"e"+(t[1]?+t[1]+n:n))))}Math.round10||(Math.round10=function(t,n){return e("round",t,n)}),Math.floor10||(Math.floor10=function(t,n){return e("floor",t,n)}),Math.ceil10||(Math.ceil10=function(t,n){return e("ceil",t,n)})}(),f}),n("navmesh")});